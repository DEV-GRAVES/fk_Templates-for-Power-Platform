"'Landing Screen' As screen":
    OnVisible: |
        =//Refresh reimbursement request upon load
        Refresh('Reimbursement Requests');
        
        UpdateContext(
            {
                _LayoutProperties:
                {
                    outerPadding: {top: 40, right: 40, bottom: 40, left: 40},
                    innerPadding: {top: 20, right: 20, bottom: 20, left: 20},
                    labelPadding: {top: 5, right: 5, bottom: 5, left: 5}
                },
                _FilterMode: false
            }
        )

    conReimbursementRequestMainContainer As groupContainer.verticalAutoLayoutContainer:
        Fill: =ColorValue(varThemeColors.background)
        Height: =Parent.Height - compHeader_RefundReqMain.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        LayoutOverflowY: =LayoutOverflow.Scroll
        PaddingBottom: |-
            =If(
                'Landing Screen'.Size < 3,
                _LayoutProperties.outerPadding.top / 2,
                _LayoutProperties.outerPadding.top
            )
        PaddingLeft: =_LayoutProperties.outerPadding.left
        PaddingRight: =_LayoutProperties.outerPadding.right
        PaddingTop: |-
            =If(
                'Landing Screen'.Size < 3,
                _LayoutProperties.outerPadding.top / 2,
                _LayoutProperties.outerPadding.top
            )
        Width: =Parent.Width
        Y: =compHeader_RefundReqMain.Height
        ZIndex: =1

        conRefundreqmain_Head As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: =If('Landing Screen'.Size = 1,120, 80)
            LayoutDirection: =If('Landing Screen'.Size <=1,LayoutDirection.Vertical,LayoutDirection.Horizontal)
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width - Parent.PaddingRight - Parent.PaddingLeft
            ZIndex: =1

            conTitle_Head As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =If('Landing Screen'.Size <= 1 ,lblTitle_Head.Height + Self.PaddingBottom + Self.PaddingTop, Parent.Height )
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =30
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =If('Landing Screen'.Size <= 1 ,20,0)
                PaddingLeft: =2
                PaddingRight: =2
                PaddingTop: =If('Landing Screen'.Size <= 1 ,0, 15 )
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =If('Landing Screen'.Size <=1,Parent.Width, Parent.Width *.6)
                ZIndex: =1

                lblTitle_Head As label:
                    AutoHeight: =true
                    Color: =ColorValue(varThemeColors.text)
                    Font: =varThemeFont.B1.face
                    FontWeight: =varThemeFont.H3.weight
                    LayoutMinWidth: =180
                    PaddingBottom: =0
                    PaddingLeft: =
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =varThemeFont.H1.size
                    Text: |-
                        =With(
                            {Text: "My requests" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Width: =If(App.ActiveScreen.Size = 1,Parent.Width - Parent.PaddingLeft, Parent.Width)
                    Wrap: =false
                    X: =40
                    Y: =40
                    ZIndex: =1

            conNewRequest_Head As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =If('Landing Screen'.Size <=1, btnNewRequest_Head.Height + Self.PaddingBottom + Self.PaddingTop ,Parent.Height)
                LayoutAlignItems: =LayoutAlignItems.End
                LayoutDirection: =LayoutDirection.Vertical
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =30
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =If('Landing Screen'.Size <=1, 1,1)
                PaddingLeft: =2
                PaddingRight: =2
                PaddingTop: =If('Landing Screen'.Size <=1,1,0)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =If('Landing Screen'.Size <=1,Parent.Width, Parent.Width *.4 -5)
                ZIndex: =2

                btnNewRequest_Head As button:
                    BorderColor: =ColorValue(varThemeColors.primary)
                    BorderThickness: =1
                    Color: =ColorValue(varThemeColors.altText)
                    DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                    DisabledColor: =ColorValue(varThemeColors.disabledText)
                    DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                    Fill: =ColorValue(varThemeColors.primary)
                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                    Font: =varThemeFont.CTA.face
                    FontWeight: =varThemeFont.CTA.weight
                    Height: |
                        =32
                    HoverBorderColor: =ColorValue(varThemeColors.primary)
                    HoverColor: =ColorValue(varThemeColors.altText)
                    HoverFill: =ColorValue(varThemeColors.tertiary)
                    Italic: =varThemeFont.CTA.italic
                    OnSelect: |-
                        =//Clean up of data entry.
                        ResetForm(frmRefundRequest_Details);
                        Clear(colReceiptDetailList);
                        Set(varRcptProcessorMerchantName, "");
                        Set(varHolderMerchantName, "");
                        
                        //Selected record to view
                        Set(varSelectedRecordToView, Defaults('Reimbursement Requests'));
                        
                        //Hold the Refund Request ID and pass it to View screen.
                        Set(varSelectedRefundID, Blank());
                        
                        //Set default currency when the user creates a new request
                        Set(varCurrencySelected, First(Currencies));
                        
                        //Navigate to Reimbursement Request Screen
                        Navigate('Reimbursement Request Screen', Transition.None, {_FormMode: FormMode.Edit})
                    PressedBorderColor: =ColorValue(varThemeColors.primary)
                    PressedColor: =ColorValue(varThemeColors.altText)
                    PressedFill: =ColorValue(varThemeColors.primary)
                    RadiusBottomLeft: =6
                    RadiusBottomRight: =6
                    RadiusTopLeft: =6
                    RadiusTopRight: =6
                    Size: =varThemeFont.CTA.size
                    Text: |-
                        =With(
                            {Text: "New request" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =If(App.ActiveScreen.Size = 1,Parent.Width - Parent.PaddingLeft - Parent.PaddingRight,160)
                    ZIndex: =1

        conRefundReqmain_Filters As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Fill: =ColorValue(varThemeColors.background)
            FillPortions: =0
            Height: |-
                =If(App.ActiveScreen.Size < 3 || App.Width < 500, 
                    (dtcFrom_Filters.Height * 3) + 
                    (btnResetFilters.Height * 4)
                    ,100
                )
            LayoutDirection: =If('Landing Screen'.Size <3,LayoutDirection.Vertical,LayoutDirection.Horizontal)
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingRight: =1
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =3

            frmFieldsFilter_Filters As form:
                AlignInContainer: =AlignInContainer.SetByContainer
                DataSource: ='Reimbursement Requests'
                FillPortions: =0
                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                FocusedBorderThickness: =varThemeColors.focusBorderThickness
                Height: =If(App.ActiveScreen.Size < 3, dtcFrom_Filters.Height* 3, Parent.Height)
                Item: =Defaults('Reimbursement Requests')
                LayoutMinHeight: =250
                LayoutMinWidth: =300
                SnapToColumns: =false
                Width: =If(App.ActiveScreen.Size < 3, Parent.Width, Parent.Width - conFilterButtons_Filters.Width)
                ZIndex: =1

                dtcFrom_Filters As typedDataCard.comboBoxEditCard:
                    BorderStyle: =BorderStyle.Solid
                    DataField: =
                    Default: =
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =78
                    Required: =false
                    Update: =
                    Width: =If(App.ActiveScreen.Size < 3, Parent.Width, Parent.Width / 3)
                    WidthFit: =true
                    X: =0
                    Y: =0
                    ZIndex: =1

                    dtpFrom As datepicker:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Date From"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =If(IsBlank(Parent.Error), ColorValue(varThemeColors.primaryGray), Color.Red)
                        Color: =ColorValue(varThemeColors.text)
                        DefaultDate: =Today() - 90
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                        FocusedBorderThickness: =varThemeColors.focusBorderThickness
                        Height: =28
                        IconBackground: =ColorValue(varThemeColors.backgroundFill)
                        IconFill: =ColorValue(varThemeColors.text)
                        OnChange: |-
                            =//Turn off Filter mode
                            //UpdateContext({ _FilterMode: false });
                            //Turn on Filter mode
                            UpdateContext({ _FilterMode: true });
                        PaddingBottom: =0
                        Reset: =
                        Size: =varThemeFont.B1.size
                        Tooltip: |-
                            =With(
                                {Text: "From" },
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =If(App.ActiveScreen.Size < 3,Parent.Width -5,Parent.Width - 20)
                        X: =1
                        Y: =If(App.ActiveScreen.Size < 3, 30, lblFrom.Y + lblFrom.Height + 10)
                        ZIndex: =1

                    lblFrom As label:
                        AutoHeight: =true
                        Color: =ColorValue(varThemeColors.text)
                        FocusedBorderColor: =ColorValue(varThemeColors.primaryGray)
                        FocusedBorderThickness: =varThemeColors.focusBorderThickness
                        Font: =varThemeFont.B2.face
                        FontWeight: =varThemeFont.B2.weightBold
                        Height: =30
                        Italic: =varThemeFont.B2.italic
                        PaddingLeft: =0
                        Size: =varThemeFont.B2.size
                        Text: |-
                            =With(
                                {Text: "Date from" },
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Tooltip: =Self.Text
                        Width: =110
                        X: =1
                        Y: |-
                            =If(
                                'Landing Screen'.Size < 3, 0,10
                            )
                        ZIndex: =2

                dtcTo_Filters As typedDataCard.currencyEditCard:
                    BorderStyle: =BorderStyle.Solid
                    DataField: =
                    Default: =
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =78
                    Required: =true
                    Update: =
                    Width: =If(App.ActiveScreen.Size < 3, Parent.Width, Parent.Width / 3)
                    WidthFit: =true
                    X: =1
                    Y: =0
                    ZIndex: =1

                    lblTo As label:
                        AutoHeight: =true
                        Color: =ColorValue(varThemeColors.text)
                        FocusedBorderColor: =ColorValue(varThemeColors.primaryGray)
                        FocusedBorderThickness: =varThemeColors.focusBorderThickness
                        Font: =varThemeFont.B2.face
                        FontWeight: =varThemeFont.B2.weightBold
                        Height: =30
                        Italic: =varThemeFont.B2.italic
                        PaddingLeft: =0
                        Size: =varThemeFont.B2.size
                        Text: |-
                            =With(
                                {Text: "Date to" },
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Tooltip: =Self.Text
                        Width: =67
                        X: =1
                        Y: |-
                            =If(
                                'Landing Screen'.Size < 3, 0,10
                            )
                        ZIndex: =1

                    dtpTo As datepicker:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Date To"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =If(IsBlank(Parent.Error), ColorValue(varThemeColors.primaryGray), Color.Red)
                        Color: =ColorValue(varThemeColors.text)
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                        FocusedBorderThickness: =varThemeColors.focusBorderThickness
                        Height: =28
                        IconBackground: =ColorValue(varThemeColors.backgroundFill)
                        IconFill: =ColorValue(varThemeColors.text)
                        OnChange: |-
                            =//Turn off Filter mode
                            //UpdateContext({ _FilterMode: false });
                            //Turn on Filter mode
                            UpdateContext({ _FilterMode: true });
                        PaddingBottom: =0
                        Reset: =!_FilterMode
                        Size: =varThemeFont.B1.size
                        Tooltip: |-
                            =With(
                                {Text: "To" },
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =If(App.ActiveScreen.Size < 3,Parent.Width -5,Parent.Width - 20)
                        X: =1
                        Y: |-
                            =
                            If(App.ActiveScreen.Size < 3, 30, lblTo.Y + lblTo.Height + 10)
                        ZIndex: =4

                dtcStatus_Filters As typedDataCard.textualEditCard:
                    BorderStyle: =BorderStyle.Solid
                    DataField: =
                    Default: =
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =78
                    MaxLength: =DataSourceInfo([@'Reimbursement Requests'], DataSourceInfo.MaxLength, "mpa_merchantname")
                    Required: =false
                    Update: =
                    Width: =If(App.ActiveScreen.Size < 3, Parent.Width, Parent.Width / 3)
                    WidthFit: =true
                    X: =2
                    Y: =0
                    ZIndex: =1

                    lblRefundStatus As label:
                        AutoHeight: =true
                        Color: =ColorValue(varThemeColors.text)
                        FocusedBorderColor: =ColorValue(varThemeColors.primaryGray)
                        FocusedBorderThickness: =varThemeColors.focusBorderThickness
                        Font: =varThemeFont.B2.face
                        FontWeight: =varThemeFont.B2.weightBold
                        Height: =30
                        Italic: =varThemeFont.B2.italic
                        PaddingLeft: =0
                        Size: =varThemeFont.B2.size
                        Text: |-
                            =With(
                                {Text: "Status" },
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Tooltip: =Self.Text
                        Width: =Parent.Width - 60
                        X: =1
                        Y: |-
                            =If(
                                'Landing Screen'.Size < 3, 10,10
                            )
                        ZIndex: =1

                    drpStatus As combobox:
                        AccessibleLabel: |-
                            =With(
                                {Text: "Select status"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =If(IsBlank(Parent.Error), ColorValue(varThemeColors.primaryGray), Color.Red)
                        ChevronBackground: =ColorValue(varThemeColors.backgroundFill)
                        ChevronDisabledBackground: =ColorValue(varThemeColors.backgroundFillDisabled)
                        ChevronDisabledFill: =ColorValue(varThemeColors.text)
                        ChevronFill: =ColorValue(varThemeColors.text)
                        ChevronHoverBackground: =ColorFade(ColorValue(varThemeColors.secondaryGray), -20%)
                        ChevronHoverFill: =ColorValue(varThemeColors.text)
                        Color: =ColorValue(varThemeColors.text)
                        DefaultSelectedItems: =
                        DisabledColor: =ColorValue(varThemeColors.disabledText)
                        DisplayFields: =["Value"]
                        DisplayMode: =Parent.DisplayMode
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                        FocusedBorderThickness: =varThemeColors.focusBorderThickness
                        Font: =varThemeFont.B1.face
                        FontWeight: =varThemeFont.B1.weight
                        Height: =28
                        HoverColor: =ColorValue(varThemeColors.text)
                        InputTextPlaceholder: |-
                            =With(
                                {Text: "Select status"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        IsSearchable: =false
                        Italic: =varThemeFont.B1.italic
                        Items: =Choices('Request Status')
                        NoSelectionText: |-
                            =With(
                                {Text: "Select status"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: |-
                            =//Turn off Filter mode
                            //UpdateContext({ _FilterMode: false });
                            //Turn on Filter mode
                            UpdateContext({ _FilterMode: true });
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PressedColor: =ColorValue(varThemeColors.text)
                        Reset: =
                        SearchFields: =["Value"]
                        SearchItems: =[]
                        SelectionColor: =ColorValue(varThemeColors.text)
                        SelectionFill: =ColorValue(varThemeColors.secondaryGray)
                        SelectionTagColor: =ColorValue(varThemeColors.altText)
                        SelectionTagFill: =ColorValue(varThemeColors.primary)
                        SelectMultiple: =false
                        Size: =varThemeFont.B1.size
                        Tooltip: |-
                            =With(
                                {Text: "Status" },
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =If(App.ActiveScreen.Size < 3,Parent.Width - 5,Parent.Width - 20)
                        X: =1
                        Y: |-
                            =
                            If(App.ActiveScreen.Size < 3, lblRefundStatus.Y + lblRefundStatus.Height + 5, lblRefundStatus.Y + lblRefundStatus.Height + 10)
                        ZIndex: =4

            conFilterButtons_Filters As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =If(App.ActiveScreen.Size < 3, btnResetFilters.Height + btnApplyFilters.Height + Self.LayoutGap + Self.PaddingTop + Self.PaddingBottom, Parent.Height)
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =20
                LayoutJustifyContent: =LayoutJustifyContent.End
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutWrap: =true
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: |-
                    =
                    If('Landing Screen'.Size < 3, 10, 20)
                Width: =If(App.ActiveScreen.Size < 3, Parent.Width, (Parent.Width / 3) - 90)
                ZIndex: =2

                btnApplyFilters As button:
                    BorderColor: =ColorValue(varThemeColors.primary)
                    BorderThickness: =1
                    Color: =ColorValue(varThemeColors.primary)
                    DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                    DisabledColor: =ColorValue(varThemeColors.disabledText)
                    DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                    Font: =varThemeFont.CTA.face
                    FontWeight: =varThemeFont.CTA.weight
                    Height: =btnNewRequest_Head.Height
                    HoverBorderColor: =ColorValue(varThemeColors.primary)
                    HoverColor: =ColorValue(varThemeColors.altText)
                    HoverFill: =ColorValue(varThemeColors.tertiary)
                    Italic: =varThemeFont.CTA.italic
                    OnSelect: |-
                        =//Turn on Filter mode
                        UpdateContext({ _FilterMode: true });
                    PressedBorderColor: =ColorValue(varThemeColors.primary)
                    PressedColor: =ColorValue(varThemeColors.altText)
                    PressedFill: =ColorValue(varThemeColors.primary)
                    RadiusBottomLeft: =6
                    RadiusBottomRight: =6
                    RadiusTopLeft: =6
                    RadiusTopRight: =6
                    Size: =varThemeFont.CTA.size
                    Text: |-
                        =With(
                            {Text: "Apply filter" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Visible: =false
                    Width: =If(App.ActiveScreen.Size < 3,Parent.Width -5,(Parent.Width / 2) - (Parent.PaddingLeft * 2) - (Parent.LayoutGap ) + 15)
                    ZIndex: =1

                btnResetFilters As button:
                    BorderColor: =ColorValue(varThemeColors.primary)
                    BorderThickness: =1
                    Color: =ColorValue(varThemeColors.primary)
                    DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                    DisabledColor: =ColorValue(varThemeColors.disabledText)
                    DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                    Font: =varThemeFont.CTA.face
                    FontWeight: =varThemeFont.CTA.weight
                    Height: =btnNewRequest_Head.Height
                    HoverBorderColor: =ColorValue(varThemeColors.primary)
                    HoverColor: =ColorValue(varThemeColors.altText)
                    HoverFill: =ColorValue(varThemeColors.tertiary)
                    Italic: =varThemeFont.CTA.italic
                    OnSelect: |-
                        =//Turn off Filter mode
                        UpdateContext({ _FilterMode: false });
                        
                        //Reset filter controls
                        ResetForm(frmFieldsFilter_Filters);
                    PressedBorderColor: =ColorValue(varThemeColors.primary)
                    PressedColor: =ColorValue(varThemeColors.altText)
                    PressedFill: =ColorValue(varThemeColors.primary)
                    RadiusBottomLeft: =6
                    RadiusBottomRight: =6
                    RadiusTopLeft: =6
                    RadiusTopRight: =6
                    Size: =varThemeFont.CTA.size
                    Text: |-
                        =With(
                            {Text: "Reset filter" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =If(App.ActiveScreen.Size < 3,Parent.Width -5,(Parent.Width / 2) - (Parent.PaddingLeft * 2) - (Parent.LayoutGap ) + 15)
                    Y: =20
                    ZIndex: =2

        conRefundReqmain_Body As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Fill: =ColorValue(varThemeColors.backgroundFill)
            FillPortions: =0
            Height: |
                =If(
                   'Landing Screen'.Size <= 3,
                    galRefundRequestHome.Height + congalHeader.Height,
                    Parent.Height - conRefundreqmain_Head.Height - Parent.PaddingBottom - Parent.PaddingTop  - conRefundReqmain_Filters.Height
                )
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowX: |-
                =If(
                   'Landing Screen'.Size <= 3,
                   LayoutOverflow.Scroll,
                   LayoutOverflow.Hide
                )
            LayoutOverflowY: =LayoutOverflow.Scroll
            PaddingRight: =10
            Width: |
                =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =4

            congalHeader As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                Fill: =ColorValue(varThemeColors.backgroundFill)
                FillPortions: =0
                Height: =43
                LayoutGap: =15
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Width: |-
                    =If(
                       'Landing Screen'.Size <= 3,
                        1200,
                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                    )
                ZIndex: =1

                lblRequestNumber As label:
                    Color: =ColorValue(varThemeColors.text)
                    FillPortions: =1
                    Font: =varThemeFont.B1.face
                    FontWeight: =varThemeFont.H3.weight
                    Height: =Parent.Height
                    PaddingBottom: =_LayoutProperties.labelPadding.bottom * 2
                    PaddingLeft: =_LayoutProperties.innerPadding.left + 12
                    PaddingRight: =0
                    PaddingTop: =_LayoutProperties.labelPadding.top * 2
                    Size: =varThemeFont.B2.size
                    Text: |-
                        =With(
                            {Text: "Request number" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: |-
                        =
                        If(
                           'Landing Screen'.Size <= 3,
                            ((Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7) * .8,
                            (Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7
                        )
                    Wrap: =false
                    X: =
                    Y: =40
                    ZIndex: =1

                lblRequestName As label:
                    Color: =ColorValue(varThemeColors.text)
                    FillPortions: =1
                    Font: =varThemeFont.B2.face
                    FontWeight: =varThemeFont.H3.weight
                    PaddingBottom: =_LayoutProperties.labelPadding.bottom * 2
                    PaddingLeft: =_LayoutProperties.labelPadding.left
                    PaddingRight: =0
                    PaddingTop: =_LayoutProperties.labelPadding.top * 2
                    Size: =varThemeFont.B2.size
                    Text: |-
                        =With(
                            {Text: "Request name" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: |-
                        =
                        If(
                           'Landing Screen'.Size <= 3,
                            ((Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7) * .8,
                            (Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7
                        )
                    Wrap: =false
                    X: =40
                    Y: =40
                    ZIndex: =2

                lblRefundProgram As label:
                    Color: =ColorValue(varThemeColors.text)
                    FillPortions: =1
                    Font: =varThemeFont.B2.face
                    FontWeight: =varThemeFont.H3.weight
                    PaddingBottom: =_LayoutProperties.labelPadding.bottom * 2
                    PaddingLeft: =_LayoutProperties.labelPadding.left
                    PaddingRight: =0
                    PaddingTop: =_LayoutProperties.labelPadding.top * 2
                    Size: =varThemeFont.B2.size
                    Text: |-
                        =With(
                            {Text: "Program" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: |-
                        =
                        If(
                           'Landing Screen'.Size <= 3,
                            ((Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7) * .8,
                            (Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7
                        )
                    Wrap: =false
                    X: =lblRequestNumber.X + Self.Width
                    Y: =40
                    ZIndex: =3

                lblCategory As label:
                    Color: =ColorValue(varThemeColors.text)
                    FillPortions: =1
                    Font: =varThemeFont.B2.face
                    FontWeight: =varThemeFont.H3.weight
                    PaddingBottom: =_LayoutProperties.labelPadding.bottom * 2
                    PaddingLeft: =_LayoutProperties.labelPadding.left
                    PaddingRight: =0
                    PaddingTop: =_LayoutProperties.labelPadding.top * 2
                    Size: =varThemeFont.B2.size
                    Text: |-
                        =
                        With(
                            {Text: "Category" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: |-
                        =
                        If(
                           'Landing Screen'.Size <= 3,
                            ((Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7) * .8,
                            (Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7
                        )
                    Wrap: =false
                    X: =40
                    Y: =40
                    ZIndex: =4

                lblAmount As label:
                    Color: =ColorValue(varThemeColors.text)
                    FillPortions: =1
                    Font: =varThemeFont.B2.face
                    FontWeight: =varThemeFont.H3.weight
                    PaddingBottom: =_LayoutProperties.labelPadding.bottom * 2
                    PaddingLeft: =_LayoutProperties.labelPadding.left
                    PaddingRight: =0
                    PaddingTop: =_LayoutProperties.labelPadding.top * 2
                    Size: =varThemeFont.B2.size
                    Text: |-
                        =With(
                            {Text: "Amount" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: |-
                        =
                        If(
                           'Landing Screen'.Size <= 3,
                            ((Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7) * .8,
                            (Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7
                        )
                    Wrap: =false
                    X: =40
                    Y: =40
                    ZIndex: =5

                lblCreatedOn As label:
                    Color: =ColorValue(varThemeColors.text)
                    FillPortions: =1
                    Font: =varThemeFont.B2.face
                    FontWeight: =varThemeFont.H3.weight
                    PaddingBottom: =_LayoutProperties.labelPadding.bottom * 2
                    PaddingLeft: =_LayoutProperties.labelPadding.left
                    PaddingRight: =0
                    PaddingTop: =_LayoutProperties.labelPadding.top * 2
                    Size: =varThemeFont.B2.size
                    Text: |-
                        =With(
                            {Text: "Created on" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: |-
                        =
                        If(
                           'Landing Screen'.Size <= 3,
                            ((Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7) * .8,
                            (Parent.Width - Parent.PaddingLeft - Parent.PaddingRight) /7
                        )
                    Wrap: =false
                    X: =40
                    Y: =40
                    ZIndex: =6

                lblStatus As label:
                    Color: =ColorValue(varThemeColors.text)
                    Font: =varThemeFont.B2.face
                    FontWeight: =varThemeFont.H3.weight
                    PaddingBottom: =_LayoutProperties.labelPadding.bottom * 2
                    PaddingLeft: =_LayoutProperties.labelPadding.left
                    PaddingRight: =0
                    PaddingTop: =_LayoutProperties.labelPadding.top * 2
                    Size: =varThemeFont.B2.size
                    Text: |-
                        =With(
                            {Text: "Status" },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =180
                    Wrap: =false
                    X: =40
                    Y: =40
                    ZIndex: =7

            shpgalRequestDivider As rectangle:
                BorderColor: =ColorValue(varThemeColors.text)
                BorderThickness: =1
                Fill: =ColorValue(varThemeColors.text)
                Height: =1
                Width: |-
                    =If(
                       'Landing Screen'.Size <= 3,
                        1200,
                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                    )
                ZIndex: =2

            galRefundRequestHome As gallery.galleryVertical:
                AccessibleLabel: |-
                    =With(
                        {Text: "Request Refund Gallery"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(166, 166, 166, 1)
                DelayItemLoading: =true
                Fill: =ColorValue(varThemeColors.backgroundFill)
                FillPortions: =0
                FocusedBorderColor: =ColorValue(varThemeColors.primaryGray)
                FocusedBorderThickness: =varThemeColors.focusBorderThickness
                Height: |-
                    =Max(Self.TemplateHeight * 8,
                        Self.AllItemsCount * Self.TemplateHeight
                    )
                Items: |-
                    =SortByColumns(
                        // Filter function to filter data from the 'Refund Requests' data source
                        Filter(
                            'Reimbursement Requests', // The name of the data source to filter
                            'Created By'.'Primary Email' = User().Email, // Filter criterion: select records where the 'Created By' field matches the full name of the current user
                            (
                                _FilterMode && 
                                'Created On' >= DateTimeValue(Text(dtpFrom.SelectedDate) & " 00:00:00") && 
                                'Created On' <= DateTimeValue(Text(dtpTo.SelectedDate) & " 23:59:59")
                            ) || _FilterMode = false,
                            (
                                _FilterMode && 
                                (IsBlank(drpStatus.Selected) || 'Approval Status' = drpStatus.Selected.Value)
                            ) || _FilterMode = false // Filter by the selected approval status from the dropdown
                        ),
                        "createdon", // The field on which to sort the data
                        SortOrder.Descending // The order of sorting: descending, meaning the most recent records will appear first
                    )
                Layout: =Layout.Vertical
                LayoutMinHeight: =287
                LayoutMinWidth: =320
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |
                    =
                TabIndex: =0
                TemplateFill: =ColorValue(varThemeColors.backgroundFill)
                TemplatePadding: =0
                TemplateSize: =50
                Visible: =If (Self.AllItemsCount > 0 , true, false)
                Width: |-
                    =If(
                       'Landing Screen'.Size <= 3,
                        1200,
                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                    )
                Y: =160
                ZIndex: =3

                conRefundRequestHome_Status As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    Height: =Parent.TemplateHeight
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =15
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =5
                    PaddingLeft: =5
                    PaddingRight: =5
                    PaddingTop: =5
                    Width: =lblStatus.Width
                    X: |-
                        =//lblRefundRequestHome_RequestNumber.Width + lblRefundRequestHome_ExpenseDate.Width + lblRefundRequestHome_RefundProgram.Width + lblRefundRequestHome_Category.Width + lblRefundRequestHome_MerchantName.Width + lblRefundRequestHome_Amount.Width
                        lblStatus.X
                    ZIndex: =1

                    conRefundRequestHome_ApprovalStatus As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.Start
                        Fill: |
                            =// Determine the color based on the 'Approval Status' of the current item.
                            
                            If(
                                // Check if the 'Approval Status' of 'ThisItem' is 'Approved'.
                                ThisItem.'Approval Status' = 'Request Status'.Approved,
                            
                                // If 'Approved', use the 'confirmation' color from the 'varThemeColors' variable.
                                ColorValue(varThemeColors.confirmation),
                            
                                // If not 'Approved', check if the status is 'Denied'.
                                If(
                                    ThisItem.'Approval Status' = 'Request Status'.Denied,
                            
                                    // If 'Denied', use the 'error' color from the 'varThemeColors' variable.
                                    ColorValue(varThemeColors.error),
                            
                                    // If neither 'Approved' nor 'Denied', use the 'warning' color as a default.
                                    ColorValue(varThemeColors.warning)
                                )
                            )
                        FillPortions: =0
                        Height: =35
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        RadiusBottomLeft: =50
                        RadiusBottomRight: =50
                        RadiusTopLeft: =50
                        RadiusTopRight: =50
                        Width: =If(Text(ThisItem.mpa_approvalstatus) = "Denied", 110, If(Text(ThisItem.mpa_approvalstatus) = "Approved",130,155))
                        ZIndex: =1

                        "icoRefundRequestHome_ApprovalStatus As icon.'3DPrinting'":
                            AccessibleLabel: =
                            BorderColor: =ColorValue(varThemeColors.primary)
                            Color: =If(ThisItem.'Approval Status' = 'Request Status'.'Under review', Color.Black, Color.White)
                            DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                            DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                            DisabledFill: =RGBA(0,0,0,0)
                            DisplayMode: =DisplayMode.View
                            Fill: =RGBA(0,0,0,0)
                            FocusedBorderColor: =ColorValue(varThemeColors.primaryGray)
                            FocusedBorderThickness: =varThemeColors.focusBorderThickness
                            Height: =Parent.Height
                            HoverBorderColor: =ColorValue(varThemeColors.primary)
                            HoverColor: =Self.Color
                            HoverFill: =RGBA(0,0,0,0)
                            Icon: |-
                                =If(
                                    ThisItem.'Approval Status' = 'Request Status'.Approved,
                                    Icon.CheckBadge,
                                    ThisItem.'Approval Status' = 'Request Status'.'Under review',
                                    Icon.Clock,
                                    Icon.CancelBadge
                                )
                            OnSelect: =
                            PaddingBottom: =8
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =8
                            PressedBorderColor: =ColorValue(varThemeColors.primary)
                            PressedColor: =ColorValue(varThemeColors.primary)
                            PressedFill: =RGBA(0,0,0,0)
                            Tooltip: =lblRefundRequestHome_ApprovalStatus.Text
                            Width: =Self.Height
                            X: =5
                            ZIndex: =1

                        lblRefundRequestHome_ApprovalStatus As label:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =icoRefundRequestHome_ApprovalStatus.Color
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorValue(varThemeColors.primaryGray)
                            FocusedBorderThickness: =4
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =Parent.Height
                            Italic: =varThemeFont.B2.italic
                            OnSelect: =
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.B1.size
                            Text: |-
                                =With(
                                    {Text: Text(ThisItem.mpa_approvalstatus) },
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =lblRefundRequestHome_ApprovalStatus.Text
                            Width: |
                                =Parent.Width - Self.X - 10
                            X: =icoRefundRequestHome_ApprovalStatus.X + icoRefundRequestHome_ApprovalStatus.Width
                            ZIndex: =2

                lblRefundRequestHome_ExpenseDate As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =ColorValue(varThemeColors.text)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                    Font: =varThemeFont.B1.face
                    FontWeight: =varThemeFont.B1.weight
                    Height: =Parent.TemplateHeight
                    Italic: =varThemeFont.B2.italic
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    PaddingTop: =15
                    Role: =TextRole.Heading2
                    Size: =varThemeFont.B1.size
                    Text: =ThisItem.'Created On'
                    Tooltip: =Self.Text
                    VerticalAlign: =VerticalAlign.Top
                    Width: =lblCreatedOn.Width
                    X: =lblCreatedOn.X
                    ZIndex: =2

                lblRefundRequestHome_RequestName As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =ColorValue(varThemeColors.text)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                    Font: =varThemeFont.B1.face
                    FontWeight: =varThemeFont.B1.weight
                    Height: =Parent.TemplateHeight
                    Italic: =varThemeFont.B2.italic
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    PaddingTop: =15
                    Role: =TextRole.Heading2
                    Size: =varThemeFont.B1.size
                    Text: =ThisItem.'Request Name'
                    Tooltip: =Self.Text
                    VerticalAlign: =VerticalAlign.Top
                    Width: =lblRequestName.Width
                    X: =lblRequestName.X
                    ZIndex: =3

                lblRefundRequestHome_RefundProgram As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =ColorValue(varThemeColors.text)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                    Font: =varThemeFont.B1.face
                    FontWeight: =varThemeFont.B1.weight
                    Height: =Parent.TemplateHeight
                    Italic: =varThemeFont.B2.italic
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    PaddingTop: =15
                    Role: =TextRole.Heading2
                    Size: =varThemeFont.B1.size
                    Text: =ThisItem.Program.'Program Name'
                    Tooltip: =Self.Text
                    VerticalAlign: =VerticalAlign.Top
                    Width: =lblRefundProgram.Width
                    X: =lblRefundProgram.X
                    ZIndex: =4

                lblRefundRequestHome_Amount As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =ColorValue(varThemeColors.text)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: |
                        =ColorValue(varThemeColors.focusBorder)
                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                    Font: =varThemeFont.B1.face
                    FontWeight: =varThemeFont.B1.weight
                    Height: =Parent.TemplateHeight
                    Italic: =varThemeFont.B2.italic
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =10
                    PaddingTop: =15
                    Role: =TextRole.Heading2
                    Size: =varThemeFont.B1.size
                    Text: |
                        =$"{ThisItem.Currency.'Currency Symbol'} {Text(Coalesce(ThisItem.Amount, 0),  "#,##0.00")}" 
                    Tooltip: =Self.Text
                    VerticalAlign: =VerticalAlign.Top
                    Width: =lblAmount.Width
                    X: =lblAmount.X
                    ZIndex: =5

                lblRefundRequestHome_Category As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =ColorValue(varThemeColors.text)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                    Font: =varThemeFont.B1.face
                    FontWeight: =varThemeFont.B1.weight
                    Height: =Parent.TemplateHeight
                    Italic: =varThemeFont.B2.italic
                    OnSelect: =
                    PaddingBottom: =0
                    PaddingRight: =0
                    PaddingTop: =15
                    Role: =TextRole.Heading2
                    Size: =varThemeFont.B1.size
                    Text: =ThisItem.Category.'Category Name'
                    Tooltip: =Self.Text
                    VerticalAlign: =VerticalAlign.Top
                    Width: =lblCategory.Width
                    X: =lblCategory.X
                    ZIndex: =6

                btnNewRequestHome_RequestNumber As button:
                    Align: =Align.Left
                    BorderThickness: =0
                    Color: =ColorValue(varThemeColors.primary)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                    Font: =varThemeFont.CTA.face
                    FontWeight: =varThemeFont.CTA.weight
                    Height: =Parent.TemplateHeight
                    HoverBorderColor: =Self.Fill
                    HoverColor: =ColorValue(varThemeColors.text)
                    HoverFill: =Self.Fill
                    Italic: =varThemeFont.CTA.italic
                    OnSelect: |-
                        =//Selected record to view
                        Set(varSelectedRecordToView, ThisItem);
                        
                        //Hold the Refund Request ID and pass it to View screen.
                        Set(
                            varSelectedRefundID,
                            galRefundRequestHome.Selected.'Reimbursement Request Id'
                        );
                        
                        //Set currency variable
                        Set(varCurrencySelected, ThisItem.Currency);
                        
                        //Navigate to Reimbursement Request Screen
                        Navigate(
                            'Reimbursement Request Screen', // The name of the screen to navigate to
                            Transition.None, // The type of transition effect to use when navigating. In this case, 'None' means no transition effect
                            {_FormMode: FormMode.View} //Use to setup context variables upon loading of the screen
                        );
                    PaddingLeft: =37
                    PressedColor: =ColorValue(varThemeColors.altText)
                    PressedFill: =Self.Fill
                    Size: =varThemeFont.CTA.size
                    Text: =Coalesce(ThisItem.'Request Number', "-")
                    Tooltip: =Self.Text
                    Underline: =true
                    Width: =lblRequestNumber.Width
                    ZIndex: =7

            "'contRefundRequestHome_No Recordsfound' As groupContainer.manualLayoutContainer":
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =ColorValue(varThemeColors.backgroundFill)
                Fill: =ColorValue(varThemeColors.backgroundFill)
                Height: =Parent.Height - Self.Y
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                RadiusBottomLeft: =6
                RadiusBottomRight: =6
                RadiusTopLeft: =6
                RadiusTopRight: =6
                Visible: =If(galRefundRequestHome.AllItemsCount = 0 , true, false)
                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                ZIndex: =4

                lblNoRecordsFound As label:
                    Align: =Align.Center
                    Color: =ColorValue(varThemeColors.tertiaryGray)
                    Font: =varThemeFont.B1.face
                    FontWeight: =varThemeFont.B1.weight
                    Height: =Parent.Height
                    OnSelect: =
                    PaddingBottom: =10
                    PaddingLeft: =37
                    PaddingRight: =8
                    PaddingTop: =10
                    Size: =varThemeFont.B1.size
                    Text: |-
                        =With(
                            {Text: "There are no records found." },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Width: =Parent.Width
                    Wrap: =false
                    X: =
                    ZIndex: =1

        conPaddingButtom_Landing As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.Start
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: =Parent.PaddingBottom
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =5

    compHeader_RefundReqMain As compHeader:
        HeaderWidth: =App.Width
        Height: =compHeader_RefundReqMain.HeaderHeight
        IsBackSettingsOn: =false
        Width: =compHeader_RefundReqMain.HeaderWidth
        ZIndex: =2

