"'Review and Submit Screen' As screen":
    Fill: =ColorValue(varThemeColors.backgroundFill)
    OnVisible: =Set(varSubmittedByEmail,Office365Users.UserProfile(User().Email).UserPrincipalName);

    conContent_Review As groupContainer.verticalAutoLayoutContainer:
        Fill: =ColorValue(varThemeColors.backgroundFill)
        Height: =1086
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        PaddingBottom: =20
        PaddingLeft: |-
            =Switch(App.ActiveScreen.Size,
            5, (Parent.Width - 1450)/2,
            4, 75,
            3, 50,
            2, 25,
            1, 10
            )
        PaddingRight: =Self.PaddingLeft
        Width: =Parent.Width
        Y: =compHeader_Review.Height + compHeader_Review.Y
        ZIndex: =1

        conPrompt_Review As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =lblPromptTitle_Review.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =1

            lblPromptTitle_Review As label:
                AlignInContainer: =AlignInContainer.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =ColorValue(varThemeColors.text)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =ColorValue(varThemeColors.primary)
                FocusedBorderThickness: =4
                Font: =varThemeFont.H2.face
                FontWeight: =varThemeFont.H2.weight
                Height: =Self.Size*4
                Italic: =varThemeFont.H2.italic
                LayoutMinHeight: =70
                LayoutMinWidth: =560
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingTop: =0
                Role: =TextRole.Heading1
                Size: =varThemeFont.H1.size
                Text: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Review & Submit"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text 
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text 
                            ).'Localized Value'
                        )
                    )
                Width: =Parent.Width - 80
                X: =40
                ZIndex: =1

        conSubmissionDetails_Review As groupContainer.verticalAutoLayoutContainer:
            Fill: =ColorValue(varThemeColors.backgroundFill)
            Height: |
                =//lblCategoryName_Message.Height +lblCategoryDescription_Message.Height+75
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =3

            conRecognitionHeader_Review As groupContainer.horizontalAutoLayoutContainer:
                FillPortions: =0
                Height: =conCategoryDescription_Review.Height+25
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutMinHeight: =112
                LayoutMinWidth: =165
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =20
                ZIndex: =1

                imgRecognitionCategory_Review As image:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: varSelectedAward.Name},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text 
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text 
                                ).'Localized Value'
                            )
                        )
                    Height: =Self.Width
                    Image: =If(!IsBlankOrError(varSelectedAward.Image), varSelectedAward.Image, DefaultAwardImage)
                    LayoutMinHeight: =320
                    LayoutMinWidth: =320
                    OnSelect: =
                    RadiusBottomLeft: =25
                    RadiusBottomRight: =25
                    RadiusTopLeft: =25
                    RadiusTopRight: =25
                    X: =20
                    Y: =
                    ZIndex: =1

                conCategoryDescription_Review As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Height: =lblCategoryName_Review.Height + lblCategoryCopy_Review.Height + 20
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =112
                    LayoutMinWidth: =100
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =2

                    lblCategoryName_Review As label:
                        AutoHeight: =true
                        Color: =ColorValue(varThemeColors.text)
                        Font: =varThemeFont.H2.face
                        FontWeight: =varThemeFont.H2.weight
                        Height: =Self.Size * 1.8
                        Italic: =varThemeFont.H2.italic
                        LayoutMinHeight: =70
                        LayoutMinWidth: =560
                        OnSelect: =
                        PaddingBottom: =3
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: |-
                            =//18//varThemeFont.H2.size
                            varThemeFont.H3.size
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: varSelectedAward.Name},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text 
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text 
                                    ).'Localized Value'
                                )
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.Width *.9
                        X: =(Parent.Width/2) - (Self.Width/2)
                        Y: =imgRecognitionCategory_Review.Y + imgRecognitionCategory_Review.Height + 10
                        ZIndex: =1

                    lblCategoryCopy_Review As label:
                        AutoHeight: =true
                        Color: =ColorValue(varThemeColors.text)
                        Font: =varThemeFont.B2.face
                        FontWeight: =FontWeight.Lighter
                        Height: =Self.Size * 1.8
                        Italic: =varThemeFont.B1.italic
                        LayoutMinHeight: =70
                        LayoutMinWidth: =560
                        OnSelect: =
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =varThemeFont.B2.size
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: varSelectedAward.Description},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text 
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text 
                                    ).'Localized Value'
                                )
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.Width *.9
                        X: =(Parent.Width/2) - (Self.Width/2)
                        Y: =lblCategoryName_Review.Y + lblCategoryName_Review.Height + 4
                        ZIndex: =2

            shpSeparator_Review As rectangle:
                AccessibleLabel: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Separator"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text 
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text 
                            ).'Localized Value'
                        )
                    )
                AlignInContainer: =AlignInContainer.Center
                Fill: =ColorValue(varThemeColors.primaryGray&"80")
                Height: =1
                Width: =Parent.Width*.9
                ZIndex: =2

            conInputsMessage_Review As groupContainer.verticalAutoLayoutContainer:
                Height: =225
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =112
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowX: =LayoutOverflow.Scroll
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =20
                PaddingRight: =10
                ZIndex: =3

                conMessage_Review As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.Start
                    FillPortions: =0
                    Height: =galNominee_Review.Height+lblMessageTitle_Review.Height+lblMessageSent_Review.Height+lblRatings_Review.Height+galQuestions_Review.Height+100
                    LayoutMinHeight: =112
                    LayoutMinWidth: =250
                    Width: =Parent.Width*.94
                    Y: =
                    ZIndex: =1

                    "galQuestions_Review As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Award Questions"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text 
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text 
                                    ).'Localized Value'
                                )
                            )
                        Height: |
                            =//381
                            CountRows(colRatingResponses) * Self.TemplateHeight +50
                        Items: =colRatingResponses
                        Layout: =Layout.Vertical
                        TabIndex: =0
                        TemplateSize: =lblQuestionName_Review.Height+rtgRating_Review.Height
                        Width: =593
                        X: |
                            =galNominee_Review.X-5
                        Y: =lblRatings_Review.Y+lblRatings_Review.Height+10
                        ZIndex: =1

                        rtgRating_Review As rating:
                            AccessibleLabel: =ThisItem.Rating
                            BorderColor: =ColorValue(varThemeColors.primary)
                            Default: =ThisItem.Rating
                            DisabledFill: =Self.Fill
                            DisplayMode: =DisplayMode.View
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FocusedBorderColor: =ColorValue(varThemeColors.info)
                            FocusedBorderThickness: =4
                            Height: =50
                            HoverFill: =Self.Fill
                            Max: =5
                            OnSelect: =Set(varMissingQuestions,CountIf(galQuestions_Review.AllItems, rtgRating_Ratings.Value=0))
                            PressedFill: =Self.Fill
                            RatingFill: =ColorValue(varThemeColors.primary)
                            ShowValue: =true
                            Width: =223
                            X: =0
                            Y: =lblQuestionName_Review.Height+lblQuestionName_Review.Y-5
                            ZIndex: =1

                        lblQuestionName_Review As label:
                            Color: =ColorValue(varThemeColors.text)
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weight
                            Height: =Self.Size * 2
                            Italic: =varThemeFont.B2.italic
                            OnSelect: =Select(Parent)
                            Overflow: =Overflow.Scroll
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =varThemeFont.B2.size
                            Text: =ThisItem.AwardAssessmentRating.Name
                            Tooltip: =Self.Text
                            VerticalAlign: =VerticalAlign.Top
                            Width: =Parent.TemplateWidth
                            ZIndex: =3

                    lblRatings_Review As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =ColorValue(varThemeColors.text)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =ColorValue(varThemeColors.primary)
                        FocusedBorderThickness: =4
                        Font: =varThemeFont.H3.face
                        FontWeight: =varThemeFont.H2.weight
                        Height: =Self.Size*1.8
                        Italic: =varThemeFont.H3.italic
                        PaddingBottom: =10
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =varThemeFont.H3.size
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Ratings"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text 
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text 
                                    ).'Localized Value'
                                )
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Visible: |-
                            =// Only show the "Ratings" label if there are ratings
                            If(CountRows(galQuestions_Review.AllItems)>0,true,false)
                        Width: =584
                        X: =galNominee_Review.X
                        Y: =lblMessageSent_Review.Y+lblMessageSent_Review.Height+20
                        ZIndex: =2

                    lblMessageSent_Review As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =ColorValue(varThemeColors.text)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =ColorValue(varThemeColors.primary)
                        FocusedBorderThickness: =4
                        Font: =varThemeFont.B2.face
                        FontWeight: =varThemeFont.B2.weight
                        Height: =186
                        Italic: =varThemeFont.B2.italic
                        PaddingBottom: =10
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =varThemeFont.B2.size
                        Text: =Trim(varRationale)
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.Width*.98
                        X: |
                            =lblMessageTitle_Review.X
                        Y: =lblMessageTitle_Review.Y+lblMessageTitle_Review.Height+10
                        ZIndex: =3

                    lblMessageTitle_Review As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =ColorValue(varThemeColors.text)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =ColorValue(varThemeColors.primary)
                        FocusedBorderThickness: =4
                        Font: =varThemeFont.H3.face
                        FontWeight: =varThemeFont.H2.weight
                        Height: =36
                        Italic: =varThemeFont.H3.italic
                        PaddingBottom: =10
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =varThemeFont.H3.size
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Rationale"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text 
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text 
                                    ).'Localized Value'
                                )
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: =584
                        X: |
                            =//galNominee_Review.Height+lblMessageTitle_Review.Height+lblMessageSent_Review.Height+lblRatings_Review.Height+galQuestions_Review.Height+100
                        Y: =btnGalleryHeight_Review.Y+btnGalleryHeight_Review.Height
                        ZIndex: =4

                    btnGalleryHeight_Review As button:
                        BorderColor: =ColorValue(varThemeColors.text)
                        BorderThickness: =0
                        Color: =ColorValue(varThemeColors.text)
                        DisabledBorderColor: =RGBA(0,0,0,0)
                        DisabledColor: =ColorValue(varThemeColors.disabledText)
                        DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Font: =varThemeFont.B3.face
                        FontWeight: =varThemeFont.B3.weightBold
                        Height: =25
                        HoverBorderColor: =RGBA(0,0,0,0)
                        HoverColor: =ColorValue(varThemeColors.text)
                        HoverFill: =ColorValue(varThemeColors.backgroundFill)
                        Italic: =varThemeFont.B3.italic
                        OnSelect: =Set(varNomineeGalHeight,!varNomineeGalHeight)
                        PressedBorderColor: =RGBA(0,0,0,0)
                        PressedColor: =ColorValue(varThemeColors.text)
                        PressedFill: =ColorValue(varThemeColors.backgroundFill)
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Size: =varThemeFont.B3.size
                        Text: |-
                            =With(
                                {Text: If(varNomineeGalHeight, "See less", "See more")},
                                If(
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text 
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text 
                                    ).'Localized Value'
                                )
                            )
                        VerticalAlign: =VerticalAlign.Bottom
                        Visible: =If(CountRows(colNominatedUsers)>2, true, false)
                        Width: =85
                        X: =Parent.Width-Self.Width-5
                        Y: =galNominee_Review.Y+galNominee_Review.Height
                        ZIndex: =5

                    galNominee_Review As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Nominees List"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text 
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text 
                                    ).'Localized Value'
                                )
                            )
                        DelayItemLoading: =true
                        DisplayMode: =DisplayMode.View
                        Height: |
                            =//Set expanded height if varNomineeGalHeight = true, else set height to one template 
                            If(varNomineeGalHeight, 
                            //Set height to half of number of gallery items, if number is odd round up 
                            (If(Mod(CountRows(colNominatedUsers), 2) = 1, RoundUp(CountRows(colNominatedUsers) + 1, 0), CountRows(colNominatedUsers))+1) * Self.TemplateHeight /2, Self.TemplateHeight)
                        Items: =colNominatedUsers
                        Layout: =Layout.Vertical
                        LoadingSpinner: =LoadingSpinner.Data
                        ShowScrollbar: =false
                        TabIndex: =-1 //Noninteractive control, view only does not need a tab index of 0
                        TemplateSize: =imgCurrentPFP_Review.Height+10
                        Width: =Parent.Width
                        WrapCount: =2
                        Y: =lblNomineeTitle_Review.Y+lblNomineeTitle_Review.Height+10
                        ZIndex: =7

                        lblNomineeEmail_Review As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =ColorValue(varThemeColors.text)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisplayMode: =DisplayMode.View
                            FocusedBorderColor: =ColorValue(varThemeColors.primary)
                            FocusedBorderThickness: =4
                            Font: =varThemeFont.B3.face
                            FontWeight: =FontWeight.Lighter
                            Height: =Self.Size*2
                            Italic: =varThemeFont.B3.italic
                            PaddingBottom: =10
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =varThemeFont.B3.size-2
                            Text: =ThisItem.NomineeRecord.'Primary Email'
                            Tooltip: =Self.Text
                            VerticalAlign: =VerticalAlign.Top
                            Width: =lblNomineeName_Review.Width
                            X: =lblNomineeName_Review.X
                            Y: =lblNomineeName_Review.Y+lblNomineeName_Review.Height+1
                            ZIndex: =2

                        lblNomineeName_Review As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =ColorValue(varThemeColors.text)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorValue(varThemeColors.primary)
                            FocusedBorderThickness: =4
                            Font: =varThemeFont.B3.face
                            FontWeight: =varThemeFont.B3.weightBold
                            Height: =Self.Size*1.8
                            Italic: =varThemeFont.B3.italic
                            PaddingBottom: =10
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =varThemeFont.B3.size
                            Text: =ThisItem.NomineeRecord.'Full Name'
                            VerticalAlign: =VerticalAlign.Top
                            Width: =Parent.Width*.4
                            X: =imgCurrentPFP_Review.X+imgCurrentPFP_Review.Width+10
                            Y: =imgCurrentPFP_Review.Y
                            ZIndex: =3

                        grpGalleryNomineePFP_Review As group:
                            Height: =5
                            Width: =5
                            X: =25
                            Y: =-40
                            ZIndex: =8

                            shpCircle_Review As circle:
                                DisplayMode: =DisplayMode.Disabled
                                Fill: =ColorValue(varThemeColors.secondary)
                                Height: =40
                                Visible: =!imgCurrentPFP_Review.Visible
                                Width: =Self.Height
                                ZIndex: =5

                            lblInitials_Review As label:
                                Align: =Align.Center
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                DisabledColor: =Self.Color
                                DisplayMode: =DisplayMode.Disabled
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: |
                                    =Self.Height/2.5
                                Text: |-
                                    =With(
                                       {
                                          wName: 
                                          Split(
                                             ThisItem.NomineeRecord.'Full Name',
                                             " "
                                          )
                                       },
                                       Left(First(wName).Value, 1) & Left(Last(wName).Value, 1)
                                    )
                                Visible: =!imgCurrentPFP_Review.Visible
                                Width: =Self.Height
                                ZIndex: =6

                            imgCurrentPFP_Review As image:
                                AccessibleLabel: |-
                                    =With(
                                        {Text: "User Picture"},
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text 
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text 
                                            ).'Localized Value'
                                        )
                                    )
                                DisplayMode: =DisplayMode.Disabled
                                Height: =40
                                Image: =If(!IsBlank(ThisItem.NomineeRecord.'Primary Email')&& Office365Users.UserPhotoMetadata(ThisItem.NomineeRecord.'Primary Email').HasPhoto, Office365Users.UserPhotoV2(ThisItem.NomineeRecord.'Primary Email'))
                                RadiusBottomLeft: =Self.Height
                                RadiusBottomRight: =Self.Height
                                RadiusTopLeft: =Self.Height
                                RadiusTopRight: =Self.Height
                                Visible: =!IsBlank(Self.Image)
                                Width: =Self.Height
                                ZIndex: =7

                    lblNomineeTitle_Review As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =ColorValue(varThemeColors.text)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =ColorValue(varThemeColors.primary)
                        FocusedBorderThickness: =4
                        Font: =varThemeFont.H3.face
                        FontWeight: =varThemeFont.B2.weightBold
                        Height: =36
                        Italic: =varThemeFont.H3.italic
                        PaddingBottom: =10
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =varThemeFont.H3.size
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: If(CountRows(colNominatedUsers)>1,"Nominees","Nominee") & If(varNomineeType="Team"," (Team: " & varGroup.Name & ")","")},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text 
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text 
                                    ).'Localized Value'
                                )
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: =584
                        X: =//galNominee_Review.Height+lblMessageTitle_Review.Height+lblMessageSent_Review.Height+lblRatings_Review.Height+galQuestions_Review.Height+100
                        Y: =20
                        ZIndex: =8

        conSubmit_Review As groupContainer.horizontalAutoLayoutContainer:
            Fill: =ColorValue(varThemeColors.backgroundFill)
            FillPortions: =0
            Height: =100
            LayoutGap: =10
            LayoutJustifyContent: =LayoutJustifyContent.End
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =40
            PaddingRight: =20
            PaddingTop: =20
            ZIndex: =4

            btnSubmit_Review As button:
                BorderColor: =ColorValue(varThemeColors.primary)
                BorderThickness: =1
                Color: =ColorValue(varThemeColors.altText)
                DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                DisabledColor: =ColorValue(varThemeColors.disabledText)
                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                DisplayMode: |-
                    =If(
                        IsBlank(
                            Validate(
                                Nominations,
                                Defaults(Nominations),
                                {
                                    Name: varNomineeType & "-" & varSelectedAward.Name & "-" & Text(Now(), "[$-en-US]mm/dd/yyyy hh:mm:ss tt"),
                                    Nominee: If(varNomineeType="Person",First(colNominatedUsers).NomineeRecord,Blank()),
                                    Group: If(varNomineeType="Team",varGroup,Blank()),
                                    Rationale: varRationale,
                                    Award: varSelectedAward,
                                    'Submitted By': LookUp(
                                        Users,
                                        'Primary Email' = varSubmittedByEmail
                                    ),
                                    'Nomination Period': varNominationPeriod,
                                    Type: 
                                        Switch(
                                            varNomineeType,
                                            "Person", 'Nomination Type'.'Single Individual',
                                            "People", 'Nomination Type'.'User-Defined Group',
                                            "Team", 'Nomination Type'.'Pre-Defined Group'
                                        )
                                }
                            )
                        ),
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                Fill: =ColorValue(varThemeColors.primary)
                FocusedBorderColor: =ColorValue(varThemeColors.info)
                Font: =varThemeFont.CTA.face
                FontWeight: =FontWeight.Normal
                HoverBorderColor: =ColorValue(varThemeColors.primary)
                HoverColor: =ColorValue(varThemeColors.altText)
                HoverFill: =ColorValue(varThemeColors.tertiary)
                Italic: =varThemeFont.CTA.italic
                LayoutMinHeight: =70
                LayoutMinWidth: =280
                OnSelect: |+
                    =// ***************************
                    // * varNominationPeriod = Contains the Nomination Period record
                    // * varSelectedAward = Contains the Award record
                    // * varNomineeType = Contains text corresponding to the nomination type: People|Person|Team
                    // * varGroup = Contains the Group record if it is varNomineeType="Team"
                    // * varRationale = Contains the rationale text provided
                    // * varSearchTeamTxt = Contains the terms that are useful for searching
                    // * colNominatedUsers = Contains all the nominated users
                    // * colRatingResponses = Contains all the star ratings
                    
                    // Reset the variable that will hold the record of the new nomination submission
                    Set(varNewNominationRecord, {});
                    
                    // ** Build Search Team Text **
                    // ** Concat all user names
                    Set(
                        varSearchTeamTxt,
                        Concat(colNominatedUsers, ThisRecord.NomineeRecord.'Full Name' & " ")
                    );
                    // ** Add Award Name, and Nomination Period Name
                    Set(
                        varSearchTeamTxt,
                        varSelectedAward.Name & " " & varNominationPeriod.Name & " " & varSearchTeamTxt
                    );
                    // ** Add Type and GroupName (if group)
                    Set(
                        varSearchTeamTxt,
                        If(
                            varNomineeType="Team",
                            varNomineeType & " " & varGroup.Name & " " & varSearchTeamTxt,
                            varNomineeType & " " & varSearchTeamTxt
                        )
                    );
                    
                    
                    // Create the Nomination
                    Set(
                        varNewNominationRecord,
                        Patch(
                            Nominations,
                            Defaults(Nominations),
                            {
                                Name: varNomineeType & "-" & varSelectedAward.Name & "-" & Text(Now(), "[$-en-US]mm/dd/yyyy hh:mm:ss"),
                                'Search Terms': varSearchTeamTxt,
                                Nominee: If(varNomineeType="Person",First(colNominatedUsers).NomineeRecord,Blank()),
                                Group: If(varNomineeType="Team",varGroup,Blank()),
                                Rationale: Trim(varRationale),
                                Award: varSelectedAward,
                                'Submitted By': LookUp(
                                    Users,
                                    'Primary Email' = varSubmittedByEmail
                                ),
                                'Nomination Period': varNominationPeriod,
                                Type: 
                                    Switch(
                                        varNomineeType,
                                        "Person", 'Nomination Type'.'Single Individual',
                                        "People", 'Nomination Type'.'User-Defined Group',
                                        "Team", 'Nomination Type'.'Pre-Defined Group'
                                    )
                            }
                        )
                    );
                    
                    // Check for an error
                    If(
                        IsBlank(varNewNominationRecord),
                        // If varNewNominationRecord is blank, there was an error with the Patch operation.
                        Navigate(
                            'Error Screen',
                            ScreenTransition.Cover,
                            {Message: "The nomination submission failed - please report the following errors to the app administrator."}
                        )
                        ;
                    );
                    
                    // Create Nominated Users Records
                    ForAll(
                        colNominatedUsers,
                        Patch(
                            'Nominated Users',
                            Defaults('Nominated Users'),
                            {
                                Name: NomineeRecord.'Full Name' & "-" & varNomineeType & "-" & varSelectedAward.Name & "-" & Text(Now(), "[$-en-US]mm/dd/yyyy hh:mm:ss tt"),
                                'Nomination Period': varNominationPeriod,
                                Nomination: varNewNominationRecord,
                                User: NomineeRecord,
                                Award: varSelectedAward,
                                'Submitted By': LookUp(Users,'Primary Email' = varSubmittedByEmail),
                                Group: If(varNomineeType="Team",varGroup,Blank())
                            }
                        )
                    );
                    
                    // Create Ratings
                    ForAll(
                        colRatingResponses,
                        Patch(
                            'Nomination Ratings',
                            Defaults('Nomination Ratings'),
                            {
                                Name: ThisRecord.AwardAssessmentRating.Name & " - " & Text(ThisRecord.Rating),
                                Nomination: varNewNominationRecord,
                                Rating: ThisRecord.Rating,
                                'Award Assessment Rating': ThisRecord.AwardAssessmentRating
                            }
                        )
                    );
                    
                    
                    // Clear working global variables & collections
                    Clear(colRatingResponses);
                    Clear(colNominatedUsers);
                    Set(varNominationPeriod, {});
                    Set(varSelectedAward, {});
                    Set(varNomineeType, "");
                    Set(varGroup, {});
                    Set(varRationale, "");
                    Set(varPeopleSelect, "");
                    
                    // Reset controls 
                    Reset(txtMessage_Rational);
                    Reset(cmbPersonSelect_Recognition);
                    Reset(cmbPeopleSelect_Recognition);
                    Reset(cmbTeamSelect_Recognition);
                    Reset(cmbNominationPeriodChoice_Main);
                    Reset(galAwards_AwardSelection);
                    
                    // Navigate
                    Navigate('Success Screen');
                    
                PressedBorderColor: =ColorValue(varThemeColors.primary)
                PressedColor: =ColorValue(varThemeColors.altText)
                PressedFill: =ColorValue(varThemeColors.primary)
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =varThemeFont.CTA.size
                Text: |-
                    =With(
                        {Text: "Submit"},
                        If(
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text 
                                ).'Localized Value'
                            ),
                            Text,
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text 
                            ).'Localized Value'
                        )
                    )
                Width: =Parent.Width/3.3
                X: =1
                Y: =
                ZIndex: =2

    compHeader_Review As compHeader:
        HeaderComponentWidth: =Parent.Width
        Height: =compHeader_Review.HeaderComponentHeight
        Width: =compHeader_Review.HeaderComponentWidth
        ZIndex: =2

