"'Booking Screen' As screen":
    OnVisible: =Reset(txtComments_BookingScreen); //Clear old Comments

    conMain_BookingScreen As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =ColorValue(varThemeColors.background)
        Height: =Parent.Height - Self.Y
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =Parent.Width
        Y: =compHeader_BookingScreen.Height
        ZIndex: =1

        conGallery_BookingScreen As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.None
            Fill: =ColorValue(varThemeColors.background)
            Height: =
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =20
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =40
            PaddingLeft: =80
            PaddingRight: =80
            PaddingTop: =40
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            X: =40
            Y: =40
            ZIndex: =2

            lblTitle_BookingScreen As label:
                AutoHeight: =true
                Color: =ColorValue(varThemeColors.text)
                FocusedBorderColor: =ColorValue(varThemeColors.info)
                Font: =varThemeFont.H1.face
                FontWeight: =varThemeFont.H1.weight
                Height: =Self.Size * 2.5
                Italic: =varThemeFont.H1.italic
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingTop: =0
                Role: =TextRole.Heading2
                Size: =varThemeFont.H1.size
                Text: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Booking Details"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Tooltip: =Self.Text
                Width: =539
                X: =20
                Y: =12.5
                ZIndex: =1

            conBookingDetails_BookingScreen As groupContainer.horizontalAutoLayoutContainer:
                Fill: =ColorValue(varThemeColors.backgroundFill)
                LayoutDirection: =If('Booking Screen'.Size < 3, LayoutDirection.Vertical, LayoutDirection.Horizontal)
                LayoutGap: =20
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                LayoutWrap: =If('Booking Screen'.Size < 3, false, true)
                PaddingBottom: =40
                PaddingLeft: =40
                PaddingRight: =40
                PaddingTop: =40
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                ZIndex: =2

                conBookingDetails_Requestor As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FillPortions: =0
                    Height: =100
                    LayoutGap: =20
                    LayoutMinHeight: =100
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =If('Booking Screen'.Size < 3, (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)-10), (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)) / 3.2)
                    ZIndex: =1

                    "icoRequestor_BookingScreen As icon.'3DPrinting'":
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Requestor Icon"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =ColorValue(varThemeColors.primary)
                        Color: =ColorValue(varThemeColors.primary)
                        DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                        DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Height: =30
                        HoverBorderColor: =ColorValue(varThemeColors.primary)
                        HoverColor: =ColorValue(varThemeColors.tertiary)
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.Person
                        OnSelect: =
                        PressedBorderColor: =ColorValue(varThemeColors.primary)
                        PressedColor: =ColorValue(varThemeColors.primary)
                        PressedFill: =RGBA(0,0,0,0)
                        Width: =30
                        X: =20
                        Y: =40
                        ZIndex: =1

                    conBookingDetails_Requestor_Labels As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - icoRequestor_BookingScreen.Width - Parent.LayoutGap
                        ZIndex: =4

                        lblRequestorName_BookingScreen As label:
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.H3.face
                            FontWeight: =varThemeFont.H3.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.H3.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.H3.size
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: varSelRequestor.DisplayName},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Parent.Width
                            Wrap: =false
                            X: =icoRequestor_BookingScreen.X + icoRequestor_BookingScreen.Width + 10
                            Y: =icoRequestor_BookingScreen.Y
                            ZIndex: =1

                        lblRequestorEmail_BookingScreen As label:
                            AutoHeight: =true
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.B1.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.B1.size
                            Text: =varSelRequestor.UserPrincipalName
                            Tooltip: =Self.Text
                            Width: =Parent.Width
                            Wrap: =false
                            ZIndex: =2

                conBookingDetails_DateTime As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FillPortions: =0
                    Height: =100
                    LayoutGap: =20
                    LayoutMinHeight: =100
                    LayoutMinWidth: =If('Booking Screen'.Size < 3, (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)-10), (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)) / 3.2)
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =If('Booking Screen'.Size < 3, (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)-10), (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)) / 3.2)
                    ZIndex: =2

                    "icoDate_BookingScreen As icon.'3DPrinting'":
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Date Time Icon"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =ColorValue(varThemeColors.primary)
                        Color: =ColorValue(varThemeColors.primary)
                        DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                        DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Height: =30
                        HoverBorderColor: =ColorValue(varThemeColors.primary)
                        HoverColor: =ColorValue(varThemeColors.tertiary)
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.CalendarBlank
                        OnSelect: =
                        PressedBorderColor: =ColorValue(varThemeColors.primary)
                        PressedColor: =ColorValue(varThemeColors.primary)
                        PressedFill: =RGBA(0,0,0,0)
                        Width: =30
                        X: =476
                        ZIndex: =1

                    conBookingDetails_DateTime_Labels As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - icoDate_BookingScreen.Width - Parent.LayoutGap
                        ZIndex: =5

                        lblDate_BookingScreen As label:
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.H3.face
                            FontWeight: =varThemeFont.H3.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.H3.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.H3.size
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: Text(varSelectedSlot.mpa_aptbk_startdate,"dddd, ")& Text(DateValue(varSelectedSlot.mpa_aptbk_startdate),"mmmm dd, yyyy")},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Parent.Width
                            Wrap: =false
                            X: =icoDate_BookingScreen.X + icoDate_BookingScreen.Width + 10
                            ZIndex: =1

                        lblDuration_BookingScreen As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            AutoHeight: =true
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.B1.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.B1.size
                            Text: |-
                                =$" {Text(varSelectedSlot.mpa_aptbk_startdate,"HH:mm AM/PM") & " - " & Text(varSelectedSlot.mpa_aptbk_enddate,"HH:mm AM/PM")}  ({If(
                                    Mod(
                                        LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid
                                        ).mpa_aptbk_duration,
                                        60
                                    ) <> 0,//If Mod 60=0 Mins
                                    If(//If Mins > 60 Hours w/ decimal
                                        LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid
                                        ).mpa_aptbk_duration > 60,
                                        LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid
                                        ).mpa_aptbk_duration / 60 & " Hr",
                                        LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid
                                        ).mpa_aptbk_duration & " Min"
                                    ) & "",
                                    Mod(//getting the hours
                                        LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid
                                        ).mpa_aptbk_duration / 60,
                                        24
                                    ) <> 0,
                                    LookUp(
                                        'Appointment Slots',
                                        'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid
                                    ).mpa_aptbk_duration / 60 & If(
                                        LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid
                                        ).mpa_aptbk_duration / 60 = 1,
                                        " Hr",
                                        " Hrs"
                                    ),
                                    LookUp(//getting the number of days
                                        'Appointment Slots',
                                        'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid
                                    ).mpa_aptbk_duration / 60 / 24 & If(
                                        LookUp(//getting the number of days
                                            'Appointment Slots',
                                            'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid
                                        ).mpa_aptbk_duration / 60 / 24 = 1,
                                        " Day",
                                        " Days"
                                    )
                                )})"
                            Tooltip: =Self.Text
                            Width: |-
                                =//Self.Size * Len(Self.Text)
                                Parent.Width
                            Wrap: =false
                            ZIndex: =2

                conBookingDetails_AppointmentType As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FillPortions: =0
                    Height: =100
                    LayoutGap: =20
                    LayoutMinHeight: =100
                    LayoutMinWidth: =If('Booking Screen'.Size < 3, (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)-10), (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)) / 3.2)
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =If('Booking Screen'.Size < 3, (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)-10), (Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)) / 3.2)
                    ZIndex: =3

                    "icoAppointment_BookingScreen As icon.'3DPrinting'":
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Appointment type icon"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =ColorValue(varThemeColors.primary)
                        Color: =ColorValue(varThemeColors.primary)
                        DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                        DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Height: =30
                        HoverBorderColor: =ColorValue(varThemeColors.primary)
                        HoverColor: =ColorValue(varThemeColors.tertiary)
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.DocumentWithContent
                        OnSelect: =
                        PressedBorderColor: =ColorValue(varThemeColors.primary)
                        PressedColor: =ColorValue(varThemeColors.primary)
                        PressedFill: =RGBA(0,0,0,0)
                        Width: =30
                        X: =860
                        ZIndex: =1

                    conBookingDetails_AppointmentType_Labels As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - icoAppointment_BookingScreen.Width - Parent.LayoutGap
                        ZIndex: =4

                        lblAppointment_BookingScreen As label:
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.H3.face
                            FontWeight: =varThemeFont.H3.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.H3.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.H3.size
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: varSelectedSlot.mpa_aptbk_appointmenttype.'Appointment Type Name'},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Parent.Width
                            Wrap: =false
                            X: =icoAppointment_BookingScreen.X + icoAppointment_BookingScreen.Width + 10
                            ZIndex: =1

                        lblAppointmentTitle_BookingScreen As label:
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.B1.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.B1.size
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Appointment Type"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Parent.Width
                            Wrap: =false
                            ZIndex: =2

                conBookingDetails_AppointmentContact As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FillPortions: =0
                    Height: =100
                    LayoutGap: =20
                    LayoutMinHeight: =100
                    LayoutMinWidth: =conBookingDetails_Requestor.Width
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =conBookingDetails_Requestor.Width
                    ZIndex: =4

                    "icoContact_BookingScreen As icon.'3DPrinting'":
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Appointment contact icon"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =ColorValue(varThemeColors.primary)
                        Color: =ColorValue(varThemeColors.primary)
                        DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                        DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Height: =30
                        HoverBorderColor: =ColorValue(varThemeColors.primary)
                        HoverColor: =ColorValue(varThemeColors.tertiary)
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.People
                        OnSelect: =
                        PressedBorderColor: =ColorValue(varThemeColors.primary)
                        PressedColor: =ColorValue(varThemeColors.primary)
                        PressedFill: =RGBA(0,0,0,0)
                        Width: =30
                        ZIndex: =1

                    conBookingDetails_Contact_Labels As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - icoContact_BookingScreen.Width - Parent.LayoutGap
                        ZIndex: =4

                        lblContact_BookingScreen As label:
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.H3.face
                            FontWeight: =varThemeFont.H3.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.H3.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.H3.size
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: LookUp('Appointment Slots' , 'Appointment Slot ID' = varSelectedSlot.mpa_aptbk_appointmentslotid).'Meeting Provider'.'Full Name'},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Parent.Width
                            Wrap: =false
                            X: =icoContact_BookingScreen.X + icoContact_BookingScreen.Width + 10
                            Y: =icoContact_BookingScreen.Y - 5
                            ZIndex: =1

                        lblContactTitle_BookingScreen As label:
                            AutoHeight: =true
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.B1.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.B1.size
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Meeting Provider"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Parent.Width
                            Wrap: =false
                            X: =icoContact_BookingScreen.X + icoContact_BookingScreen.Width + 10
                            Y: =lblContact_BookingScreen.Y + lblContact_BookingScreen.Height
                            ZIndex: =2

                conBookingDetails_LocationDetails As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.Start
                    DropShadow: =DropShadow.None
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FillPortions: =0
                    Height: =100
                    LayoutGap: =20
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =conBookingDetails_DateTime.Width
                    X: =conBookingDetails_DateTime.X
                    ZIndex: =5

                    "icoLocation_BookingScreen As icon.'3DPrinting'":
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Location icon"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =ColorValue(varThemeColors.primary)
                        Color: =ColorValue(varThemeColors.primary)
                        DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                        DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Height: =30
                        HoverBorderColor: =ColorValue(varThemeColors.primary)
                        HoverColor: =ColorValue(varThemeColors.tertiary)
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.Waypoint
                        OnSelect: =
                        PressedBorderColor: =ColorValue(varThemeColors.primary)
                        PressedColor: =ColorValue(varThemeColors.primary)
                        PressedFill: =RGBA(0,0,0,0)
                        Width: =30
                        X: =476
                        ZIndex: =1

                    conBookingDetails_Location_Labels As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - icoLocation_BookingScreen.Width - Parent.LayoutGap
                        ZIndex: =4

                        lblLocation_BookingScreen As label:
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.H3.face
                            FontWeight: =varThemeFont.H3.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.H3.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.H3.size
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: Text(varSelectedSlot.mpa_aptbk_location) & " " & Text(varSelectedSlot.'Location Details'.'Location Name') & Text(varSelectedSlot.mpa_aptbk_meetinglink) & Text(varSelectedSlot.mpa_aptbk_phonenumber) & If(
                                            varSelectedSlot.mpa_aptbk_location = 'Appointment Location'.'In Person',
                                            " " & varSelectedSlot.'Room Number'.'Room Number'
                                        )
                                    },
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Parent.Width
                            Wrap: =false
                            X: =icoLocation_BookingScreen.X + icoLocation_BookingScreen.Width + 10
                            ZIndex: =1

                        lblLocationTitle_BookingScreen As label:
                            AutoHeight: =true
                            Color: =ColorValue(varThemeColors.text)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.B1.italic
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =varThemeFont.B1.size
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Meeting via"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Parent.Width
                            X: =icoLocation_BookingScreen.X + icoLocation_BookingScreen.Width + 10
                            Y: =lblLocation_BookingScreen.Y + lblLocation_BookingScreen.Height
                            ZIndex: =2

                conBookingDetails_Comments As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FillPortions: =0
                    Height: =lblComments_BookingScreen.Height + txtComments_BookingScreen.Height + 120
                    LayoutGap: =10
                    LayoutMinHeight: =100
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: |-
                        =If('Booking Screen'.Size < 3, 
                            270,
                            conBookingDetails_AppointmentContact.Width +
                            conBookingDetails_LocationDetails.Width 
                        )
                    ZIndex: =6

                    "icoComment_BookingScreen As icon.'3DPrinting'":
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Comment Icon"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =ColorValue(varThemeColors.primary)
                        Color: =ColorValue(varThemeColors.primary)
                        DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                        DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Height: =30
                        HoverBorderColor: =ColorValue(varThemeColors.primary)
                        HoverColor: =ColorValue(varThemeColors.tertiary)
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.Message
                        OnSelect: =
                        PressedBorderColor: =ColorValue(varThemeColors.primary)
                        PressedColor: =ColorValue(varThemeColors.primary)
                        PressedFill: =RGBA(0,0,0,0)
                        Width: =30
                        ZIndex: =1

                    conBookingDetails_Comments_Content As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        Height: =Parent.Height + 100
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =5
                        PaddingRight: =5
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        ZIndex: =6

                        conBookingDetails_Comments_Labels As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FillPortions: =0
                            Height: =lblComments_BookingScreen.Height
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.Width - 9
                            ZIndex: =1

                            lblComments_BookingScreen As label:
                                Color: =ColorValue(varThemeColors.text)
                                FillPortions: =1
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                Font: =varThemeFont.H3.face
                                FontWeight: =varThemeFont.H3.weight
                                Height: =Self.Size * 2.5
                                Italic: =varThemeFont.H3.italic
                                LayoutMinWidth: =100
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Role: =TextRole.Heading2
                                Size: =varThemeFont.H3.size
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Comments"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =280
                                X: =icoComment_BookingScreen.X + icoComment_BookingScreen.Width + 10
                                Y: =icoComment_BookingScreen.Y - 5
                                ZIndex: =1

                            lblOptional_BookingScreen As label:
                                Align: =Align.Right
                                AutoHeight: =true
                                Color: =ColorValue(varThemeColors.text)
                                FillPortions: =1
                                FocusedBorderColor: =ColorValue(varThemeColors.info)
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weight
                                Height: =Self.Size * 2.5
                                Italic: =varThemeFont.B2.italic
                                LayoutMinWidth: =50
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingTop: =10
                                Role: =TextRole.Heading2
                                Size: =varThemeFont.B2.size
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Optional"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                VerticalAlign: =VerticalAlign.Bottom
                                Width: =425
                                ZIndex: =2

                        txtComments_BookingScreen As text:
                            AccessibleLabel: |-
                                =With(
                                    {Text: "Comments"},
                                    If(
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            BorderColor: =ColorValue(varThemeColors.primaryGray)
                            BorderThickness: =1
                            Color: =ColorValue(varThemeColors.text)
                            Default: |-
                                =With(
                                    {Text: ""},
                                    If(
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            DisabledBorderColor: =ColorValue(varThemeColors.primaryGray)
                            DisabledColor: =ColorValue(varThemeColors.disabledText)
                            DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =Value(varThemeColors.focusBorderThickness)
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =90
                            HintText: |-
                                =With(
                                    {Text: "Enter text"},
                                    If(
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            HoverBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                            HoverColor: =ColorValue(varThemeColors.text)
                            HoverFill: =ColorValue(varThemeColors.backgroundFill)
                            Italic: =varThemeFont.B1.italic
                            MaxLength: =1000
                            Mode: =TextMode.MultiLine
                            PressedBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                            PressedColor: =ColorValue(varThemeColors.text)
                            PressedFill: =ColorValue(varThemeColors.backgroundFill)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =varThemeFont.B1.size
                            Tooltip: =Self.Text
                            Width: =Parent.Width - (Parent.PaddingLeft + Parent.PaddingRight)
                            ZIndex: =2

                        conBookingDetails_Buttons As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FillPortions: =0
                            Height: =btnCancel_BookingScreen.Height + Self.PaddingTop + Self.PaddingBottom
                            LayoutGap: =20
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =10
                            PaddingLeft: =2
                            PaddingTop: =10
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.Width - Parent.PaddingLeft
                            ZIndex: =3

                            btnCancel_BookingScreen As button:
                                BorderColor: =ColorValue(varThemeColors.primary)
                                BorderThickness: =1
                                Color: =ColorValue(varThemeColors.primary)
                                DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                                DisabledColor: =ColorValue(varThemeColors.disabledText)
                                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                                Fill: =ColorValue(varThemeColors.backgroundFill)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =Value(varThemeColors.focusBorderThickness)
                                Font: =varThemeFont.CTA.face
                                FontWeight: =varThemeFont.CTA.weight
                                Height: =32
                                HoverBorderColor: =ColorValue(varThemeColors.primary)
                                HoverColor: =ColorValue(varThemeColors.altText)
                                HoverFill: =ColorValue(varThemeColors.tertiary)
                                Italic: =varThemeFont.CTA.italic
                                OnSelect: =Back()
                                PressedBorderColor: =ColorValue(varThemeColors.primary)
                                PressedColor: =ColorValue(varThemeColors.altText)
                                PressedFill: =ColorValue(varThemeColors.primary)
                                RadiusBottomLeft: =6
                                RadiusBottomRight: =6
                                RadiusTopLeft: =6
                                RadiusTopRight: =6
                                Size: =varThemeFont.CTA.size
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Cancel"},
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =100
                                Y: =txtComments_BookingScreen.Y + txtComments_BookingScreen.Height + 50
                                ZIndex: =1

                            btnSubmit_BookingScreen As button:
                                BorderColor: =ColorValue(varThemeColors.primary)
                                BorderThickness: =1
                                Color: =ColorValue(varThemeColors.altText)
                                DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                                DisabledColor: =ColorValue(varThemeColors.disabledText)
                                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                                Fill: =ColorValue(varThemeColors.primary)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =Value(varThemeColors.focusBorderThickness)
                                Font: =varThemeFont.CTA.face
                                FontWeight: =varThemeFont.CTA.weight
                                Height: =32
                                HoverBorderColor: =ColorValue(varThemeColors.primary)
                                HoverColor: =ColorValue(varThemeColors.altText)
                                HoverFill: =ColorValue(varThemeColors.tertiary)
                                Italic: =varThemeFont.CTA.italic
                                OnSelect: |-
                                    =Switch(
                                        varRescheduleBooking,
                                        false,
                                        IfError(
                                            Set(
                                                varNewAppointmentBooking,
                                                Patch(//Creating of New Appointment Booking
                                                    'Appointment Bookings',
                                                    Defaults('Appointment Bookings'),
                                                    {
                                                        'Email Address': varSelRequestor.UserPrincipalName,
                                                        'First Name': varSelRequestor.GivenName,
                                                        'Last Name': varSelRequestor.Surname,
                                                        'Appointment Booking Name': varSelectedSlot.'Appointment Slot Name' & " - " & varSelRequestor.DisplayName,
                                                        'Appointment Slot': varSelectedSlot,
                                                        Comment: txtComments_BookingScreen.Text
                                                    }
                                                )
                                            );,
                                            Notify(// Define a variable named "Text" with the value "{value}"
                                                With(
                                                    {Text: "Error on booking the Slot"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                                    If(
                                            // If the localized text is blank, return the default text
                                                        IsBlank(
                                                            LookUp(
                                                                colUserLocalizedStrings,
                                                                'English Value' = Text
                                                            ).'Localized Value'
                                                        ),
                                                        Text,
                                            // If a localized text is found, return that instead of the default text
                                                        LookUp(
                                                            colUserLocalizedStrings,
                                                            'English Value' = Text
                                                        ).'Localized Value'
                                                    )
                                                )
                                            )
                                        ),
                                        true,
                                        If(
                                            IsError(
                                                Patch(//Reschedule of Old Appointment Booking
                                                    'Appointment Bookings',
                                                    LookUp(
                                                        'Appointment Bookings',
                                                        'Appointment Booking ID' = varSelectedBooking.'Appointment Booking ID'
                                                    ),
                                                    {
                                                        'Appointment Slot': LookUp(//Appointment Slot
                                                            'Appointment Slots',
                                                            'Appointment Slot ID' = varSelectedSlot.'Appointment Slot ID'
                                                        ),
                                                        Comment: txtComments_BookingScreen.Text,
                                                        // Update Comments
                                                        Reason: txtReason_Confirmation.Text,
                                                        //Reason of Rescheduling
                                                        'Appointment Booking Name': varSelectedSlot.'Appointment Slot Name' & " - " & varSelRequestor.DisplayName//Rename of Appointment Bookings
                                                    }
                                                )
                                            ),
                                            Notify(// Define a variable named "Text" with the value "{value}"
                                                With(
                                                    {Text: "Error on booking the Slot"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                                    If(
                                            // If the localized text is blank, return the default text
                                                        IsBlank(
                                                            LookUp(
                                                                colUserLocalizedStrings,
                                                                'English Value' = Text
                                                            ).'Localized Value'
                                                        ),
                                                        Text,
                                            // If a localized text is found, return that instead of the default text
                                                        LookUp(
                                                            colUserLocalizedStrings,
                                                            'English Value' = Text
                                                        ).'Localized Value'
                                                    )
                                                )
                                            )
                                        )
                                    );
                                     
                                    //Updating the Status Reason of Slot to Booked
                                    IfError(
                                        Patch(
                                            'Appointment Slots',
                                            LookUp(
                                                'Appointment Slots',
                                                'Appointment Slot ID' = varSelectedSlot.'Appointment Slot ID'
                                            ),
                                            {
                                                'Status Reason': 'Status Reason (Appointment Slots)'.Booked,
                                                'Appointment Booking': If(
                                                    varRescheduleBooking,
                                                    varSelectedBooking,
                                                    varNewAppointmentBooking
                                                )
                                            }
                                        ),
                                        Notify(// Define a variable named "Text" with the value "{value}"
                                            With(
                                                {Text: "Error on Updating the Status of Slot"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                                If(
                                            // If the localized text is blank, return the default text
                                                    IsBlank(
                                                        LookUp(
                                                            colUserLocalizedStrings,
                                                            'English Value' = Text
                                                        ).'Localized Value'
                                                    ),
                                                    Text,
                                            // If a localized text is found, return that instead of the default text
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                )
                                            )
                                        );
                                    );
                                    //Message if Reschedule or Saving
                                    If(
                                        varRescheduleBooking,
                                        IfError(
                                            Patch(
                                                'Appointment Slots',
                                                LookUp(
                                                    'Appointment Slots',
                                                    'Appointment Slot ID' = varSelectedBooking.'Appointment Slot'.'Appointment Slot ID'
                                                ),
                                                {
                                                    'Status Reason': 'Status Reason (Appointment Slots)'.Available,
                                                    'Appointment Booking': Blank()
                                                }
                                            ),
                                            Notify(// Define a variable named "Text" with the value "{value}"
                                                With(
                                                    {Text: "Error on Updating the Status of Slot"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                                    If(
                                            // If the localized text is blank, return the default text
                                                        IsBlank(
                                                            LookUp(
                                                                colUserLocalizedStrings,
                                                                'English Value' = Text
                                                            ).'Localized Value'
                                                        ),
                                                        Text,
                                            // If a localized text is found, return that instead of the default text
                                                        LookUp(
                                                            colUserLocalizedStrings,
                                                            'English Value' = Text
                                                        ).'Localized Value'
                                                    )
                                                )
                                            );
                                        );
                                        Set(
                                            varInitialContact,
                                            LookUp(
                                                'Appointment Slots',
                                                varSelectedBooking.'Appointment Slot'.'Appointment Slot ID' = 'Appointment Slot ID'
                                            ).'Meeting Provider'.'Primary Email'
                                        );
                                        RescheduledOutlookInvite.Run(
                                            varSelectedBooking.'Appointment Booking ID',
                                            varSelectedBooking.'Appointment Booking Name',
                                            varInitialContact,
                                            If(
                                                varIsAdmin,
                                                "Admin",
                                                "User"
                                            ),
                                            If(
                                                IsBlank(varReschedReason),
                                                "N/A",
                                                varReschedReason
                                            )
                                        );
                                        // Run the Rescheduling of Outlook Events
                                    Set(
                                            varMessage,
                                            "Your appointment has been successfully rescheduled."
                                        );
                                        ,
                                        Set(
                                            varMessage,
                                            "Your appointment has been scheduled."
                                        );
                                    );
                                    Set(
                                        varConfirmExit,
                                        false
                                    );
                                    Navigate('Success Screen');
                                PressedBorderColor: =ColorValue(varThemeColors.primary)
                                PressedColor: =ColorValue(varThemeColors.altText)
                                PressedFill: =ColorValue(varThemeColors.primary)
                                RadiusBottomLeft: =6
                                RadiusBottomRight: =6
                                RadiusTopLeft: =6
                                RadiusTopRight: =6
                                Size: =varThemeFont.CTA.size
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Submit"},
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =100
                                X: =txtComments_BookingScreen.X + btnCancel_BookingScreen.Width + 25
                                Y: =txtComments_BookingScreen.Y + txtComments_BookingScreen.Height + 50
                                ZIndex: =2

    compHeader_BookingScreen As compHeader:
        CurrentPage: =If(varRescheduleBooking, 'Manage Booking Screen', 'New Booking Screen')
        Height: =compHeader_BookingScreen.HeaderHeight
        Width: =App.Width
        ZIndex: =2

