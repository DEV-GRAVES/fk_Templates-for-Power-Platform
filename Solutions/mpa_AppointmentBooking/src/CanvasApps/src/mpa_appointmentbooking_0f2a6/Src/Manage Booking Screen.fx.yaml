"'Manage Booking Screen' As screen":
    Fill: =ColorValue(varThemeColors.background)
    OnVisible: |-
        =Reset(cmbRequestorName_ManageBooking); // Reset data Office365User.
        Set(
            varSelRequestor,
            Blank()
        );
        Set( //reset search to false
            varSearch,
            false
        );
        // Set the 'varSelectedDate' variable to the current date.
        Set(
            varSelectedDate,
            DateValue(Today())
        );
        Reset(cmbShiftStart_Calendar);
        Reset(cmbShiftEnd_Calendar);
        Reset(cmbInterval_Calendar);

    con_ManageBooking As groupContainer.verticalAutoLayoutContainer:
        Fill: =ColorValue(varThemeColors.background)
        Height: =Parent.Height - compHeader_ManageBooking.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =20
        PaddingLeft: =20
        PaddingRight: =20
        PaddingTop: =20
        Width: =Parent.Width - compDetailsLeftNavigation_ManageBooking.Width
        X: =compDetailsLeftNavigation_ManageBooking.Width
        Y: =compHeader_ManageBooking.Height
        ZIndex: =2

        conMain_ManageBooking As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.Center
            Fill: =ColorValue(varThemeColors.backgroundFill)
            FillPortions: =0
            Height: =Parent.Height - Parent.PaddingTop - Parent.PaddingBottom
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            X: =compDetailsLeftNavigation_ManageBooking.Width
            Y: =compHeader_ManageBooking.Height
            ZIndex: =1

            conMain_ManageBooking_Requestor As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.Start
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =conUpper_Label.Height + conUpper_Filter.Height
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                ZIndex: =1

                conUpper_Label As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FillPortions: =0
                    Height: =35
                    LayoutAlignItems: =LayoutAlignItems.End
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    PaddingLeft: =2
                    PaddingTop: =10
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =Parent.Width
                    ZIndex: =2

                    lblRequestorName_ManageBooking As label:
                        AlignInContainer: =AlignInContainer.Start
                        Color: =ColorValue(varThemeColors.text)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Font: =varThemeFont.B2.face
                        FontWeight: =varThemeFont.B2.weightBold
                        Height: =Parent.Height
                        Italic: =varThemeFont.B2.italic
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingTop: =15
                        Size: =varThemeFont.B2.size
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Requestor"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.Width
                        X: =70
                        Y: =25
                        ZIndex: =1

                conUpper_Filter As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Fill: =ColorValue(varThemeColors.backgroundFill)
                    FillPortions: =If('Manage Booking Screen'.Size < 3 , 1 , 0)
                    Height: =45
                    LayoutDirection: =If('Manage Booking Screen'.Size < 3 , LayoutDirection.Vertical , LayoutDirection.Horizontal)
                    LayoutGap: =25
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =2
                    PaddingTop: =10
                    Width: =Parent.Width
                    ZIndex: =3

                    cmbRequestorName_ManageBooking As combobox:
                        AccessibleLabel: |-
                            =With(
                                {Text: "Requestor Name"},
                                If(
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =ColorValue(varThemeColors.primaryGray)
                        BorderThickness: =1
                        ChevronBackground: =ColorValue(varThemeColors.backgroundFill)
                        ChevronDisabledBackground: =ColorValue(varThemeColors.backgroundFillDisabled)
                        ChevronDisabledFill: |
                            =ColorValue(varThemeColors.text)
                        ChevronFill: =ColorValue(varThemeColors.text)
                        ChevronHoverBackground: =ColorValue(varThemeColors.secondaryGray)
                        ChevronHoverFill: |
                            =ColorValue(varThemeColors.text)
                        Color: =ColorValue(varThemeColors.text)
                        DefaultSelectedItems: =
                        DisabledBorderColor: =ColorValue(varThemeColors.primaryGray)
                        DisabledColor: =ColorValue(varThemeColors.disabledText)
                        DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                        DisplayFields: =["DisplayName","Mail"]
                        DisplayMode: =
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                        FocusedBorderThickness: =Value(varThemeColors.focusBorderThickness)
                        Font: =varThemeFont.B1.face
                        FontWeight: =varThemeFont.B1.weight
                        Height: =30
                        HoverBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                        HoverColor: =ColorValue(varThemeColors.text)
                        HoverFill: =ColorValue(varThemeColors.secondaryGray)
                        InputTextPlaceholder: |-
                            =With(
                                {Text: "Select one"},
                                If(
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Italic: =varThemeFont.B1.italic
                        Items: |-
                            =Office365Users.SearchUserV2({isSearchTermRequired: false}).value
                        NoSelectionText: |-
                            =With(
                                {Text: "Select one"},
                                If(
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingLeft: =12
                        PaddingRight: =10
                        PressedBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                        PressedColor: =ColorValue(varThemeColors.altText)
                        PressedFill: =ColorValue(varThemeColors.backgroundFill)
                        SearchFields: =["DisplayName"]
                        SearchItems: |-
                            =Search(Office365Users.SearchUserV2({isSearchTermRequired: false}).value,cmbRequestorName_ManageBooking.SearchText,"DisplayName")
                        SelectionColor: =ColorValue(varThemeColors.text)
                        SelectionFill: =ColorValue(varThemeColors.secondaryGray)
                        SelectionTagColor: =ColorValue(varThemeColors.text)
                        SelectionTagFill: =Color.Transparent
                        SelectMultiple: =false
                        Size: =varThemeFont.B1.size
                        Template: =ListItemTemplate.Double
                        Tooltip: =Self.AccessibleLabel
                        Width: =If('Manage Booking Screen'.Size < 3 , Parent.Width - 2 , 330)
                        X: =
                        Y: =
                        ZIndex: =1

                    btnSubmit_ManageBooking As button:
                        BorderColor: =ColorValue(varThemeColors.primary)
                        BorderThickness: =1
                        Color: =ColorValue(varThemeColors.altText)
                        DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                        DisabledColor: =ColorValue(varThemeColors.disabledText)
                        DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                        DisplayMode: =If(IsBlank(cmbRequestorName_ManageBooking.Selected) , DisplayMode.Disabled , DisplayMode.Edit)
                        Fill: =ColorValue(varThemeColors.primary)
                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                        FocusedBorderThickness: =Value(varThemeColors.focusBorderThickness)
                        Font: =varThemeFont.CTA.face
                        FontWeight: =varThemeFont.CTA.weight
                        Height: =cmbRequestorName_ManageBooking.Height
                        HoverBorderColor: =ColorValue(varThemeColors.primary)
                        HoverColor: =ColorValue(varThemeColors.altText)
                        HoverFill: =ColorValue(varThemeColors.tertiary)
                        Italic: =varThemeFont.CTA.italic
                        OnSelect: |
                            =Set(//Selection of Requestor
                                varSelRequestor,
                                cmbRequestorName_ManageBooking.Selected
                            );
                            Set(
                                varSearch,
                                true
                            );
                            //boolean to show the Galleries
                            //Collect record from empty attendance view
                            //Add start date column
                            ClearCollect(
                                colManageBooking,
                                Filter(
                                    AddColumns(
                                        Filter(
                                            'Appointment Bookings',
                                            'Appointment Bookings (Views)'.'Appointment Booking with Empty Attendance'
                                        ) As Booking,
                                        "StartDate",
                                        LookUp(
                                            'Appointment Slots' As slots,
                                            slots.'Appointment Slot ID' = Booking.'Appointment Slot'.'Appointment Slot ID'
                                        ).'Start Date'
                                    ),
                                    Requestor.Email = varSelRequestor.UserPrincipalName
                                )
                            );
                        PressedBorderColor: =ColorValue(varThemeColors.primary)
                        PressedColor: =ColorValue(varThemeColors.altText)
                        PressedFill: =ColorValue(varThemeColors.primary)
                        RadiusBottomLeft: =6
                        RadiusBottomRight: =6
                        RadiusTopLeft: =6
                        RadiusTopRight: =6
                        Size: =varThemeFont.CTA.size
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Show booked appointments"},
                                If(
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Tooltip: =Self.Text
                        Width: =If('Manage Booking Screen'.Size < 3 , Parent.Width - 2 , 250)
                        X: =9
                        Y: =52
                        ZIndex: =2

            conName_ManageBooking As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =If('Manage Booking Screen'.Size < 3 , lblName_ManageBooking.Height + conEmailAdd_ManageBooking.Height , 27)
                LayoutDirection: =If('Manage Booking Screen'.Size < 3 , LayoutDirection.Vertical , LayoutDirection.Horizontal)
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                ZIndex: =2

                lblName_ManageBooking As label:
                    AutoHeight: =true
                    Color: =ColorValue(varThemeColors.text)
                    FocusedBorderColor: =ColorValue(varThemeColors.info)
                    Font: |-
                        =If(
                           And(
                                varSearch = true,
                                galManageBook_ManageBooking.AllItemsCount > 0
                                
                            ),
                            varThemeFont.H3.face , varThemeFont.H1.face)
                    FontWeight: =varThemeFont.H3.weightNormal
                    Height: =Self.Size *2.5
                    Italic: |-
                        =If(
                           And(
                                varSearch = true,
                                galManageBook_ManageBooking.AllItemsCount > 0
                                
                            ),
                            varThemeFont.H1.italic , varThemeFont.H3.italic)
                    LayoutMinWidth: =100
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingTop: =0
                    Role: =TextRole.Heading1
                    Size: |-
                        =If(
                           And(
                                varSearch = true,
                                galManageBook_ManageBooking.AllItemsCount > 0
                                
                            ),
                            varThemeFont.H3.size , varThemeFont.H3.size)
                    Text: |-
                        =
                        // Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: If(
                                    And(
                                        varSearch = true,
                                        galManageBook_ManageBooking.AllItemsCount > 0
                                    ),
                                    varSelRequestor.DisplayName,
                                    If(
                                        varSearch,
                                        "No appointment booking available",
                                        "Please select a 'Requestor' to manage existing booked appointments"
                                    )
                                )
                            },
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    VerticalAlign: =VerticalAlign.Top
                    Width: =If('Manage Booking Screen'.Size < 3 , Parent.Width , Parent.Width - conEmailAdd_ManageBooking.Width)
                    X: =40
                    Y: =25
                    ZIndex: =2

                conEmailAdd_ManageBooking As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.Start
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =lblEmailAdd_ManageBooking.Height
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =If('Manage Booking Screen'.Size < 3 , Parent.Width , lblEmailAdd_ManageBooking.Width + lblEmail_ManageBooking.Width)
                    ZIndex: =5

                    lblEmailAdd_ManageBooking As label:
                        Color: =ColorValue(varThemeColors.text)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Font: =varThemeFont.B2.face
                        FontWeight: =varThemeFont.B2.weight
                        Height: =Self.Size * 2.5
                        Italic: =varThemeFont.B2.italic
                        PaddingBottom: =10
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =varThemeFont.B2.size
                        Text: =varSelRequestor.UserPrincipalName
                        Visible: =varSearch
                        Width: =Len(Self.Text) * 8
                        X: =63
                        ZIndex: =1

                    lblEmail_ManageBooking As label:
                        AutoHeight: =true
                        Color: =ColorValue(varThemeColors.text)
                        FocusedBorderColor: =ColorValue(varThemeColors.info)
                        Font: =varThemeFont.B2.face
                        FontWeight: =varThemeFont.B2.weightBold
                        Height: =Self.Size * 2.5
                        Italic: =varThemeFont.B2.italic
                        PaddingBottom: =10
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =varThemeFont.B2.size
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Email: "},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Visible: =varSearch
                        Width: =Len(Self.Text) * 8
                        ZIndex: =2

            conGalleries_ManageBooking As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.Center
                Height: =365
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Visible: |-
                    =If(
                        And(
                            varSearch,
                            galManageBook_ManageBooking.AllItemsCount > 0        
                        ),
                        true,
                        false
                    )
                Width: =Parent.Width
                X: =60
                ZIndex: =3

                "galManageBook_ManageBooking As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "List of Booking Appointment"},
                            If(
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    DelayItemLoading: =true
                    FillPortions: =0
                    Height: =Parent.Height
                    Items: |+
                        =Sort(
                            Filter(
                               colManageBooking,
                               StartDate >= Now()
                            ),
                            StartDate,
                            SortOrder.Ascending
                        )
                        
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =287
                    LayoutMinWidth: =320
                    LoadingSpinner: =LoadingSpinner.Data
                    TabIndex: =0
                    TemplatePadding: =20
                    TemplateSize: =If('Manage Booking Screen'.Size < 3 , 270 , 260)
                    WrapCount: =If('Manage Booking Screen'.Size < 3 , 1 , 2)
                    ZIndex: =3

                    conGalleryTemplate_ManageBooking As groupContainer.verticalAutoLayoutContainer:
                        Height: =Parent.TemplateHeight
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.TemplateWidth
                        ZIndex: =1

                        conGalleryDate_ManageBooking As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            Fill: =ColorValue(varThemeColors.background)
                            FillPortions: =0
                            Height: =Parent.Height * .25
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =20
                            PaddingLeft: =20
                            PaddingRight: =20
                            PaddingTop: =20
                            Width: =Parent.Width
                            ZIndex: =1

                            lblGalDay_ManageBooking As label:
                                AutoHeight: =true
                                Color: =ColorValue(varThemeColors.text)
                                DisabledColor: =ColorValue(varThemeColors.text)
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weightSemiBold
                                Height: =Self.Size *2.5
                                HoverColor: =ColorValue(varThemeColors.text)
                                Italic: =varThemeFont.B1.italic
                                OnSelect: =
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                PressedColor: =ColorValue(varThemeColors.text)
                                Size: =varThemeFont.B1.size
                                Text: |-
                                    =Text(
                                        LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                        ).'Start Date',
                                        "dddd"
                                    ) & ", " & Text(
                                        LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                        ).'Start Date',
                                        "mmmm dd, yyyy"
                                    )
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width / 2.2
                                X: =30
                                Y: =15
                                ZIndex: =1

                            lblGalTime_ManageBooking As label:
                                Align: =Align.Right
                                Color: =ColorValue(varThemeColors.text)
                                DisabledColor: =ColorValue(varThemeColors.text)
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weight
                                Height: =Self.Size *2.5
                                HoverColor: =ColorValue(varThemeColors.text)
                                Italic: =varThemeFont.B1.italic
                                OnSelect: =
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                PressedColor: =ColorValue(varThemeColors.text)
                                Size: =varThemeFont.B1.size
                                Text: |-
                                    =Concatenate(
                                        //Convert dates and time if the user selected time zone in the settings screen
                                        Text(
                                            LookUp(
                                                'Appointment Slots',
                                                'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                            ).'Start Date',
                                            "hh:mm AM/PM"
                                        ) & " - " & Text(
                                            LookUp(
                                                'Appointment Slots',
                                                'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                            ).'End Date',
                                            "hh:mm AM/PM"
                                        ),
                                        " (",
                                        If(
                                            Mod(
                                                LookUp(
                                                    'Appointment Slots',
                                                    'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                                ).Duration,
                                                60
                                            ) <> 0,//If Mod 60=0 Mins
                                            If(//If Mins > 60 Hours w/ decimal
                                                LookUp(
                                                    'Appointment Slots',
                                                    'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                                ).Duration > 60,
                                                LookUp(
                                                    'Appointment Slots',
                                                    'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                                ).Duration / 60 & " Hours",
                                                LookUp(
                                                    'Appointment Slots',
                                                    'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                                ).Duration & " Minutes"
                                            ) & "",
                                            Mod(//getting the hours
                                                LookUp(
                                                    'Appointment Slots',
                                                    'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                                ).Duration / 60,
                                                24
                                            ) <> 0,
                                            LookUp(
                                                'Appointment Slots',
                                                'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                            ).Duration / 60 & If(
                                                LookUp(
                                                    'Appointment Slots',
                                                    'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                                ).Duration / 60 = 1,
                                                " Hour",
                                                " Hours"
                                            ),
                                            LookUp(//getting the number of days
                                                'Appointment Slots',
                                                'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                            ).Duration / 60 / 24 & If(
                                                LookUp(//getting the number of days
                                                    'Appointment Slots',
                                                    'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                                ).Duration / 60 / 24 = 1,
                                                " Day",
                                                " Days"
                                            )
                                        ),
                                        ")"
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width / 2.2
                                Wrap: =false
                                X: =Parent.Width - Self.Width - 40
                                Y: =lblGalDay_ManageBooking.Y
                                ZIndex: =2

                        conGalleryLocationType_ManageBooking As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =lblLocationTitle_ManageBooking.Height + conGalleryLocationType_ManageBooking.PaddingTop
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutGap: =10
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingRight: =20
                            PaddingTop: =20
                            Width: =Parent.Width
                            ZIndex: =2

                            conGalleryLocationType As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.Start
                                DropShadow: =DropShadow.None
                                Height: =lblLocationTitle_ManageBooking.Height
                                LayoutGap: =10
                                LayoutMinHeight: =100
                                LayoutMinWidth: =Parent.Width /2.5
                                LayoutMode: =LayoutMode.Auto
                                PaddingLeft: =20
                                ZIndex: =5

                                "icoLocation_ManageBooking As icon.'3DPrinting'":
                                    AccessibleLabel: |-
                                        =// Define a variable named "Text" with the value "{value}"
                                        With(
                                            {Text: "Location Icon"},
                                            // Check if a localized text exists for "Text" in the user's preferred language
                                            If(
                                                // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                                // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        )
                                    BorderColor: =ColorValue(varThemeColors.primary)
                                    Color: =ColorValue(varThemeColors.primary)
                                    DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                                    DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                                    DisabledFill: =RGBA(0,0,0,0)
                                    DisplayMode: =DisplayMode.View
                                    Fill: =RGBA(0,0,0,0)
                                    FocusedBorderColor: =ColorValue(varThemeColors.info)
                                    Height: =15
                                    HoverBorderColor: =ColorValue(varThemeColors.primary)
                                    HoverColor: =ColorValue(varThemeColors.tertiary)
                                    HoverFill: =RGBA(0,0,0,0)
                                    Icon: =Icon.Waypoint
                                    OnSelect: =
                                    PressedBorderColor: =ColorValue(varThemeColors.primary)
                                    PressedColor: =ColorValue(varThemeColors.primary)
                                    PressedFill: =RGBA(0,0,0,0)
                                    Width: =15
                                    X: =lblGalDay_ManageBooking.X
                                    Y: =lblGalDay_ManageBooking.Y + lblGalDay_ManageBooking.Height + 50
                                    ZIndex: =1

                                lblLocationTitle_ManageBooking As label:
                                    Color: =ColorValue(varThemeColors.tertiaryGray)
                                    FillPortions: =1
                                    FocusedBorderColor: =ColorValue(varThemeColors.info)
                                    Font: =varThemeFont.B3.face
                                    FontWeight: =varThemeFont.B3.weightBold
                                    Height: =Self.Size *2.5
                                    Italic: =varThemeFont.B3.italic
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingTop: =0
                                    Role: =TextRole.Heading2
                                    Size: =varThemeFont.B3.size
                                    Text: |-
                                        =// Define a variable named "Text" with the value "{value}"
                                        With(
                                            {Text: "Meeting via"},
                                            // Check if a localized text exists for "Text" in the user's preferred language
                                            If(
                                                // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                                // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        )
                                    Width: =Parent.Width /2.5
                                    X: =icoLocation_ManageBooking.X + icoLocation_ManageBooking.Width + 5
                                    Y: =icoLocation_ManageBooking.Y - 3
                                    ZIndex: =2

                            conGalleryAppointmentType As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.Start
                                DropShadow: =DropShadow.None
                                Height: =lblAppointmentTitle_ManageBooking.Height
                                LayoutGap: =10
                                LayoutMinHeight: =100
                                LayoutMinWidth: =Parent.Width /2.5
                                LayoutMode: =LayoutMode.Auto
                                ZIndex: =6

                                "icoAppointment_ManageBooking As icon.'3DPrinting'":
                                    AccessibleLabel: |-
                                        =// Define a variable named "Text" with the value "{value}"
                                        With(
                                            {Text: "Appointment Icon"},
                                            // Check if a localized text exists for "Text" in the user's preferred language
                                            If(
                                                // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                                // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        )
                                    BorderColor: =ColorValue(varThemeColors.primary)
                                    Color: =ColorValue(varThemeColors.primary)
                                    DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                                    DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                                    DisabledFill: =RGBA(0,0,0,0)
                                    DisplayMode: =DisplayMode.View
                                    Fill: =RGBA(0,0,0,0)
                                    FocusedBorderColor: =ColorValue(varThemeColors.info)
                                    Height: =15
                                    HoverBorderColor: =ColorValue(varThemeColors.primary)
                                    HoverColor: =ColorValue(varThemeColors.tertiary)
                                    HoverFill: =RGBA(0,0,0,0)
                                    Icon: =Icon.DocumentWithContent
                                    OnSelect: =
                                    PressedBorderColor: =ColorValue(varThemeColors.primary)
                                    PressedColor: =ColorValue(varThemeColors.primary)
                                    PressedFill: =RGBA(0,0,0,0)
                                    Width: =15
                                    X: =lblLocationTitle_ManageBooking.X + lblLocationTitle_ManageBooking.Width + 30
                                    Y: =lblLocationTitle_ManageBooking.Y
                                    ZIndex: =1

                                lblAppointmentTitle_ManageBooking As label:
                                    Color: =ColorValue(varThemeColors.tertiaryGray)
                                    FillPortions: =1
                                    FocusedBorderColor: =ColorValue(varThemeColors.info)
                                    Font: =varThemeFont.B3.face
                                    FontWeight: =varThemeFont.B3.weightBold
                                    Height: =Self.Size *2.5
                                    Italic: =varThemeFont.B3.italic
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingTop: =0
                                    Role: =TextRole.Heading2
                                    Size: =varThemeFont.B3.size
                                    Text: |-
                                        =// Define a variable named "Text" with the value "{value}"
                                        With(
                                            {Text: "Appointment Type"},
                                            // Check if a localized text exists for "Text" in the user's preferred language
                                            If(
                                                // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                                // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        )
                                    Width: =Parent.Width /2.5
                                    X: =icoAppointment_ManageBooking.X + icoAppointment_ManageBooking.Width + 5
                                    Y: =icoAppointment_ManageBooking.Y - 2
                                    ZIndex: =2

                        conGalleryLocationTypeDetails_ManageBooking As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =conGalleryLocationType_ManageBooking.Height
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =20
                            PaddingRight: =20
                            Width: =Parent.Width
                            ZIndex: =3

                            lblLocation_ManageBooking As label:
                                AlignInContainer: =AlignInContainer.Center
                                AutoHeight: =true
                                Color: =ColorValue(varThemeColors.text)
                                FillPortions: =1
                                FocusedBorderColor: =ColorValue(varThemeColors.info)
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weightSemiBold
                                Height: =Parent.Height
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =0
                                PaddingLeft: =25
                                PaddingTop: =0
                                Role: =TextRole.Heading2
                                Size: =varThemeFont.B1.size
                                Text: |-
                                    =LookUp(
                                        'Appointment Slots',
                                        'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                    ).Location & If(
                                        Text(
                                            LookUp(
                                                'Appointment Slots',
                                                'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                            ).Location
                                        ) = Text('Appointment Location'.'In Person'),
                                        " " & LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                        ).'Location Details'.'Location Name' & " " & LookUp(
                                            'Appointment Slots',
                                            'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID'
                                        ).'Room Number'.'Room Number'
                                    )
                                Tooltip: =
                                Width: =Parent.Width /2
                                X: =lblLocationTitle_ManageBooking.X
                                Y: =lblLocationTitle_ManageBooking.Y + lblLocationTitle_ManageBooking.Height
                                ZIndex: =1

                            lblAppointment_ManageBooking As label:
                                AutoHeight: =true
                                Color: =ColorValue(varThemeColors.text)
                                FillPortions: =1
                                FocusedBorderColor: =ColorValue(varThemeColors.info)
                                FocusedBorderThickness: =04
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weightSemiBold
                                Height: =Parent.Height
                                Italic: =varThemeFont.B1.italic
                                OnSelect: =
                                PaddingBottom: =0
                                PaddingLeft: =20
                                PaddingTop: =0
                                Role: =TextRole.Heading2
                                Size: =varThemeFont.B1.size
                                Text: =LookUp('Appointment Slots' , 'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID').'Appointment Type'.'Appointment Type Name'
                                Width: =Parent.Width /2
                                X: =lblAppointmentTitle_ManageBooking.X
                                Y: =lblAppointmentTitle_ManageBooking.Y + lblAppointmentTitle_ManageBooking.Height
                                ZIndex: =2

                        conGalleryMeeting_ManageBooking As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =lblContactTitle_ManageBooking.Height + Self.PaddingTop
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutGap: =10
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =20
                            PaddingTop: =20
                            Width: =Parent.Width
                            ZIndex: =4

                            "icoContact_ManageBooking As icon.'3DPrinting'":
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Contact icon"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                BorderColor: =ColorValue(varThemeColors.primary)
                                Color: =ColorValue(varThemeColors.primary)
                                DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                                DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                                DisabledFill: =RGBA(0,0,0,0)
                                DisplayMode: =DisplayMode.View
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =ColorValue(varThemeColors.info)
                                Height: =15
                                HoverBorderColor: =ColorValue(varThemeColors.primary)
                                HoverColor: =ColorValue(varThemeColors.tertiary)
                                HoverFill: =RGBA(0,0,0,0)
                                Icon: =Icon.People
                                OnSelect: =
                                PressedBorderColor: =ColorValue(varThemeColors.primary)
                                PressedColor: =ColorValue(varThemeColors.primary)
                                PressedFill: =RGBA(0,0,0,0)
                                Width: =15
                                X: =icoLocation_ManageBooking.X
                                Y: =lblLocation_ManageBooking.Y + lblLocation_ManageBooking.Height + 10
                                ZIndex: =1

                            lblContactTitle_ManageBooking As label:
                                Color: =ColorValue(varThemeColors.tertiaryGray)
                                FocusedBorderColor: =ColorValue(varThemeColors.info)
                                Font: =varThemeFont.B3.face
                                FontWeight: =varThemeFont.B3.weightBold
                                Height: =Self.Size *2.5
                                Italic: =varThemeFont.B3.italic
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingTop: =0
                                Role: =TextRole.Heading2
                                Size: =varThemeFont.B3.size
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Meeting Provider"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Width: =Parent.Width /2.5
                                X: =icoContact_ManageBooking.X + icoContact_ManageBooking.Width + 5
                                Y: =icoContact_ManageBooking.Y - 5
                                ZIndex: =2

                        conGalleryMeetingDetails_ManageBooking As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =lblContact_ManageBooking.Height
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =45
                            Width: =Parent.Width
                            ZIndex: =5

                            lblContact_ManageBooking As label:
                                AutoHeight: =true
                                Color: =ColorValue(varThemeColors.text)
                                FocusedBorderColor: =ColorValue(varThemeColors.info)
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weightSemiBold
                                Height: =Self.Size *2.5
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =0
                                PaddingLeft: =0
                                Role: =TextRole.Heading2
                                Size: =varThemeFont.B1.size
                                Text: =LookUp('Appointment Slots' , 'Appointment Slot ID' = ThisItem.'Appointment Slot'.'Appointment Slot ID').'Meeting Provider'.'Full Name'
                                Width: =Parent.Width
                                X: =lblContactTitle_ManageBooking.X
                                Y: =lblContactTitle_ManageBooking.Y + lblContactTitle_ManageBooking.Height
                                ZIndex: =1

                        conGalleryButton_ManageBooking As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =Parent.Height * .15
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutJustifyContent: =LayoutJustifyContent.End
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingRight: =30
                            Width: =Parent.Width
                            ZIndex: =6

                            btnManageAppointment_ManageBooking As button:
                                BorderColor: =ColorValue(varThemeColors.primary)
                                BorderThickness: =1
                                Color: =ColorValue(varThemeColors.primary)
                                DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                                DisabledColor: =ColorValue(varThemeColors.disabledText)
                                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                                Fill: =ColorValue(varThemeColors.backgroundFill)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =Value(varThemeColors.focusBorderThickness)
                                Font: =varThemeFont.CTA.face
                                FontWeight: =varThemeFont.CTA.weight
                                Height: =30
                                HoverBorderColor: =ColorValue(varThemeColors.primary)
                                HoverColor: =ColorValue(varThemeColors.altText)
                                HoverFill: =ColorValue(varThemeColors.tertiary)
                                Italic: =varThemeFont.CTA.italic
                                OnSelect: |
                                    =Set(varSelectedBooking , ThisItem);
                                    Navigate('Manage Details Screen');
                                PaddingTop: =0
                                PressedBorderColor: =ColorValue(varThemeColors.primary)
                                PressedColor: =ColorValue(varThemeColors.primary)
                                PressedFill: =Color.Transparent
                                RadiusBottomLeft: =6
                                RadiusBottomRight: =6
                                RadiusTopLeft: =6
                                RadiusTopRight: =6
                                Size: =varThemeFont.CTA.size
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Manage Appointment"},
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Width: =200
                                X: =Parent.Width - Self.Width - 40
                                Y: =lblContact_ManageBooking.Y + 20
                                ZIndex: =1

    compDetailsLeftNavigation_ManageBooking As LeftNavigation:
        Height: =App.Height-Self.Y
        Width: =compDetailsLeftNavigation_ManageBooking.MenuWidth
        Y: =compHeader_ManageBooking.Height
        ZIndex: =3

    compHeader_ManageBooking As compHeader:
        Height: =compHeader_ManageBooking.HeaderHeight
        Width: =App.Width
        ZIndex: =4

