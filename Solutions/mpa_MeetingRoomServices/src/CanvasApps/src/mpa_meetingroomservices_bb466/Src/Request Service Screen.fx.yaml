"'Request Service Screen' As screen":
    OnVisible: |-
        =//Local LyoutProperties
        UpdateContext(
            {
                var_LayoutProperties: {
                    outerPadding: {
                        top: 20,
                        right: 20,
                        bottom: 20,
                        left: 20
                    },
                    gap: {
                        singlePX: 1,
                        extraSmall: 5,
                        small: 10,
                        medium: 20,
                        semiLarge: 30,
                        large: 40
                    },
                    requestServiceGallery: {templateHeight: 140, templateHeightMobile: 220},
                    button: {addToServiceRequestsWidthMedium: 132, addToServiceRequestsWidthLarge: 217}
                }
            }
        );
        
        Reset(txtServiceRequestAdditionalDetails);
        Reset(cmbServiceType);
        Reset(cmbOptionsChoice);
        //Initialize functionality variables
        UpdateContext({var_ServiceToEdit : Blank(), var_IsEditItems : Blank(), var_IsRequiredFilled: Blank()});

    comHeader_Service As compHeader:
        HeaderComponentWidth: =Parent.Width
        Height: =comHeader_Service.HeaderComponentHeight
        Width: =comHeader_Service.HeaderComponentWidth
        ZIndex: =1

    conAddService As groupContainer.horizontalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =Color.Transparent
        Height: =Parent.Height - comHeader_Service.Height  
        LayoutMode: =LayoutMode.Auto
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =Parent.Width
        Y: =comHeader_Service.Height
        ZIndex: =2

        conLeftNavigationRequestService As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: |
                =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Width: =comLeftNavigation_RequestService.Width
            ZIndex: =1

            comLeftNavigation_RequestService As compLeftNavigation:
                Height: =Parent.Height
                LayoutMinWidth: =640

        conServiceScreenMain As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Fill: =ColorValue(varThemeColors.background)
            FillPortions: =0
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            PaddingBottom: =var_LayoutProperties.gap.medium
            PaddingLeft: |-
                =var_LayoutProperties.gap.medium * 
                If(
                    App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                    1,
                    0.5
                )
            PaddingRight: =var_LayoutProperties.gap.medium
            PaddingTop: =var_LayoutProperties.gap.medium
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width - conLeftNavigationRequestService.Width
            Y: =comHeader_Service.Height
            ZIndex: =2

            lblServiceScreenTitle As label:
                AutoHeight: =true
                Color: =ColorValue(varThemeColors.text)
                Font: =varThemeFont.H3.face
                FontWeight: =varThemeFont.H3.weight
                Height: =Self.Size * 1.8
                PaddingBottom: =20
                PaddingLeft: =0
                PaddingTop: =0
                Size: =varThemeFont.H1.size
                Text: ="Request service"
                Tooltip: =Self.Text
                Width: =(Parent.Width - Self.X)- Parent.PaddingRight
                X: =40
                Y: =40
                ZIndex: =1

            conServiceScreenBody As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.Start
                Fill: =ColorValue(varThemeColors.backgroundFill)
                FillPortions: =0
                Height: |-
                    =Max(
                        conServiceScreenHeaderDetails.Height + shpSeparatorMeetingDetails.Height + conAddServiceBody.Height,
                        Parent.Height - Self.Y - Parent.PaddingBottom
                    )
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                ZIndex: =2

                conServiceScreenHeaderDetails As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =ColorValue(varThemeColors.secondaryGray)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: |-
                        =Self.PaddingTop + conMeetingDetails.Height + 
                        If(
                            App.ActiveScreen.Size < ScreenSize.Large, //Mobile
                            Self.LayoutGap + conMeetinDateTime.Height,
                            0
                        ) + Self.PaddingBottom
                    LayoutDirection: |-
                        =If(
                            'Request Service Screen'.Size <= ScreenSize.Medium, //Mobile
                            LayoutDirection.Vertical,
                            LayoutDirection.Horizontal
                        )
                    LayoutGap: =var_LayoutProperties.gap.small
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: |-
                        =var_LayoutProperties.gap.medium * 
                        If(
                            App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                            1,
                            0.5
                        )
                    PaddingLeft: |-
                        =var_LayoutProperties.outerPadding.left * 
                        If(
                            App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                            1,
                            0.5
                        )
                    PaddingRight: |-
                        =var_LayoutProperties.outerPadding.right * 
                        If(
                            App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                            1,
                            0.5
                        )
                    PaddingTop: =var_LayoutProperties.gap.medium
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =Parent.Width
                    ZIndex: =1

                    conMeetinDateTime As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.Start
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =lblMeetingDate.Height + lblMeetingTime.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Max(lblMeetingDate.Width, lblMeetingTime.Width)
                        ZIndex: =1

                        lblMeetingDate As label:
                            AutoHeight: =true
                            Color: =ColorValue(varThemeColors.text)
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weightSemibold
                            Height: =Self.Size * 2
                            PaddingBottom: =var_LayoutProperties.gap.small
                            PaddingLeft: =var_LayoutProperties.gap.extraSmall
                            PaddingRight: =var_LayoutProperties.gap.small
                            PaddingTop: =0
                            Size: =varThemeFont.B1.size
                            Text: |+
                                =Text(var_selectedMeeting.startWithTimeZone, "dd mmm, yyyy")
                                
                            Tooltip: =Self.Text
                            Width: =Self.Size * Len(Self.Text)
                            X: =40
                            Y: =40
                            ZIndex: =1

                        lblMeetingTime As label:
                            AutoHeight: =true
                            Color: =ColorValue(varThemeColors.tertiaryGray)
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weight
                            Height: =Self.Size * 2
                            PaddingBottom: =var_LayoutProperties.gap.small
                            PaddingLeft: =var_LayoutProperties.gap.extraSmall
                            PaddingRight: =var_LayoutProperties.gap.small
                            PaddingTop: =0
                            Size: =varThemeFont.B2.size
                            Text: |-
                                =$"{Text(var_selectedMeeting.startWithTimeZone, "hh:mm AM/PM")} to {Text(var_selectedMeeting.endWithTimeZone, "hh:mm AM/PM")}"
                            Tooltip: =Self.Text
                            Width: =Self.Size * Len(Self.Text)
                            X: =40
                            Y: =40
                            ZIndex: =2

                    conMeetingDetails As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.Start
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =lblMeetingName.Height + lblMeetingLocation.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - If(App.ActiveScreen.Size < ScreenSize.Large, 0, conMeetinDateTime.Width + Parent.LayoutGap) - Parent.PaddingLeft - Parent.PaddingRight
                        ZIndex: =2

                        lblMeetingName As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            AutoHeight: =true
                            Color: =ColorValue(varThemeColors.text)
                            Fill: =Color.Transparent
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weightSemibold
                            Height: =Self.Size * 2
                            PaddingBottom: =var_LayoutProperties.gap.small
                            PaddingLeft: =var_LayoutProperties.gap.extraSmall
                            PaddingRight: =var_LayoutProperties.gap.small
                            PaddingTop: =0
                            Size: =varThemeFont.B1.size
                            Text: =var_selectedMeeting.subject
                            Tooltip: =Self.Text
                            Width: |
                                =
                                Min(conServiceScreenHeaderDetails.Width, Self.Size * Len(Self.Text))- conServiceScreenHeaderDetails.PaddingLeft - conServiceScreenHeaderDetails.PaddingRight
                            X: =40
                            Y: =40
                            ZIndex: =1

                        lblMeetingLocation As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            AutoHeight: =true
                            Color: =ColorValue(varThemeColors.tertiaryGray)
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weight
                            Height: =Self.Size * 2
                            PaddingBottom: =var_LayoutProperties.gap.small
                            PaddingLeft: =var_LayoutProperties.gap.extraSmall
                            PaddingRight: =var_LayoutProperties.gap.small
                            PaddingTop: =0
                            Size: =varThemeFont.B2.size
                            Text: =Coalesce(var_selectedMeeting.location, "---")
                            Tooltip: =Self.Text
                            Width: =Min(conServiceScreenHeaderDetails.Width, Self.Size * Len(Self.Text))- conServiceScreenHeaderDetails.PaddingLeft - conServiceScreenHeaderDetails.PaddingRight
                            X: =40
                            Y: =40
                            ZIndex: =2

                shpSeparatorMeetingDetails As rectangle:
                    AlignInContainer: =AlignInContainer.Start
                    DisplayMode: =DisplayMode.Disabled
                    Fill: =ColorValue(varThemeColors.secondaryGray)
                    Height: =var_LayoutProperties.gap.singlePX
                    Width: =Parent.Width - Parent.PaddingBottom - Parent.PaddingTop
                    ZIndex: =2

                conAddServiceBody As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.Start
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: |-
                        =shpSeparatorBody.Height + 
                        If(
                            App.ActiveScreen.Size < ScreenSize.Large, //Mobile 
                            conAddServiceLeft.Height + conAddServiceRight.Height,
                            0
                        )
                    LayoutDirection: =If(App.ActiveScreen.Size <= ScreenSize.Medium, LayoutDirection.Vertical, LayoutDirection.Horizontal)
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =Parent.Width
                    ZIndex: =3

                    conAddServiceLeft As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.Start
                        BorderColor: =ColorValue(varThemeColors.secondaryGray)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =1
                        DropShadow: =DropShadow.None
                        Fill: =ColorValue(varThemeColors.backgroundFill)
                        FillPortions: =0
                        Height: |-
                            =If(
                                'Request Service Screen'.Size < ScreenSize.Large, //Mobile
                                Self.PaddingTop + 
                                conServiceRequestForm_ServiceRequest.Height + 
                                Self.LayoutGap + 
                                btnAddService.Height + 
                                Self.PaddingBottom,
                                
                                //Desktop
                                shpSeparatorBody.Height
                            )
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: |-
                            =var_LayoutProperties.gap.medium * 
                            If(
                                App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                1,
                                0.5
                            )
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        LayoutOverflowY: =LayoutOverflow.Scroll
                        PaddingBottom: =var_LayoutProperties.outerPadding.bottom
                        PaddingLeft: |-
                            =var_LayoutProperties.outerPadding.left * 
                            If(
                                App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                1,
                                0.5
                            )
                        PaddingRight: |-
                            =var_LayoutProperties.outerPadding.right * 
                            If(
                                App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                1,
                                0.5
                            )
                        PaddingTop: =var_LayoutProperties.outerPadding.top
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: |-
                            =If(
                                App.ActiveScreen.Size < ScreenSize.Large, //Mobile
                                Parent.Width - Parent.PaddingLeft - Parent.PaddingRight,
                                Max(Parent.Width * .24, 225)
                            )
                        ZIndex: =1

                        conServiceRequestForm_ServiceRequest As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: |-
                                =Self.PaddingTop +
                                lblAddService.Height + conServiceType.Height + 
                                conServiceOptions.Height + conAdditionalDetails.Height + (Self.LayoutGap * 3) + 
                                Self.PaddingBottom
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutGap: |-
                                =var_LayoutProperties.gap.medium * 
                                If(
                                    App.ActiveScreen.Size < ScreenSize.Large, //Mobile
                                    0.5,
                                    1
                                )
                            LayoutMinHeight: =
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            ZIndex: =2

                            lblAddService As label:
                                AutoHeight: =true
                                Color: =ColorValue(varThemeColors.text)
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weightSemibold
                                Height: =Self.Size * 2
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: ="Add a service request"
                                Tooltip: =Self.Text
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Wrap: =false
                                X: =40
                                Y: =40
                                ZIndex: =1

                            conServiceType As groupContainer.verticalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                DropShadow: =DropShadow.None
                                FillPortions: =0
                                Height: =lblService.Height + cmbServiceType.Height + Self.LayoutGap + Self.PaddingBottom +Self.PaddingTop
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutGap: =var_LayoutProperties.gap.small
                                LayoutMinHeight: =100
                                LayoutMinWidth: =Parent.Width - Parent.PaddingRight - Parent.PaddingLeft
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =cmbServiceType.FocusedBorderThickness
                                PaddingLeft: =cmbServiceType.FocusedBorderThickness
                                PaddingRight: =cmbServiceType.FocusedBorderThickness
                                PaddingTop: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                ZIndex: =2

                                lblService As label:
                                    AutoHeight: =true
                                    Color: =ColorValue(varThemeColors.text)
                                    Font: =varThemeFont.B2.face
                                    FontWeight: =varThemeFont.B2.weightSemibold
                                    Height: =Self.Size * 2
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Size: =varThemeFont.B2.size
                                    Text: ="Service"
                                    Tooltip: =Self.Text
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    X: =40
                                    Y: =40
                                    ZIndex: =1

                                cmbServiceType As combobox:
                                    AccessibleLabel: ="Service"
                                    BorderColor: |-
                                        =Switch(
                                            var_IsRequiredFilled,
                                            false,
                                            If(
                                                !IsBlank(Self.Selected),
                                                ColorValue(varThemeColors.primaryGray),
                                                ColorValue(varThemeColors.error)
                                            ),
                                            true,
                                            ColorValue(varThemeColors.primaryGray),
                                            ColorValue(varThemeColors.primaryGray)
                                        )
                                    BorderThickness: =1
                                    ChevronBackground: =ColorValue(varThemeColors.backgroundFill)
                                    ChevronDisabledBackground: =ColorValue(varThemeColors.backgroundFillDisabled)
                                    ChevronDisabledFill: |
                                        =ColorValue(varThemeColors.text)
                                    ChevronFill: =ColorValue(varThemeColors.text)
                                    ChevronHoverBackground: =ColorValue(varThemeColors.secondaryGray)
                                    ChevronHoverFill: |
                                        =ColorValue(varThemeColors.text)
                                    Color: =ColorValue(varThemeColors.text)
                                    DefaultSelectedItems: =var_ServiceToEdit.Service
                                    DisabledBorderColor: =ColorValue(varThemeColors.primaryGray)
                                    DisabledColor: =ColorValue(varThemeColors.disabledText)
                                    DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                                    DisplayFields: =["mpa_servicename"]
                                    Fill: =ColorValue(varThemeColors.backgroundFill)
                                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                    Font: =varThemeFont.B1.face
                                    FontWeight: =varThemeFont.B1.weight
                                    Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                    HoverBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                                    HoverColor: =ColorValue(varThemeColors.text)
                                    HoverFill: =ColorValue(varThemeColors.secondaryGray)
                                    InputTextPlaceholder: ="Select a service"
                                    Italic: =varThemeFont.B1.italic
                                    Items: =Services
                                    NoSelectionText: =
                                    OnChange: =Reset(cmbOptionsChoice)
                                    PaddingLeft: =12
                                    PaddingRight: =12
                                    PressedBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                                    PressedColor: =ColorValue(varThemeColors.altText)
                                    PressedFill: =ColorValue(varThemeColors.backgroundFill)
                                    SearchFields: =["mpa_servicename"]
                                    SearchItems: =Search(Services,cmbServiceType.SearchText,mpa_servicename)
                                    SelectionColor: =ColorValue(varThemeColors.text)
                                    SelectionFill: =ColorValue(varThemeColors.secondaryGray)
                                    SelectionTagColor: =ColorValue(varThemeColors.text)
                                    SelectionTagFill: =ColorValue(varThemeColors.backgroundFill)
                                    SelectMultiple: =false
                                    Size: =varThemeFont.B1.size
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    X: =1
                                    Y: =
                                    ZIndex: =2

                            conServiceOptions As groupContainer.verticalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                ContentLanguage: =cmbOptionsChoice.FocusedBorderThickness
                                DropShadow: =DropShadow.None
                                FillPortions: =0
                                Height: =lblOptions.Height + cmbOptionsChoice.Height + Self.LayoutGap + Self.PaddingBottom +Self.PaddingTop
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutGap: =var_LayoutProperties.gap.small
                                LayoutMinHeight: =100
                                LayoutMinWidth: =Parent.Width - Parent.PaddingRight - Parent.PaddingLeft
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =cmbOptionsChoice.FocusedBorderThickness
                                PaddingLeft: =cmbOptionsChoice.FocusedBorderThickness
                                PaddingRight: =cmbOptionsChoice.FocusedBorderThickness
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                ZIndex: =3

                                lblOptions As label:
                                    AutoHeight: =true
                                    Color: =ColorValue(varThemeColors.text)
                                    Font: =varThemeFont.B2.face
                                    FontWeight: =varThemeFont.B2.weightSemibold
                                    Height: =Self.Size * 2.5
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Size: =varThemeFont.B2.size
                                    Text: ="Subservice"
                                    Tooltip: =Self.Text
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    X: =40
                                    Y: =40
                                    ZIndex: =1

                                cmbOptionsChoice As combobox:
                                    AccessibleLabel: ="Options"
                                    BorderColor: |-
                                        =Switch(
                                            var_IsRequiredFilled,
                                            false,
                                            If(
                                                !IsBlank(Self.Selected),
                                                ColorValue(varThemeColors.primaryGray),
                                                ColorValue(varThemeColors.error)
                                            ),
                                            true,
                                            ColorValue(varThemeColors.primaryGray),
                                            ColorValue(varThemeColors.primaryGray)
                                        )
                                    BorderThickness: =1
                                    ChevronBackground: =ColorValue(varThemeColors.backgroundFill)
                                    ChevronDisabledBackground: =ColorValue(varThemeColors.backgroundFillDisabled)
                                    ChevronDisabledFill: |
                                        =ColorValue(varThemeColors.text)
                                    ChevronFill: =ColorValue(varThemeColors.text)
                                    ChevronHoverBackground: =ColorValue(varThemeColors.secondaryGray)
                                    ChevronHoverFill: |
                                        =ColorValue(varThemeColors.text)
                                    Color: =ColorValue(varThemeColors.text)
                                    DefaultSelectedItems: =var_ServiceToEdit.SubServices
                                    DisabledBorderColor: =ColorValue(varThemeColors.primaryGray)
                                    DisabledColor: =ColorValue(varThemeColors.disabledText)
                                    DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                                    DisplayFields: =["mpa_subservicename"]
                                    DisplayMode: |-
                                        =//Disabled until a service is selected
                                        If(
                                            IsBlank(cmbServiceType.Selected) Or CountRows(cmbServiceType.SelectedItems) = 0,
                                            DisplayMode.Disabled,
                                            DisplayMode.Edit
                                        )
                                    Fill: =ColorValue(varThemeColors.backgroundFill)
                                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                    Font: =varThemeFont.B1.face
                                    FontWeight: =varThemeFont.B1.weight
                                    Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                    HoverBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                                    HoverColor: =ColorValue(varThemeColors.text)
                                    HoverFill: =ColorValue(varThemeColors.secondaryGray)
                                    InputTextPlaceholder: ="Select option"
                                    Italic: =varThemeFont.B1.italic
                                    Items: |-
                                        =//Show Related sub services from the chosen service
                                        Filter(SubServices,'Service Id'.'Service ID'=cmbServiceType.Selected.'Service ID')
                                    NoSelectionText: =
                                    OnChange: =
                                    PaddingLeft: =12
                                    PaddingRight: =10
                                    PressedBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                                    PressedColor: =ColorValue(varThemeColors.altText)
                                    PressedFill: =ColorValue(varThemeColors.backgroundFill)
                                    SearchFields: =["mpa_subservicename"]
                                    SearchItems: |-
                                        =Search(//Show Related sub services from the chosen service
                                        Filter(SubServices,'Service Id'.'Service ID'=cmbServiceType.Selected.'Service ID'),cmbOptionsChoice.SearchText,mpa_subservicename)
                                    SelectionColor: =ColorValue(varThemeColors.text)
                                    SelectionFill: =ColorValue(varThemeColors.secondaryGray)
                                    SelectionTagColor: =ColorValue(varThemeColors.text)
                                    SelectionTagFill: =ColorValue(varThemeColors.backgroundFill)
                                    SelectMultiple: =false
                                    Size: =varThemeFont.B1.size
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    X: =1
                                    Y: =
                                    ZIndex: =2

                            conAdditionalDetails As groupContainer.verticalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                DropShadow: =DropShadow.None
                                FillPortions: =0
                                Height: =lblAdditionalDetails_RequestService.Height + txtServiceRequestAdditionalDetails.Height + Self.LayoutGap + Self.PaddingBottom +Self.PaddingTop
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutGap: =var_LayoutProperties.gap.small
                                LayoutMinHeight: =lblAdditionalDetails_RequestService.Height + txtServiceRequestAdditionalDetails.Height + Self.LayoutGap + Self.PaddingBottom +Self.PaddingTop
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =txtServiceRequestAdditionalDetails.FocusedBorderThickness
                                PaddingLeft: =txtServiceRequestAdditionalDetails.FocusedBorderThickness
                                PaddingRight: =txtServiceRequestAdditionalDetails.FocusedBorderThickness
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                ZIndex: =4

                                lblAdditionalDetails_RequestService As label:
                                    AutoHeight: =true
                                    Color: =ColorValue(varThemeColors.text)
                                    Font: =varThemeFont.B2.face
                                    FontWeight: =varThemeFont.B2.weightSemibold
                                    Height: =Self.Size * 2.5
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Size: =varThemeFont.B2.size
                                    Text: ="Additional details" & " *"
                                    Tooltip: =Self.Text
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    X: =40
                                    Y: =40
                                    ZIndex: =1

                                txtServiceRequestAdditionalDetails As text:
                                    AccessibleLabel: ="Additional Detail"
                                    AlignInContainer: =AlignInContainer.Start
                                    BorderColor: |-
                                        =Switch(
                                            var_IsRequiredFilled,
                                            false,
                                            If(
                                                !IsBlank(Self.Text),
                                                ColorValue(varThemeColors.primaryGray),
                                                ColorValue(varThemeColors.error)
                                            ),
                                            true,
                                            ColorValue(varThemeColors.primaryGray),
                                            ColorValue(varThemeColors.primaryGray)
                                        )
                                    BorderThickness: =1
                                    Color: =ColorValue(varThemeColors.text)
                                    Default: |+
                                        =var_ServiceToEdit.Details
                                        
                                    DisabledBorderColor: =ColorValue(varThemeColors.primaryGray)
                                    DisabledColor: =ColorValue(varThemeColors.disabledText)
                                    DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                                    Fill: =ColorValue(varThemeColors.backgroundFill)
                                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                    Font: =varThemeFont.B1.face
                                    FontWeight: =varThemeFont.B1.weight
                                    Height: |-
                                        =(
                                            (Self.Size * 1.8) *  5
                                        ) + Self.PaddingTop + Self.PaddingBottom
                                    HintText: ="Enter additional details"
                                    HoverBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                                    HoverColor: =ColorValue(varThemeColors.text)
                                    HoverFill: =ColorValue(varThemeColors.backgroundFill)
                                    Italic: =varThemeFont.B1.italic
                                    MaxLength: =DataSourceInfo('Service Requests', DataSourceInfo.MaxLength, mpa_requestnote)
                                    Mode: =TextMode.MultiLine
                                    PressedBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                                    PressedColor: =ColorValue(varThemeColors.text)
                                    PressedFill: =ColorValue(varThemeColors.backgroundFill)
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Size: =varThemeFont.B1.size
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    X: =
                                    Y: =
                                    ZIndex: =2

                        btnAddService As button:
                            BorderColor: =ColorValue(varThemeColors.primary)
                            BorderThickness: =1
                            Color: =ColorValue(varThemeColors.primary)
                            DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                            DisabledColor: =ColorValue(varThemeColors.disabledText)
                            DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                            DisplayMode: |-
                                =//Check if required fields are supplied
                                If(
                                    Or(
                                        IsBlank(cmbServiceType.Selected), 
                                        CountRows(cmbServiceType.SelectedItems) = 0,
                                        IsBlank(cmbOptionsChoice.Selected), 
                                        CountRows(cmbOptionsChoice.SelectedItems) = 0,
                                        IsBlank(TrimEnds(txtServiceRequestAdditionalDetails.Text))
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =varThemeColors.focusBorderThickness
                            Font: =varThemeFont.CTA.face
                            FontWeight: =varThemeFont.CTA.weight
                            Height: =RoundUp(Self.Size * 1.8 + Self.PaddingTop + Self.PaddingBottom, 0)
                            HoverBorderColor: =ColorValue(varThemeColors.primary)
                            HoverColor: =ColorValue(varThemeColors.altText)
                            HoverFill: =ColorValue(varThemeColors.tertiary)
                            Italic: =varThemeFont.CTA.italic
                            OnSelect: |-
                                =//Check required items
                                IfError(
                                    With(
                                        {
                                            wIsreqFilled: If(
                                                Or(IsBlank(cmbServiceType.Selected), IsBlank(cmbOptionsChoice.Selected),  IsBlank(txtServiceRequestAdditionalDetails.Text)),
                                                false,
                                                true
                                            )
                                        },
                                        UpdateContext({var_IsRequiredFilled: wIsreqFilled});
                                        If(
                                            var_IsRequiredFilled <> true,
                                            Notify(
                                             "The service details are incomplete. Please check the highlighted fields.",
                                                NotificationType.Error
                                            ),
                                            If(
                                    //Check if Item edit
                                                var_IsEditItems <> true,
                                    //If false add Service request
                                                Collect(
                                                    colRoomServices,
                                                    {
                                                        Service: cmbServiceType.Selected,
                                                        SubServices: cmbOptionsChoice.Selected,
                                                        Details: txtServiceRequestAdditionalDetails.Text,
                                                        'Row id': CountRows(colRoomServices) + 1
                                                    }
                                                ),
                                    //If true add edit Service request
                                                Update(
                                                    colRoomServices,
                                                    LookUp(
                                                        colRoomServices,
                                                        'Row id' = var_ServiceToEdit.'Row id'
                                                    ),
                                                    {
                                                        Service: LookUp(
                                                            Services,
                                                            'Service ID' = cmbServiceType.Selected.'Service ID'
                                                        ),
                                                        SubServices: LookUp(
                                                            SubServices,
                                                            'SubService ID' = cmbOptionsChoice.Selected.'SubService ID'
                                                        ),
                                                        Details: txtServiceRequestAdditionalDetails.Text
                                                    }
                                                )
                                            )
                                        )
                                    ),
                                    Notify(
                                      "Error in adding or updating your service request",
                                        NotificationType.Error
                                    ),
                                //Reset the context var_IsEditItems to blank
                                    If(
                                        var_IsRequiredFilled,
                                        Concurrent(
                                            UpdateContext(
                                                {
                                                    var_IsEditItems: Blank(),
                                                    var_ServiceToEdit: Blank()
                                                }
                                            ),
                                            Reset(cmbOptionsChoice),
                                            Reset(cmbServiceType),
                                            Reset(txtServiceRequestAdditionalDetails)
                                        )
                                    )
                                )
                            PressedBorderColor: =ColorValue(varThemeColors.primary)
                            PressedColor: =ColorValue(varThemeColors.altText)
                            PressedFill: =ColorValue(varThemeColors.primary)
                            RadiusBottomLeft: =6
                            RadiusBottomRight: =6
                            RadiusTopLeft: =6
                            RadiusTopRight: =6
                            Size: |-
                                =
                                
                                If(App.ActiveScreen.Size < 3, varThemeFont.B2.size,
                                varThemeFont.CTA.size)
                            Text: |-
                                =//Responsive condition
                                If(
                                    'Request Service Screen'.Size = ScreenSize.Medium,
                                       If(galServiceRequest.AllItemsCount > 0, "Add to service requests" , "Add service" )
                                    ,
                                   If(var_IsEditItems, "Update Service", "Add to service requests" )
                                )
                            Tooltip: =Self.Text
                            Width: |-
                                =//Responsive condition
                                If(
                                    'Request Service Screen'.Size = ScreenSize.Medium,
                                    If(galServiceRequest.AllItemsCount > 0, var_LayoutProperties.button.addToServiceRequestsWidthLarge, var_LayoutProperties.button.addToServiceRequestsWidthMedium),
                                    Parent.Width - Parent.PaddingRight - Parent.PaddingLeft
                                )
                            ZIndex: =6

                    shpSeparatorBody As rectangle:
                        AlignInContainer: =AlignInContainer.Start
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =ColorValue(varThemeColors.secondaryGray)
                        Height: |-
                            =//Responsive condition
                            If(
                                'Request Service Screen'.Size < ScreenSize.Large, //Mobile
                                1,
                                conAddServiceRight.Height
                            )
                        Width: |-
                            =If(
                                App.ActiveScreen.Size < ScreenSize.Large,
                                Parent.Width,
                                1
                               
                            )
                        ZIndex: =2

                    conAddServiceRight As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =ColorValue(varThemeColors.secondaryGray)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =1
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: |-
                            =Self.PaddingTop + 
                                conServiceRequests.Height + shpSeparatorRightUpper.Height + 
                                conServiceRequestGallery.Height + 
                                shpSeparatorButtonUpper.Height + 
                                conButtons_ServiceRequest.Height + 
                                Self.PaddingBottom
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: |
                            =//Reposive condition
                            If(
                                'Request Service Screen'.Size <= ScreenSize.Medium,
                                Parent.Width,
                                Parent.Width - If(App.ActiveScreen.Size < ScreenSize.Large, 0 ,  conAddServiceLeft.Width + shpSeparatorBody.Width)-Parent.PaddingLeft - Parent.PaddingRight
                            )
                        ZIndex: =3

                        conServiceRequests As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =ColorValue(varThemeColors.secondaryGray)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            DropShadow: =DropShadow.None
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FillPortions: =0
                            Height: |-
                                =Self.PaddingTop + 
                                lblServiceReq.Height + 
                                If(
                                    Self.LayoutDirection = LayoutDirection.Vertical,
                                    lblServiceRequestCount.Height, 0
                                ) +
                                Self.PaddingBottom
                            LayoutDirection: |-
                                =If(
                                    'Request Service Screen'.Size <= ScreenSize.Medium, //Mobile
                                    LayoutDirection.Vertical,
                                    LayoutDirection.Horizontal
                                )
                            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =var_LayoutProperties.outerPadding.bottom
                            PaddingLeft: |-
                                =var_LayoutProperties.outerPadding.left * 
                                If(
                                    App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                    1,
                                    0.5
                                )
                            PaddingRight: |-
                                =var_LayoutProperties.outerPadding.right * 
                                If(
                                    App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                    1,
                                    0.5
                                )
                            PaddingTop: =var_LayoutProperties.outerPadding.top
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.Width
                            ZIndex: =1

                            lblServiceReq As label:
                                AutoHeight: =true
                                Color: =ColorValue(varThemeColors.text)
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weightSemibold
                                Height: =Self.Size * 1.8
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: ="Service requests"
                                Tooltip: =Self.Text
                                Width: =Self.Size * Len(Self.Text)
                                X: =40
                                Y: =40
                                ZIndex: =1

                            lblServiceRequestCount As label:
                                Align: |-
                                    =//Change text direction if Desktop/Mobile view
                                    If(
                                        Parent.LayoutDirection = LayoutDirection.Horizontal,
                                        Align.Right,
                                        Align.Left
                                    )
                                AutoHeight: =true
                                Color: =ColorValue(varThemeColors.tertiaryGray)
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weight
                                Height: =Self.Size * 1.8
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B2.size
                                Text: |-
                                    ="Showing "
                                    
                                    & CountRows(colRoomServices) &
                                    
                                    " service requests"
                                Tooltip: =Self.Text
                                Width: =(Self.Size * 0.7) * Len(Self.Text)
                                X: =40
                                Y: =40
                                ZIndex: =2

                        shpSeparatorRightUpper As rectangle:
                            AlignInContainer: =AlignInContainer.Stretch
                            DisplayMode: =DisplayMode.Disabled
                            Fill: =ColorValue(varThemeColors.secondaryGray)
                            Height: =var_LayoutProperties.gap.singlePX
                            Width: =Parent.Width - Parent.PaddingBottom - Parent.PaddingTop
                            ZIndex: =2

                        conServiceRequestGallery As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: |-
                                =//Responsive condition
                                If(
                                    App.ActiveScreen.Size < ScreenSize.Large, //Mobile
                                    galServiceRequest.Height,
                                    
                                    //Desktop
                                    conServiceScreenMain.Height - conServiceScreenMain.PaddingTop - conServiceScreenMain.LayoutGap - lblServiceScreenTitle.Height - conServiceScreenHeaderDetails.Height - shpSeparatorMeetingDetails.Height - conServiceRequests.Height - shpSeparatorRightUpper.Height - shpSeparatorButtonUpper.Height - conButtons_ServiceRequest.Height - conServiceScreenMain.PaddingBottom
                                )
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =galServiceRequest.Width /2
                            LayoutMode: =LayoutMode.Auto
                            LayoutOverflowY: =LayoutOverflow.Scroll
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.Width
                            ZIndex: =3

                            galServiceRequest As gallery.galleryVertical:
                                '#CopilotOverlayLabel': ="Filtered"
                                AccessibleLabel: ="Service Request"
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =Parent.Fill
                                DelayItemLoading: =true
                                FillPortions: =0
                                FocusedBorderThickness: =1
                                Height: =Max(Self.AllItemsCount, 1) * Self.TemplateHeight
                                Items: =colRoomServices
                                Layout: =Layout.Vertical
                                LayoutMinHeight: =Self.TemplateHeight
                                LayoutMinWidth: =320
                                LoadingSpinner: =LoadingSpinner.Data
                                TabIndex: =0
                                TemplateFill: =If(var_ServiceToEdit.'Row id' = ThisItem.'Row id' And !IsBlank(var_ServiceToEdit) , ColorValue(varThemeColors.secondary), Color.Transparent)
                                TemplatePadding: =0
                                TemplateSize: |-
                                    =//Responsive condition
                                    If(
                                        App.ActiveScreen.Size < ScreenSize.Large, //Mobile
                                        var_LayoutProperties.requestServiceGallery.templateHeightMobile,
                                        var_LayoutProperties.requestServiceGallery.templateHeight
                                    )
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                ZIndex: =1

                                conMainTemplate As groupContainer.verticalAutoLayoutContainer:
                                    DropShadow: =DropShadow.None
                                    Height: =Parent.TemplateHeight
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutMode: =LayoutMode.Auto
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Width: =Parent.Width
                                    ZIndex: =2

                                    conItemTemplate As groupContainer.verticalAutoLayoutContainer:
                                        AlignInContainer: =AlignInContainer.SetByContainer
                                        BorderColor: =ColorValue(varThemeColors.secondaryGray)
                                        BorderStyle: =BorderStyle.None
                                        BorderThickness: =1
                                        DropShadow: =DropShadow.None
                                        FillPortions: =0
                                        Height: =Parent.Height - shpSeparatorGalleryData.Height
                                        LayoutDirection: |-
                                            =If(
                                                'Request Service Screen'.Size <= ScreenSize.Medium, //Mobile
                                                LayoutDirection.Vertical,
                                                LayoutDirection.Horizontal
                                            )
                                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                        LayoutMinHeight: =100
                                        LayoutMinWidth: =250
                                        LayoutMode: =LayoutMode.Auto
                                        PaddingBottom: =var_LayoutProperties.outerPadding.bottom
                                        PaddingTop: =var_LayoutProperties.outerPadding.top
                                        RadiusBottomLeft: =0
                                        RadiusBottomRight: =0
                                        RadiusTopLeft: =0
                                        RadiusTopRight: =0
                                        Width: =Parent.Width
                                        ZIndex: =1

                                        conServiceRequestDetails_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            DropShadow: =DropShadow.None
                                            FillPortions: =0
                                            Height: |-
                                                =Self.PaddingTop + 
                                                conServiceSubService_ServiceRequest.Height + Self.LayoutGap +
                                                conAdditionalDetails_ServiceRequest.Height +
                                                Self.PaddingBottom
                                            LayoutDirection: =LayoutDirection.Vertical
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            RadiusBottomLeft: =0
                                            RadiusBottomRight: =0
                                            RadiusTopLeft: =0
                                            RadiusTopRight: =0
                                            Width: |-
                                                =If(
                                                    Parent.LayoutDirection = LayoutDirection.Horizontal, 
                                                    Parent.Width - conActions_ServiceRequest.Width, Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                                )
                                            ZIndex: =1

                                            conServiceSubService_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                DropShadow: =DropShadow.None
                                                FillPortions: =0
                                                Height: |-
                                                    =//Responsive condition
                                                    Self.PaddingTop + 
                                                    conService_ServiceRequest.Height +
                                                    If(
                                                        'Request Service Screen'.Size <= ScreenSize.Medium, //Mobile
                                                        conSubservice_ServiceRequest.Height    
                                                    ) + 
                                                    Self.PaddingBottom
                                                LayoutDirection: |-
                                                    =If(
                                                        'Request Service Screen'.Size <= ScreenSize.Medium, //Mobile
                                                        LayoutDirection.Vertical,
                                                        LayoutDirection.Horizontal
                                                    )
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                RadiusBottomLeft: =0
                                                RadiusBottomRight: =0
                                                RadiusTopLeft: =0
                                                RadiusTopRight: =0
                                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                                ZIndex: =1

                                                conService_ServiceRequest As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    DropShadow: =DropShadow.None
                                                    FillPortions: =0
                                                    Height: =Self.PaddingTop + lblServiceLabel_ServiceRequest.Height + Self.LayoutGap + lblServiceValue_ServiceRequest.Height + Self.PaddingBottom
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: |-
                                                        =var_LayoutProperties.outerPadding.left * 
                                                        If(
                                                            App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                                            1,
                                                            0.5
                                                        )
                                                    PaddingRight: |-
                                                        =var_LayoutProperties.outerPadding.right * 
                                                        If(
                                                            App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                                            1,
                                                            0.5
                                                        )
                                                    RadiusBottomLeft: =0
                                                    RadiusBottomRight: =0
                                                    RadiusTopLeft: =0
                                                    RadiusTopRight: =0
                                                    Width: |-
                                                        =If(
                                                            Parent.LayoutDirection = LayoutDirection.Horizontal,
                                                            Parent.Width * 0.5, 
                                                            Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                                        )
                                                    ZIndex: =1

                                                    lblServiceLabel_ServiceRequest As label:
                                                        Color: =ColorValue(varThemeColors.tertiaryGray)
                                                        DisplayMode: =DisplayMode.View
                                                        Font: =varThemeFont.B2.face
                                                        FontWeight: =varThemeFont.B3.weight
                                                        Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                                        PaddingBottom: =var_LayoutProperties.gap.extraSmall
                                                        PaddingLeft: =0
                                                        PaddingRight: =0
                                                        PaddingTop: =0
                                                        Size: =varThemeFont.B3.size
                                                        Text: ="Service"
                                                        Tooltip: =Self.Text
                                                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                                        Wrap: =false
                                                        X: =40
                                                        Y: =40
                                                        ZIndex: =1

                                                    lblServiceValue_ServiceRequest As label:
                                                        Color: =ColorValue(varThemeColors.text)
                                                        DisplayMode: =DisplayMode.View
                                                        Font: =varThemeFont.B2.face
                                                        FontWeight: =varThemeFont.B2.weightSemibold
                                                        Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                                        PaddingBottom: =var_LayoutProperties.gap.small
                                                        PaddingLeft: =0
                                                        PaddingRight: =0
                                                        PaddingTop: =0
                                                        Size: =varThemeFont.B2.size
                                                        Text: =ThisItem.Service.'Service Name'
                                                        Tooltip: =Self.Text
                                                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                                        Wrap: =false
                                                        X: =40
                                                        Y: =40
                                                        ZIndex: =2

                                                conSubservice_ServiceRequest As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    DropShadow: =DropShadow.None
                                                    FillPortions: =0
                                                    Height: =Self.PaddingTop + lblSubservice_ServiceRequest.Height + Self.LayoutGap + lblSubserviceLabel_ServiceRequest.Height + Self.PaddingBottom
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: |-
                                                        =var_LayoutProperties.outerPadding.left * 
                                                        If(
                                                            App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                                            1,
                                                            0.5
                                                        )
                                                    PaddingRight: |-
                                                        =var_LayoutProperties.outerPadding.right * 
                                                        If(
                                                            App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                                            1,
                                                            0.5
                                                        )
                                                    RadiusBottomLeft: =0
                                                    RadiusBottomRight: =0
                                                    RadiusTopLeft: =0
                                                    RadiusTopRight: =0
                                                    Width: |-
                                                        =If(
                                                            Parent.LayoutDirection = LayoutDirection.Horizontal,
                                                            Parent.Width * 0.5, 
                                                            Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                                        )
                                                    X: |-
                                                        =If(
                                                            'Request Service Screen'.Size <= ScreenSize.Medium,
                                                            conService_ServiceRequest.X,
                                                            conService_ServiceRequest.X + conService_ServiceRequest.Width
                                                        )
                                                    Y: |
                                                        =//Responsive condition
                                                        If(
                                                            'Request Service Screen'.Size <= ScreenSize.Medium,
                                                            conService_ServiceRequest.Y + conService_ServiceRequest.Height,
                                                            0
                                                        )
                                                    ZIndex: =2

                                                    lblSubserviceLabel_ServiceRequest As label:
                                                        Color: =ColorValue(varThemeColors.tertiaryGray)
                                                        DisplayMode: =DisplayMode.View
                                                        Font: =varThemeFont.B2.face
                                                        FontWeight: =varThemeFont.B3.weight
                                                        Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                                        PaddingBottom: =var_LayoutProperties.gap.extraSmall
                                                        PaddingLeft: =0
                                                        PaddingRight: =0
                                                        PaddingTop: =0
                                                        Size: =varThemeFont.B3.size
                                                        Text: ="Subservice"
                                                        Tooltip: =Self.Text
                                                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                                        Wrap: =false
                                                        X: =40
                                                        Y: =40
                                                        ZIndex: =4

                                                    lblSubservice_ServiceRequest As label:
                                                        Color: =ColorValue(varThemeColors.text)
                                                        DisplayMode: =DisplayMode.View
                                                        Font: =varThemeFont.B2.face
                                                        FontWeight: =varThemeFont.B2.weightSemibold
                                                        Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                                        PaddingBottom: =var_LayoutProperties.gap.small
                                                        PaddingLeft: =0
                                                        PaddingRight: =0
                                                        PaddingTop: =0
                                                        Size: =varThemeFont.B2.size
                                                        Text: |+
                                                            =ThisItem.SubServices.'Subservice Name'
                                                            
                                                        Tooltip: =Self.Text
                                                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                                        Wrap: =false
                                                        X: =40
                                                        Y: =40
                                                        ZIndex: =5

                                            conAdditionalDetails_ServiceRequest As groupContainer.verticalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                DropShadow: =DropShadow.None
                                                FillPortions: =0
                                                Height: =Self.PaddingTop + lblAdditionalDetailsLabel_ServiceRequest.Height + Self.LayoutGap + lblAdditionalDetails_ServiceRequest.Height + Self.PaddingBottom
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutJustifyContent: =LayoutJustifyContent.Center
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingLeft: |-
                                                    =var_LayoutProperties.outerPadding.left * 
                                                    If(
                                                        App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                                        1,
                                                        0.5
                                                    )
                                                PaddingRight: |-
                                                    =var_LayoutProperties.outerPadding.right * 
                                                    If(
                                                        App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                                        1,
                                                        0.5
                                                    )
                                                RadiusBottomLeft: =0
                                                RadiusBottomRight: =0
                                                RadiusTopLeft: =0
                                                RadiusTopRight: =0
                                                Width: |-
                                                    =Parent
                                                    .Width -
                                                    Parent
                                                    .PaddingLeft -
                                                    Parent
                                                    .PaddingRight
                                                ZIndex: =2

                                                lblAdditionalDetailsLabel_ServiceRequest As label:
                                                    Color: =ColorValue(varThemeColors.tertiaryGray)
                                                    DisplayMode: =DisplayMode.View
                                                    Font: =varThemeFont.B2.face
                                                    FontWeight: =varThemeFont.B3.weight
                                                    Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                                    PaddingBottom: =var_LayoutProperties.gap.extraSmall
                                                    PaddingLeft: =0
                                                    PaddingRight: =0
                                                    PaddingTop: =0
                                                    Size: =varThemeFont.B3.size
                                                    Text: ="Additional Details" 
                                                    Tooltip: =Self.Text
                                                    Width: =Self.Size * Len(Self.Text)
                                                    Wrap: =false
                                                    X: =40
                                                    Y: =40
                                                    ZIndex: =1

                                                lblAdditionalDetails_ServiceRequest As label:
                                                    Color: =ColorValue(varThemeColors.text)
                                                    DisplayMode: =DisplayMode.View
                                                    Font: =varThemeFont.B2.face
                                                    FontWeight: =varThemeFont.B2.weightSemibold
                                                    Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                                    PaddingBottom: =var_LayoutProperties.gap.small
                                                    PaddingLeft: =0
                                                    PaddingRight: =0
                                                    PaddingTop: =0
                                                    Size: =varThemeFont.B2.size
                                                    Text: =Coalesce(ThisItem.Details, "---")
                                                    Tooltip: =Self.Text
                                                    Width: |+
                                                        =Self.Size * Len(Self.Text)
                                                        
                                                    Wrap: =false
                                                    X: =40
                                                    Y: =40
                                                    ZIndex: =2

                                        conActions_ServiceRequest As groupContainer.verticalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            DropShadow: =DropShadow.None
                                            FillPortions: =0
                                            Height: =Self.PaddingTop + conEdit.Height + Self.PaddingBottom
                                            LayoutGap: =var_LayoutProperties.gap.small
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            PaddingBottom: =conEdit.BorderThickness
                                            PaddingLeft: |-
                                                =var_LayoutProperties.outerPadding.left * 
                                                If(
                                                    App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                                    1,
                                                    0.5
                                                )
                                            PaddingRight: |-
                                                =var_LayoutProperties.outerPadding.right * 
                                                If(
                                                    App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                                    1,
                                                    0.5
                                                )
                                            PaddingTop: =conEdit.BorderThickness
                                            RadiusBottomLeft: =0
                                            RadiusBottomRight: =0
                                            RadiusTopLeft: =0
                                            RadiusTopRight: =0
                                            Width: =conEdit.Width + conCancel.Width + Self.LayoutGap + Self.PaddingLeft + Self.PaddingRight
                                            X: =Parent.Width - Self.Width
                                            ZIndex: =4

                                            conEdit As groupContainer.verticalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =ColorValue(varThemeColors.error)
                                                BorderThickness: =1
                                                DropShadow: =DropShadow.None
                                                FillPortions: =0
                                                Height: =32
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =6
                                                PaddingLeft: =6
                                                PaddingRight: =6
                                                PaddingTop: =6
                                                RadiusBottomLeft: =6
                                                RadiusBottomRight: =6
                                                RadiusTopLeft: =6
                                                RadiusTopRight: =6
                                                Width: =32
                                                ZIndex: =7

                                                icoEdit As icon.Cancel:
                                                    AccessibleLabel: ="Cancel"
                                                    BorderColor: =ColorValue(varThemeColors.error)
                                                    Color: =ColorValue(varThemeColors.error)
                                                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                                    Height: =Self.Width
                                                    Icon: =Icon.Cancel
                                                    OnSelect: =Remove(colRoomServices, ThisItem)
                                                    TabIndex: =0
                                                    Width: =20
                                                    ZIndex: =1

                                            conCancel As groupContainer.verticalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =ColorValue(varThemeColors.primary)
                                                BorderThickness: =1
                                                DropShadow: =DropShadow.None
                                                FillPortions: =0
                                                Height: =32
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =6
                                                PaddingLeft: =6
                                                PaddingRight: =6
                                                PaddingTop: =6
                                                RadiusBottomLeft: =6
                                                RadiusBottomRight: =6
                                                RadiusTopLeft: =6
                                                RadiusTopRight: =6
                                                Width: =32
                                                ZIndex: =8

                                                icoCancel As icon.Cancel:
                                                    AccessibleLabel: ="Edit" 
                                                    BorderColor: =ColorValue(varThemeColors.error)
                                                    Color: =ColorValue(varThemeColors.primary)
                                                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                                    Height: =Self.Width
                                                    Icon: =Icon.Edit
                                                    OnSelect: |-
                                                        =UpdateContext({var_IsEditItems: true});
                                                        UpdateContext({var_ServiceToEdit: ThisItem});
                                                        
                                                        SetFocus(txtServiceRequestAdditionalDetails)
                                                    TabIndex: =0
                                                    Width: =20
                                                    ZIndex: =1

                                    shpSeparatorGalleryData As rectangle:
                                        DisplayMode: =DisplayMode.View
                                        Fill: =ColorValue(varThemeColors.secondaryGray)
                                        Height: =var_LayoutProperties.gap.singlePX
                                        Width: =Parent.Width - Parent.PaddingBottom - Parent.PaddingTop
                                        ZIndex: =2

                        shpSeparatorButtonUpper As rectangle:
                            AlignInContainer: =AlignInContainer.Start
                            DisplayMode: =DisplayMode.Disabled
                            Fill: =ColorValue(varThemeColors.secondaryGray)
                            Height: =var_LayoutProperties.gap.singlePX
                            Width: =Parent.Width - Parent.PaddingBottom - Parent.PaddingTop
                            ZIndex: =4

                        conButtons_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =ColorValue(varThemeColors.secondaryGray)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =1
                            DropShadow: =DropShadow.None
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FillPortions: =0
                            Height: |-
                                =Self.PaddingTop + 
                                btnCancel_Service.Height + 
                                If(
                                    App.ActiveScreen.Size < ScreenSize.Large, //Mobile
                                    btnSubmitService.Height,
                                    0
                                ) + Self.PaddingBottom
                            LayoutDirection: |
                                =
                                //Responsive condition
                                If(
                                    'Request Service Screen'.Size = ScreenSize.Small,
                                    LayoutDirection.Vertical,
                                    LayoutDirection.Horizontal
                                )
                            LayoutGap: =var_LayoutProperties.gap.small
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =var_LayoutProperties.outerPadding.bottom
                            PaddingLeft: |-
                                =var_LayoutProperties.outerPadding.left * 
                                If(
                                    App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                    1,
                                    0.5
                                )
                            PaddingRight: |-
                                =var_LayoutProperties.outerPadding.right * 
                                If(
                                    App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
                                    1,
                                    0.5
                                )
                            PaddingTop: =var_LayoutProperties.outerPadding.top
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.Width
                            ZIndex: =5

                            btnCancel_Service As button:
                                BorderColor: =ColorValue(varThemeColors.primary)
                                BorderThickness: =1
                                Color: =ColorValue(varThemeColors.primary)
                                DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                                DisabledColor: =ColorValue(varThemeColors.disabledText)
                                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                                Fill: =ColorValue(varThemeColors.backgroundFill)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                Font: =varThemeFont.CTA.face
                                FontWeight: =varThemeFont.CTA.weight
                                Height: =RoundUp(Self.Size * 1.8 + Self.PaddingTop + Self.PaddingBottom, 0)
                                HoverBorderColor: =ColorValue(varThemeColors.tertiary)
                                HoverColor: =ColorValue(varThemeColors.altText)
                                HoverFill: =ColorValue(varThemeColors.tertiary)
                                Italic: =varThemeFont.CTA.italic
                                OnSelect: =Back()
                                PressedBorderColor: =ColorValue(varThemeColors.primary)
                                PressedColor: =ColorValue(varThemeColors.altText)
                                PressedFill: =ColorValue(varThemeColors.primary)
                                RadiusBottomLeft: =6
                                RadiusBottomRight: =6
                                RadiusTopLeft: =6
                                RadiusTopRight: =6
                                Size: |-
                                    =
                                    If(App.ActiveScreen.Size < 3, varThemeFont.B2.size,
                                    varThemeFont.CTA.size)
                                Text: ="Cancel"
                                Width: |-
                                    =//Responsive condition
                                    If(
                                        App.ActiveScreen.Size = ScreenSize.Small,
                                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight,
                                        Self.Size * Len(Self.Text) + Self.PaddingLeft + Self.PaddingRight
                                    )
                                X: =1
                                ZIndex: =1

                            btnSubmitService As button:
                                BorderColor: =ColorValue(varThemeColors.primary)
                                BorderThickness: =1
                                Color: =ColorValue(varThemeColors.altText)
                                DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                                DisabledColor: =ColorValue(varThemeColors.disabledText)
                                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                                DisplayMode: |-
                                    =If(
                                        CountRows(colRoomServices) > 0,
                                        DisplayMode.Edit,
                                        DisplayMode.Disabled
                                    )
                                Fill: =ColorValue(varThemeColors.primary)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                Font: =varThemeFont.CTA.face
                                FontWeight: =varThemeFont.CTA.weight
                                Height: =RoundUp(Self.Size * 1.8 + Self.PaddingTop + Self.PaddingBottom, 0)
                                HoverBorderColor: =ColorValue(varThemeColors.primary)
                                HoverColor: =ColorValue(varThemeColors.altText)
                                HoverFill: =ColorValue(varThemeColors.tertiary)
                                Italic: =varThemeFont.CTA.italic
                                OnSelect: |
                                    =//Final patching
                                    //Do patching process if collection has value
                                    If(
                                        CountRows(colRoomServices) = 0,
                                        Notify(
                                           "No service requested for this meeting, no action taken",
                                            NotificationType.Error
                                        ),
                                    /*Do patching on meetings table
                                    1. Check if there is an existing record on table using outlook meeting ID
                                    2. Skip if there is any
                                    3. Patch if there is none*/
                                        With(
                                            {
                                                wMeetingRoom: If(
                                                    CountRows(
                                                        Filter(
                                                            'Meeting Rooms',
                                                            'Room Name' = var_selectedMeeting.location
                                                        )
                                                    ) = 0,
                                                    Patch(
                                                        'Meeting Rooms',
                                                        Defaults('Meeting Rooms'),
                                                        {'Room Name': var_selectedMeeting.location}
                                                    ),
                                                    LookUp(
                                                        'Meeting Rooms',
                                                        'Room Name' = var_selectedMeeting.location
                                                    )
                                                )
                                            },
                                            UpdateContext({var_meetingRoom : wMeetingRoom});
                                            With(
                                                {
                                                    wMeeting: If(
                                                        CountRows(
                                                            Filter(
                                                                Meetings,
                                                                'Outlook Meeting Id' = var_selectedMeeting.iCalUId
                                                            )
                                                        ) > 0,
                                                        LookUp(
                                                            Meetings,
                                                            'Outlook Meeting Id' = var_selectedMeeting.iCalUId
                                                        ),
                                                        Patch(
                                                            Meetings,
                                                            Defaults(Meetings),
                                                            {
                                                                'Meeting Name': var_selectedMeeting.subject,
                                                                Location: var_selectedMeeting.location,
                                                                'Start Date': var_selectedMeeting.startWithTimeZone,
                                                                'End Date': var_selectedMeeting.endWithTimeZone,
                                                                Organizer: LookUp(
                                                                    Users,
                                                                    'Primary Email' = var_selectedMeeting.organizer
                                                                ),
                                                                Subject: var_selectedMeeting.subject,
                                                                'Meeting Room': LookUp(
                                                                    'Meeting Rooms',
                                                                    'Meeting Room ID' = var_meetingRoom.'Meeting Room ID'
                                                                ),
                                                                'Outlook Meeting Id': var_selectedMeeting.iCalUId
                                                            }
                                                        )
                                                    )
                                                },
                                            /*Error Handling: Notify if patch Failed*/
                                                If(
                                                    IsBlank(wMeeting),
                                                    //Error encountered
                                                    Notify(
                                                      "Service Request Creation Failed"
                                                        & " - " 
                                                        & Concat(Errors('Survey Ratings'), Column&": "&Message, "; "),
                                                        NotificationType.Error
                                                    )
                                                    ,
                                                /*Store in a context variable to avoid delegation*/
                                                    UpdateContext({var_meeting: wMeeting});
                                                )
                                            );
                                        //Patch Service Request
                                    /*patch service request*/
                                    ForAll(
                                                colRoomServices As roomServices,
                                                With(
                                                    {
                                                        wRequestService: Patch(
                                                            'Service Requests',
                                                            Defaults('Service Requests'),
                                                            {
                                                                Meeting: LookUp(
                                                                    Meetings,
                                                                    'Meeting ID' = var_meeting.'Meeting ID'
                                                                ),
                                                                'Request Note': roomServices.Details,
                                                                Service: roomServices.Service,
                                                                SubService: roomServices.SubServices,
                                                                'Outlook Meeting ID': var_selectedMeeting.iCalUId
                                                            }
                                                        )
                                                    },
                                                /*Error Handling: Notify if patch Failed*/
                                                    If(
                                                        IsBlank(wRequestService),
                                                    //Error encountered
                                                    Notify(
                                                       "Service Request Creation Failed"
                                                        & " - " 
                                                        & Concat(Errors('Survey Ratings'), Column&": "&Message, "; "),
                                                        NotificationType.Error
                                                    )
                                                        
                                                        ,
                                                        Notify(
                                                           "Service request added successfully",
                                                            NotificationType.Success
                                                        );
                                                        Navigate('Landing Screen')
                                                    )
                                                )
                                            )
                                        )
                                    );
                                PressedBorderColor: =ColorValue(varThemeColors.primary)
                                PressedColor: =ColorValue(varThemeColors.altText)
                                PressedFill: =ColorValue(varThemeColors.primary)
                                RadiusBottomLeft: =6
                                RadiusBottomRight: =6
                                RadiusTopLeft: =6
                                RadiusTopRight: =6
                                Size: |-
                                    =
                                    
                                    If(App.ActiveScreen.Size < 3, varThemeFont.B2.size,
                                    varThemeFont.CTA.size)
                                Text: ="Submit"
                                Tooltip: =Self.Text
                                Width: |-
                                    =//Responsive condition
                                    If(
                                        App.ActiveScreen.Size = ScreenSize.Small,
                                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight,
                                        Self.Size * Len(Self.Text) + Self.PaddingLeft + Self.PaddingRight
                                    )
                                ZIndex: =2

