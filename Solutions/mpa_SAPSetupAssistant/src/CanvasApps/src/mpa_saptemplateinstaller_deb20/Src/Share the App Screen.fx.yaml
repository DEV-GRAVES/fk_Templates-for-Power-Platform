"'Share the App Screen' As screen":
    LoadingSpinner: =LoadingSpinner.Data
    OnVisible: |-
        =Set(
            varCurrentActivityStepOrder,
            1
        );
        Set(
            varAppActiveScreen,
            App.ActiveScreen
        );
        Reset(RadioGroupCanvas1_7);
        Reset(RadioGroupCanvas1_10);
        Reset(RadioGroupCanvas1_11);
        Reset(RadioGroupCanvas1_12);
        Reset(RadioGroupCanvas1_13);
        Reset(RadioGroupCanvas1_14);
        
        Reset(ComboboxCanvas1_2);
        Reset(ComboboxCanvas1_3);
        Reset(ComboboxCanvas1_5);
        Reset(ComboboxCanvas1_6);
        Reset(ComboboxCanvas1_11);
        Reset(ComboboxCanvas1_12);
        Reset(ComboboxCanvas1_13);
        Reset(ComboboxCanvas1_14);
        Reset(ComboboxCanvas1_15);
        Reset(ComboboxCanvas1_16);
        Reset(ComboboxCanvas1_17);
        Reset(ComboboxCanvas1_18);
        
        Reset(CheckboxCanvas5_1);
        Reset(CheckboxCanvas5_13);
        Reset(CheckboxCanvas5_15);
        Reset(CheckboxCanvas5_19);
        Reset(CheckboxCanvas5_20);
        Reset(CheckboxCanvas5_21);
        Reset(CheckboxCanvas5_2)

    Container6_6 As groupContainer.horizontalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Height: =Parent.Height
        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
        LayoutMode: =LayoutMode.Auto
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =Parent.Width
        ZIndex: =4

        cmpLeftNav_10 As LeftNavigation:
            Height: =Parent.Height-2
            LayoutMinWidth: =640
            SetExpandMenu: =App.ActiveScreen.Size <= ScreenSize.Medium
            Width: =cmpLeftNav_10.MenuWidth

        conScreenMain_10 As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.Semibold
            Fill: =Color.White
            Height: =Parent.Height
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =10
            LayoutMinHeight: =App.MinScreenHeight
            LayoutMinWidth: =320 - 3*Self.PaddingLeft
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =20
            PaddingLeft: |-
                =Switch(
                    App.ActiveScreen.Size,
                    ScreenSize.ExtraLarge,
                    100,
                    ScreenSize.Large,
                    50,
                    ScreenSize.Medium,
                    25,
                    ScreenSize.Small,
                    12.5
                )
            PaddingRight: =Self.PaddingLeft
            PaddingTop: =20
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Visible: |-
                =If(
                    And(
                        App.ActiveScreen.Size = ScreenSize.Small,
                        Or(
                            varExpandHelp,
                            varExpandMenu
                        )
                    ),
                    false,
                    true
                )
            Width: =cmpHelpAssistant_10.X-Self.X
            X: =cmpLeftNav_10.Width
            ZIndex: =2

            Header_7 As Header:
                LayoutMinHeight: =640
                LayoutMinWidth: =0

            ProgressBar_5 As ProgressBar:
                LayoutMinHeight: =640
                LayoutMinWidth: =0
                ZIndex: =2

            Container1_29 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =10
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                Visible: =CurrentActivityStep.'Step Name' = "Overview App Sharing"
                ZIndex: =3

                HtmlText2_17 As htmlViewer:
                    AutoHeight: =true
                    DisabledBorderColor: =RGBA(56, 56, 56, 1)
                    Font: =Font.'Segoe UI'
                    HtmlText: =CurrentActivityStep.Summary
                    ZIndex: =3

            Container1_31 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =20
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =2
                PaddingRight: =2
                Visible: =CurrentActivityStep.'Step Name' = "Share Vendor Management"
                ZIndex: =4

                Container21 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =175
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    Container20 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =50
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =0
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =5
                        ZIndex: =1

                        HtmlText2_19 As htmlViewer:
                            AutoHeight: =true
                            DisabledBorderColor: =RGBA(56, 56, 56, 1)
                            FillPortions: =1
                            Font: =Font.'Segoe UI'
                            HtmlText: =CurrentActivityStep.Summary
                            ZIndex: =1

                        Image7 As image:
                            AccessibleLabel: ="Vendor management icon"
                            BorderThickness: =
                            Height: =40
                            Image: ='Vendors Icon-Dark'
                            Width: =40
                            ZIndex: =2

                    RadioGroupCanvas1_7 As Radio.pcfdataset:
                        AccessibleLabel: ="Choose to share with security group or users"
                        BasePaletteColor: =
                        DefaultSelectedItems: |-
                            =With(
                                {
                                    _activityStep: LookUp (
                                        'Activity Step Values',
                                        'Control Name' = "RadioGroupCanvas1_7"
                                    )
                                },
                                First(
                                    Filter(
                                        Table(
                                            {
                                                Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                                Value: 1
                                            },
                                            {
                                                Option: "Users - Share the app with specific users that you select",
                                                Value: 2
                                            },
                                            {
                                                Option: "Not planning to deploy this app",
                                                Value: 3
                                            }
                                        ),
                                        If(
                                            IsBlank(_activityStep),
                                            Value = 1,
                                            Value = Value(_activityStep.Value)
                                        )
                                    ).Option
                                )
                            )
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontSize: =0
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =120
                        Items: |-
                            =Table(
                                {
                                    Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                    Value: 1
                                },
                                {
                                    Option: "Users - Share the app with specific users that you select",
                                    Value: 2
                                },
                                {
                                    Option: "Not planning to deploy this app",
                                    Value: 3
                                }
                            )
                        Layout: ="Vertical"
                        LayoutMinHeight: =96
                        LayoutMinWidth: =320
                        OnChange: =
                        RadioSize: =16
                        Width: =Parent.Width
                        X: =0
                        Y: =
                        ZIndex: =2

                        Option1_5 As PowerApps_CoreControls_RadioGroupCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="Option"
                            FieldName: ="Option"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =5

                TextCanvas1_19 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Security groups"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_7.Selected.Value=1
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =4

                TextCanvas1_20 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Users"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_7.Selected.Value=2
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =5

                Container12_8 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingRight: =10
                    Visible: =RadioGroupCanvas1_7.Selected.Value<>3
                    ZIndex: =6

                    ComboboxCanvas1_2 As Combobox.pcfdataset:
                        AccessibleLabel: ="Existing security groups"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select security groups"
                        Items: |-
                            =Sort(
                                Filter(
                                    Office365Groups.ListGroups().value,
                                    securityEnabled = true
                                ),
                                displayName
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_7.Selected.Value=1
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =1

                        displayName1_1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="displayName"
                            FieldName: ="displayName"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =20

                    ComboboxCanvas1_3 As Combobox.pcfdataset:
                        AccessibleLabel: ="Select users"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select users"
                        Items: |-
                            =Sort(
                                Filter(
                                    Users,
                                    'Users (Views)'.'Enabled Users'
                                ),
                                'Full Name'
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_7.Selected.Value=2
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =2

                        "'Full Name1_2' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Full Name"
                            FieldName: ="fullname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =21

                        "'User Name1_1' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="User Name"
                            FieldName: ="domainname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            ZIndex: =22

                    Container5_7 As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =35
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =10
                        LayoutMinHeight: =0
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =5
                        PaddingLeft: =2
                        PaddingRight: =5
                        PaddingTop: =5
                        Width: =400
                        ZIndex: =3

                        ButtonCanvas2_2 As Button:
                            AccessibleLabel: ="Share vendor management app"
                            Align: =""
                            BasePaletteColor: =
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: |-
                                =If(
                                    Or(
                                        And(
                                            IsBlank(ComboboxCanvas1_2.Selected),
                                            RadioGroupCanvas1_7.Selected.Value = 1
                                        ),
                                        And(
                                            IsBlank(ComboboxCanvas1_3.Selected),
                                            RadioGroupCanvas1_7.Selected.Value = 2
                                        ),
                                        varDisableControls
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Font: =""
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            Icon: =""
                            IconRotation: =0
                            IconStyle: ="Outline"
                            Layout: ="Icon before"
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            OnSelect: |
                                =Set(
                                    varDisableControls,
                                    true
                                );
                                Notify(
                                    "Sharing the vendor management app and updating its menu item which can take several minutes. Please do not navigate away from this screen.",
                                    NotificationType.Information,
                                    0
                                );
                                UpdateContext(
                                    {
                                        _shareAppsResonse: InstallTemplateShareApps.Run(
                                            SAPVendorManagementApp.name,
                                            BAPAPIVersion,
                                            JSON(
                                                SAPUserSecurityRoles,
                                                JSONFormat.IndentFour
                                            ),
                                            If(
                                                RadioGroupCanvas1_7.Selected.Value = 1,
                                                JSON(
                                                    AddColumns(
                                                        ComboboxCanvas1_2.SelectedItems,
                                                        Id,
                                                        id,
                                                        Type,
                                                        "Team",
                                                        DisplayName,
                                                        displayName,
                                                        Role,
                                                        "CanView"
                                                    ),
                                                    JSONFormat.IndentFour
                                                ),
                                                JSON(
                                                    ShowColumns(
                                                        AddColumns(
                                                            ComboboxCanvas1_3.SelectedItems,
                                                            Id,
                                                            'Azure AD Object ID',
                                                            Type,
                                                            "User",
                                                            DisplayName,
                                                            'Full Name',
                                                            Role,
                                                            "CanView"
                                                        ),
                                                        Id,
                                                        Type,
                                                        DisplayName,
                                                        Role
                                                    ),
                                                    JSONFormat.IndentFour
                                                )
                                            ),
                                            "[]"
                                        )
                                    }
                                );
                                If(
                                    _shareAppsResonse.status = "Success",
                                    Set(
                                        varMenuIconControl,
                                        JSON(
                                            Image7.Image,
                                            JSONFormat.IncludeBinaryData
                                        )
                                    );
                                    Set(
                                        varIconBinaryOnly,
                                        Mid(
                                            varMenuIconControl,
                                            Find(
                                                ",",
                                                varMenuIconControl
                                            ) + 1,
                                            Len(varMenuIconControl) - Find(
                                                ",",
                                                varMenuIconControl
                                            ) - 1
                                        )
                                    );
                                    UpdateContext(
                                        {
                                            _menuItemResponse: InstallTemplateSAPMenuItem.Run(
                                                "Vendor Management",
                                                If(
                                                    RadioGroupCanvas1_7.Selected.Value = 1,
                                                    JSON(
                                                        AddColumns(
                                                            ComboboxCanvas1_2.SelectedItems,
                                                            Id,
                                                            id,
                                                            Type,
                                                            "Team"
                                                        ),
                                                        JSONFormat.IndentFour
                                                    ),
                                                    JSON(
                                                        ShowColumns(
                                                            AddColumns(
                                                                ComboboxCanvas1_3.SelectedItems,
                                                                Id,
                                                                'Azure AD Object ID',
                                                                Type,
                                                                "User"
                                                            ),
                                                            Id,
                                                            Type
                                                        ),
                                                        JSONFormat.IndentFour
                                                    )
                                                ),
                                                varIconBinaryOnly,
                                                SAPVendorManagementApp.properties.appOpenUri
                                            )
                                        }
                                    );
                                    If(
                                        _menuItemResponse.status = "Success",
                                        Notify(
                                            "The vendor management app was successfully shared along with its menu item.",
                                            NotificationType.Success,
                                            5000
                                        );
                                        With(
                                            {_controlName: "CheckboxCanvas5_1"},
                                            Patch(
                                                'Activity Step Values',
                                                Coalesce(
                                                    LookUp(
                                                        'Activity Step Values',
                                                        'Control Name' = _controlName
                                                    ),
                                                    Defaults('Activity Step Values')
                                                ),
                                                {
                                                    'Control Name': _controlName,
                                                    'Data Type': 'Data Type (Activity Step Values)'.Boolean,
                                                    'Activity Step': CurrentActivityStep,
                                                    Value: "true"
                                                }
                                            )
                                        );
                                        Reset(CheckboxCanvas5_1);
                                        Reset(ComboboxCanvas1_2);
                                        Reset(ComboboxCanvas1_3),
                                        Notify(
                                            _menuItemResponse.message,
                                            NotificationType.Error,
                                            0
                                        )
                                    ),
                                    Notify(
                                        _shareAppsResonse.statusmessage,
                                        NotificationType.Error,
                                        0
                                    )
                                );
                                Set(
                                    varDisableControls,
                                    false
                                );
                            Text: ="Share vendor management app"
                            VerticalAlign: =""
                            Visible: =RadioGroupCanvas1_7.Selected.Value<>3
                            Width: =250
                            X: =0
                            Y: =0
                            ZIndex: =1

                        Spinner2_8 As Spinner:
                            AccessibleLabel: ="Processing"
                            BasePaletteColor: =
                            DisplayMode: =DisplayMode.Edit
                            FontColor: =
                            Height: =Container5_7.Height-5
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            SpinnerColor: =
                            SpinnerSize: ='Spinner.SpinnerSize'.ExtraSmall
                            TrackColor: =
                            Visible: =And(varDisableControls,ButtonCanvas2_2.Visible)
                            Width: =Self.Height
                            X: =0
                            Y: =0
                            ZIndex: =2

                CheckboxCanvas5_1 As Checkbox:
                    AccessibleLabel: ="Vendor management app has been successfully shared"
                    BasePaletteColor: =
                    CheckboxSize: =16
                    Checked: |-
                        =With(
                            {
                                _stepValue: LookUp(
                                    'Activity Step Values',
                                    'Control Name' = "CheckboxCanvas5_1"
                                ).Value
                            },
                            If(_stepValue = "true",true,false)
                        )
                    DisplayMode: |-
                        =If(
                            varDisableControls,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    FontWeight: =""
                    Height: =40
                    Label: ="Vendor management app has been successfully shared"
                    LayoutMinHeight: =32
                    LayoutMinWidth: =160
                    OnCheck: =false
                    OnUncheck: =false
                    Visible: =RadioGroupCanvas1_7.Selected.Value <> 3
                    Width: =160
                    X: =40
                    Y: =40
                    ZIndex: =7

            Container1_74 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =20
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =2
                PaddingRight: =2
                Visible: =CurrentActivityStep.'Step Name' = "Share Purchase Requisitions"
                ZIndex: =5

                Container21_1 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =175
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    Container20_1 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =50
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =0
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =5
                        ZIndex: =1

                        HtmlText2_61 As htmlViewer:
                            AutoHeight: =true
                            DisabledBorderColor: =RGBA(56, 56, 56, 1)
                            FillPortions: =1
                            Font: =Font.'Segoe UI'
                            HtmlText: =CurrentActivityStep.Summary
                            ZIndex: =1

                        Image7_1 As image:
                            AccessibleLabel: ="Purchase requisitions icon"
                            BorderThickness: =
                            Height: =40
                            Image: ='Requisitions Icon-Dark'
                            Width: =40
                            ZIndex: =2

                    RadioGroupCanvas1_10 As Radio.pcfdataset:
                        AccessibleLabel: ="Choose to share with security group or users"
                        BasePaletteColor: =
                        DefaultSelectedItems: |-
                            =With(
                                {
                                    _activityStep: LookUp (
                                        'Activity Step Values',
                                        'Control Name' = "RadioGroupCanvas1_10"
                                    )
                                },
                                First(
                                    Filter(
                                        Table(
                                            {
                                                Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                                Value: 1
                                            },
                                            {
                                                Option: "Users - Share the app with specific users that you select",
                                                Value: 2
                                            },
                                            {
                                                Option: "Not planning to deploy this app",
                                                Value: 3
                                            }
                                        ),
                                        If(
                                            IsBlank(_activityStep),
                                            Value = 1,
                                            Value = Value(_activityStep.Value)
                                        )
                                    ).Option
                                )
                            )
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontSize: =0
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =120
                        Items: |-
                            =Table(
                                {
                                    Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                    Value: 1
                                },
                                {
                                    Option: "Users - Share the app with specific users that you select",
                                    Value: 2
                                },
                                {
                                    Option: "Not planning to deploy this app",
                                    Value: 3
                                }
                            )
                        Layout: ="Vertical"
                        LayoutMinHeight: =96
                        LayoutMinWidth: =320
                        OnChange: =
                        RadioSize: =16
                        Width: =Parent.Width
                        X: =0
                        Y: =
                        ZIndex: =2

                        Option1_10 As PowerApps_CoreControls_RadioGroupCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="Option"
                            FieldName: ="Option"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =5

                TextCanvas1_22 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Security groups"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_10.Selected.Value=1
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =4

                TextCanvas1_21 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Users"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_10.Selected.Value=2
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =5

                Container12_9 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingRight: =10
                    Visible: =RadioGroupCanvas1_10.Selected.Value<>3
                    ZIndex: =6

                    ComboboxCanvas1_5 As Combobox.pcfdataset:
                        AccessibleLabel: ="Existing security groups"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select security groups"
                        Items: |-
                            =Sort(
                                Filter(
                                    Office365Groups.ListGroups().value,
                                    securityEnabled = true
                                ),
                                displayName
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_10.Selected.Value=1
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =1

                        displayName1_3 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="displayName"
                            FieldName: ="displayName"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =20

                    ComboboxCanvas1_6 As Combobox.pcfdataset:
                        AccessibleLabel: ="Select users"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select users"
                        Items: |-
                            =Sort(
                                Filter(
                                    Users,
                                    'Users (Views)'.'Enabled Users'
                                ),
                                'Full Name'
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_10.Selected.Value=2
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =2

                        "'Full Name1_3' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Full Name"
                            FieldName: ="fullname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =21

                        "'User Name1_3' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="User Name"
                            FieldName: ="domainname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            ZIndex: =22

                    Container5_10 As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =35
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =10
                        LayoutMinHeight: =0
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =5
                        PaddingLeft: =2
                        PaddingRight: =5
                        PaddingTop: =5
                        Width: =400
                        ZIndex: =3

                        ButtonCanvas2_3 As Button:
                            AccessibleLabel: ="Share purchase requisitions app"
                            Align: =""
                            BasePaletteColor: =
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: |-
                                =If(
                                    Or(
                                        And(
                                            IsBlank(ComboboxCanvas1_5.Selected),
                                            RadioGroupCanvas1_10.Selected.Value = 1
                                        ),
                                        And(
                                            IsBlank(ComboboxCanvas1_6.Selected),
                                            RadioGroupCanvas1_10.Selected.Value = 2
                                        ),
                                        varDisableControls
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Font: =""
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            Icon: =""
                            IconRotation: =0
                            IconStyle: ="Outline"
                            Layout: ="Icon before"
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            OnSelect: |
                                =Set(
                                    varDisableControls,
                                    true
                                );
                                Notify(
                                    "Sharing the purchase requisitions app and updating its menu item which can take several minutes. Please do not navigate away from this screen.",
                                    NotificationType.Information,
                                    0
                                );
                                UpdateContext(
                                    {
                                        _shareAppsResonse: InstallTemplateShareApps.Run(
                                            SAPPurchaseRequisitionsApp.name,
                                            BAPAPIVersion,
                                            JSON(
                                                SAPUserSecurityRoles,
                                                JSONFormat.IndentFour
                                            ),
                                            If(
                                                RadioGroupCanvas1_10.Selected.Value = 1,
                                                JSON(
                                                    AddColumns(
                                                        ComboboxCanvas1_5.SelectedItems,
                                                        Id,
                                                        id,
                                                        Type,
                                                        "Team",
                                                        DisplayName,
                                                        displayName,
                                                        Role,
                                                        "CanView"
                                                    ),
                                                    JSONFormat.IndentFour
                                                ),
                                                JSON(
                                                    ShowColumns(
                                                        AddColumns(
                                                            ComboboxCanvas1_6.SelectedItems,
                                                            Id,
                                                            'Azure AD Object ID',
                                                            Type,
                                                            "User",
                                                            DisplayName,
                                                            'Full Name',
                                                            Role,
                                                            "CanView"
                                                        ),
                                                        Id,
                                                        Type,
                                                        DisplayName,
                                                        Role
                                                    ),
                                                    JSONFormat.IndentFour
                                                )
                                            ),
                                            "[]"
                                        )
                                    }
                                );
                                If(
                                    _shareAppsResonse.status = "Success",
                                    Set(
                                        varMenuIconControl,
                                        JSON(
                                            Image7_1.Image,
                                            JSONFormat.IncludeBinaryData
                                        )
                                    );
                                    Set(
                                        varIconBinaryOnly,
                                        Mid(
                                            varMenuIconControl,
                                            Find(
                                                ",",
                                                varMenuIconControl
                                            ) + 1,
                                            Len(varMenuIconControl) - Find(
                                                ",",
                                                varMenuIconControl
                                            ) - 1
                                        )
                                    );
                                    UpdateContext(
                                        {
                                            _menuItemResponse: InstallTemplateSAPMenuItem.Run(
                                                "Purchase Requisitions",
                                                If(
                                                    RadioGroupCanvas1_10.Selected.Value = 1,
                                                    JSON(
                                                        AddColumns(
                                                            ComboboxCanvas1_5.SelectedItems,
                                                            Id,
                                                            id,
                                                            Type,
                                                            "Team"
                                                        ),
                                                        JSONFormat.IndentFour
                                                    ),
                                                    JSON(
                                                        ShowColumns(
                                                            AddColumns(
                                                                ComboboxCanvas1_6.SelectedItems,
                                                                Id,
                                                                'Azure AD Object ID',
                                                                Type,
                                                                "User"
                                                            ),
                                                            Id,
                                                            Type
                                                        ),
                                                        JSONFormat.IndentFour
                                                    )
                                                ),
                                                varIconBinaryOnly,
                                                SAPPurchaseRequisitionsApp.properties.appOpenUri
                                            )
                                        }
                                    );
                                    If(
                                        _menuItemResponse.status = "Success",
                                        Notify(
                                            "The purchase requisitions app was successfully shared along with its menu item.",
                                            NotificationType.Success,
                                            5000
                                        );
                                        With(
                                            {_controlName: "CheckboxCanvas5_13"},
                                            Patch(
                                                'Activity Step Values',
                                                Coalesce(
                                                    LookUp(
                                                        'Activity Step Values',
                                                        'Control Name' = _controlName
                                                    ),
                                                    Defaults('Activity Step Values')
                                                ),
                                                {
                                                    'Control Name': _controlName,
                                                    'Data Type': 'Data Type (Activity Step Values)'.Boolean,
                                                    'Activity Step': CurrentActivityStep,
                                                    Value: "true"
                                                }
                                            )
                                        );
                                        Reset(CheckboxCanvas5_13);
                                        Reset(ComboboxCanvas1_5);
                                        Reset(ComboboxCanvas1_6),
                                        Notify(
                                            _menuItemResponse.message,
                                            NotificationType.Error,
                                            0
                                        )
                                    ),
                                    Notify(
                                        _shareAppsResonse.statusmessage,
                                        NotificationType.Error,
                                        0
                                    )
                                );
                                Set(
                                    varDisableControls,
                                    false
                                );
                            Text: ="Share purchase requisitions app"
                            VerticalAlign: =""
                            Visible: =RadioGroupCanvas1_10.Selected.Value<>3
                            Width: =250
                            X: =0
                            Y: =0
                            ZIndex: =1

                        Spinner2_9 As Spinner:
                            AccessibleLabel: ="Processing"
                            BasePaletteColor: =
                            DisplayMode: =DisplayMode.Edit
                            FontColor: =
                            Height: =Container5_10.Height-5
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            SpinnerColor: =
                            SpinnerSize: ='Spinner.SpinnerSize'.ExtraSmall
                            TrackColor: =
                            Visible: =And(varDisableControls,ButtonCanvas2_3.Visible)
                            Width: =Self.Height
                            X: =0
                            Y: =0
                            ZIndex: =2

                CheckboxCanvas5_13 As Checkbox:
                    AccessibleLabel: ="Purchase requisitions app has been successfully shared"
                    BasePaletteColor: =
                    CheckboxSize: =16
                    Checked: |-
                        =With(
                            {
                                _stepValue: LookUp(
                                    'Activity Step Values',
                                    'Control Name' = "CheckboxCanvas5_13"
                                ).Value
                            },
                            If(_stepValue = "true",true,false)
                        )
                    DisplayMode: |-
                        =If(
                            varDisableControls,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    FontWeight: =""
                    Height: =40
                    Label: ="Purchase requisitions app has been successfully shared"
                    LayoutMinHeight: =32
                    LayoutMinWidth: =160
                    OnCheck: =false
                    OnUncheck: =false
                    Visible: =RadioGroupCanvas1_10.Selected.Value <> 3
                    Width: =160
                    X: =40
                    Y: =40
                    ZIndex: =7

            Container1_76 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =20
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =2
                PaddingRight: =2
                Visible: =CurrentActivityStep.'Step Name' = "Share Purchase Orders"
                ZIndex: =6

                Container21_2 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =175
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    Container20_2 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =50
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =0
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =5
                        ZIndex: =1

                        HtmlText2_63 As htmlViewer:
                            AutoHeight: =true
                            DisabledBorderColor: =RGBA(56, 56, 56, 1)
                            FillPortions: =1
                            Font: =Font.'Segoe UI'
                            HtmlText: =CurrentActivityStep.Summary
                            ZIndex: =1

                        Image7_2 As image:
                            AccessibleLabel: ="Purchase orders icon"
                            BorderThickness: =
                            Height: =40
                            Image: ='Purchase Orders-Dark'
                            Width: =40
                            ZIndex: =2

                    RadioGroupCanvas1_11 As Radio.pcfdataset:
                        AccessibleLabel: ="Choose to share with security group or users"
                        BasePaletteColor: =
                        DefaultSelectedItems: |-
                            =With(
                                {
                                    _activityStep: LookUp (
                                        'Activity Step Values',
                                        'Control Name' = "RadioGroupCanvas1_11"
                                    )
                                },
                                First(
                                    Filter(
                                        Table(
                                            {
                                                Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                                Value: 1
                                            },
                                            {
                                                Option: "Users - Share the app with specific users that you select",
                                                Value: 2
                                            },
                                            {
                                                Option: "Not planning to deploy this app",
                                                Value: 3
                                            }
                                        ),
                                        If(
                                            IsBlank(_activityStep),
                                            Value = 1,
                                            Value = Value(_activityStep.Value)
                                        )
                                    ).Option
                                )
                            )
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontSize: =0
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =120
                        Items: |-
                            =Table(
                                {
                                    Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                    Value: 1
                                },
                                {
                                    Option: "Users - Share the app with specific users that you select",
                                    Value: 2
                                },
                                {
                                    Option: "Not planning to deploy this app",
                                    Value: 3
                                }
                            )
                        Layout: ="Vertical"
                        LayoutMinHeight: =96
                        LayoutMinWidth: =320
                        OnChange: =
                        RadioSize: =16
                        Width: =Parent.Width
                        X: =0
                        Y: =
                        ZIndex: =2

                        Option1_11 As PowerApps_CoreControls_RadioGroupCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="Option"
                            FieldName: ="Option"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =5

                TextCanvas1_25 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Security groups"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_11.Selected.Value=1
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =4

                TextCanvas1_26 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Users"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_11.Selected.Value=2
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =5

                Container12_15 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingRight: =10
                    Visible: =RadioGroupCanvas1_11.Selected.Value<>3
                    ZIndex: =6

                    ComboboxCanvas1_11 As Combobox.pcfdataset:
                        AccessibleLabel: ="Existing security groups"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select security groups"
                        Items: |-
                            =Sort(
                                Filter(
                                    Office365Groups.ListGroups().value,
                                    securityEnabled = true
                                ),
                                displayName
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_11.Selected.Value=1
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =1

                        displayName1_4 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="displayName"
                            FieldName: ="displayName"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =20

                    ComboboxCanvas1_12 As Combobox.pcfdataset:
                        AccessibleLabel: ="Select users"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select users"
                        Items: |-
                            =Sort(
                                Filter(
                                    Users,
                                    'Users (Views)'.'Enabled Users'
                                ),
                                'Full Name'
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_11.Selected.Value=2
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =2

                        "'Full Name1_4' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Full Name"
                            FieldName: ="fullname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =21

                        "'User Name1_4' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="User Name"
                            FieldName: ="domainname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            ZIndex: =22

                    Container5_11 As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =35
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =10
                        LayoutMinHeight: =0
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =5
                        PaddingLeft: =2
                        PaddingRight: =5
                        PaddingTop: =5
                        Width: =400
                        ZIndex: =3

                        ButtonCanvas2_7 As Button:
                            AccessibleLabel: ="Share purchase orders app"
                            Align: =""
                            BasePaletteColor: =
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: |-
                                =If(
                                    Or(
                                        And(
                                            IsBlank(ComboboxCanvas1_11.Selected),
                                            RadioGroupCanvas1_11.Selected.Value = 1
                                        ),
                                        And(
                                            IsBlank(ComboboxCanvas1_12.Selected),
                                            RadioGroupCanvas1_11.Selected.Value = 2
                                        ),
                                        varDisableControls
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Font: =""
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            Icon: =""
                            IconRotation: =0
                            IconStyle: ="Outline"
                            Layout: ="Icon before"
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            OnSelect: |
                                =Set(
                                    varDisableControls,
                                    true
                                );
                                Notify(
                                    "Sharing the purchase orders app and updating its menu item which can take several minutes. Please do not navigate away from this screen.",
                                    NotificationType.Information,
                                    0
                                );
                                UpdateContext(
                                    {
                                        _shareAppsResonse: InstallTemplateShareApps.Run(
                                            SAPPurchaseOrdersApp.name,
                                            BAPAPIVersion,
                                            JSON(
                                                SAPUserSecurityRoles,
                                                JSONFormat.IndentFour
                                            ),
                                            If(
                                                RadioGroupCanvas1_11.Selected.Value = 1,
                                                JSON(
                                                    AddColumns(
                                                        ComboboxCanvas1_11.SelectedItems,
                                                        Id,
                                                        id,
                                                        Type,
                                                        "Team",
                                                        DisplayName,
                                                        displayName,
                                                        Role,
                                                        "CanView"
                                                    ),
                                                    JSONFormat.IndentFour
                                                ),
                                                JSON(
                                                    ShowColumns(
                                                        AddColumns(
                                                            ComboboxCanvas1_12.SelectedItems,
                                                            Id,
                                                            'Azure AD Object ID',
                                                            Type,
                                                            "User",
                                                            DisplayName,
                                                            'Full Name',
                                                            Role,
                                                            "CanView"
                                                        ),
                                                        Id,
                                                        Type,
                                                        DisplayName,
                                                        Role
                                                    ),
                                                    JSONFormat.IndentFour
                                                )
                                            ),
                                            "[]"
                                        )
                                    }
                                );
                                If(
                                    _shareAppsResonse.status = "Success",
                                    Set(
                                        varMenuIconControl,
                                        JSON(
                                            Image7_2.Image,
                                            JSONFormat.IncludeBinaryData
                                        )
                                    );
                                    Set(
                                        varIconBinaryOnly,
                                        Mid(
                                            varMenuIconControl,
                                            Find(
                                                ",",
                                                varMenuIconControl
                                            ) + 1,
                                            Len(varMenuIconControl) - Find(
                                                ",",
                                                varMenuIconControl
                                            ) - 1
                                        )
                                    );
                                    UpdateContext(
                                        {
                                            _menuItemResponse: InstallTemplateSAPMenuItem.Run(
                                                "Purchase Orders",
                                                If(
                                                    RadioGroupCanvas1_11.Selected.Value = 1,
                                                    JSON(
                                                        AddColumns(
                                                            ComboboxCanvas1_11.SelectedItems,
                                                            Id,
                                                            id,
                                                            Type,
                                                            "Team"
                                                        ),
                                                        JSONFormat.IndentFour
                                                    ),
                                                    JSON(
                                                        ShowColumns(
                                                            AddColumns(
                                                                ComboboxCanvas1_12.SelectedItems,
                                                                Id,
                                                                'Azure AD Object ID',
                                                                Type,
                                                                "User"
                                                            ),
                                                            Id,
                                                            Type
                                                        ),
                                                        JSONFormat.IndentFour
                                                    )
                                                ),
                                                varIconBinaryOnly,
                                                SAPPurchaseOrdersApp.properties.appOpenUri
                                            )
                                        }
                                    );
                                    If(
                                        _menuItemResponse.status = "Success",
                                        Notify(
                                            "The purchase orders app was successfully shared along with its menu item.",
                                            NotificationType.Success,
                                            5000
                                        );
                                        With(
                                            {_controlName: "CheckboxCanvas5_15"},
                                            Patch(
                                                'Activity Step Values',
                                                Coalesce(
                                                    LookUp(
                                                        'Activity Step Values',
                                                        'Control Name' = _controlName
                                                    ),
                                                    Defaults('Activity Step Values')
                                                ),
                                                {
                                                    'Control Name': _controlName,
                                                    'Data Type': 'Data Type (Activity Step Values)'.Boolean,
                                                    'Activity Step': CurrentActivityStep,
                                                    Value: "true"
                                                }
                                            )
                                        );
                                        Reset(CheckboxCanvas5_15);
                                        Reset(ComboboxCanvas1_11);
                                        Reset(ComboboxCanvas1_12),
                                        Notify(
                                            _menuItemResponse.message,
                                            NotificationType.Error,
                                            0
                                        )
                                    ),
                                    Notify(
                                        _shareAppsResonse.statusmessage,
                                        NotificationType.Error,
                                        0
                                    )
                                );
                                Set(
                                    varDisableControls,
                                    false
                                );
                            Text: ="Share purchase orders app"
                            VerticalAlign: =""
                            Visible: =RadioGroupCanvas1_11.Selected.Value<>3
                            Width: =250
                            X: =0
                            Y: =0
                            ZIndex: =1

                        Spinner2_10 As Spinner:
                            AccessibleLabel: ="Processing"
                            BasePaletteColor: =
                            DisplayMode: =DisplayMode.Edit
                            FontColor: =
                            Height: =Container5_11.Height-5
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            SpinnerColor: =
                            SpinnerSize: ='Spinner.SpinnerSize'.ExtraSmall
                            TrackColor: =
                            Visible: =And(varDisableControls,ButtonCanvas2_7.Visible)
                            Width: =Self.Height
                            X: =0
                            Y: =0
                            ZIndex: =2

                CheckboxCanvas5_15 As Checkbox:
                    AccessibleLabel: ="Purchase orders app has been successfully shared"
                    BasePaletteColor: =
                    CheckboxSize: =16
                    Checked: |-
                        =With(
                            {
                                _stepValue: LookUp(
                                    'Activity Step Values',
                                    'Control Name' = "CheckboxCanvas5_15"
                                ).Value
                            },
                            If(_stepValue = "true",true,false)
                        )
                    DisplayMode: |-
                        =If(
                            varDisableControls,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    FontWeight: =""
                    Height: =40
                    Label: ="Purchase orders app has been successfully shared"
                    LayoutMinHeight: =32
                    LayoutMinWidth: =160
                    OnCheck: =false
                    OnUncheck: =false
                    Visible: =RadioGroupCanvas1_11.Selected.Value <> 3
                    Width: =160
                    X: =40
                    Y: =40
                    ZIndex: =7

            Container1_77 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =20
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =2
                PaddingRight: =2
                Visible: =CurrentActivityStep.'Step Name' = "Share Goods Receipts"
                ZIndex: =7

                Container21_3 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =175
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    Container20_3 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =50
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =0
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =5
                        ZIndex: =1

                        HtmlText2_64 As htmlViewer:
                            AutoHeight: =true
                            DisabledBorderColor: =RGBA(56, 56, 56, 1)
                            FillPortions: =1
                            Font: =Font.'Segoe UI'
                            HtmlText: =CurrentActivityStep.Summary
                            ZIndex: =1

                        Image7_3 As image:
                            AccessibleLabel: ="Goods receipts icon"
                            BorderThickness: =
                            Height: =40
                            Image: ='Goods Receipt-Dark'
                            Width: =40
                            ZIndex: =2

                    RadioGroupCanvas1_12 As Radio.pcfdataset:
                        AccessibleLabel: ="Choose to share with security group or users"
                        BasePaletteColor: =
                        DefaultSelectedItems: |-
                            =With(
                                {
                                    _activityStep: LookUp (
                                        'Activity Step Values',
                                        'Control Name' = "RadioGroupCanvas1_12"
                                    )
                                },
                                First(
                                    Filter(
                                        Table(
                                            {
                                                Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                                Value: 1
                                            },
                                            {
                                                Option: "Users - Share the app with specific users that you select",
                                                Value: 2
                                            },
                                            {
                                                Option: "Not planning to deploy this app",
                                                Value: 3
                                            }
                                        ),
                                        If(
                                            IsBlank(_activityStep),
                                            Value = 1,
                                            Value = Value(_activityStep.Value)
                                        )
                                    ).Option
                                )
                            )
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontSize: =0
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =120
                        Items: |-
                            =Table(
                                {
                                    Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                    Value: 1
                                },
                                {
                                    Option: "Users - Share the app with specific users that you select",
                                    Value: 2
                                },
                                {
                                    Option: "Not planning to deploy this app",
                                    Value: 3
                                }
                            )
                        Layout: ="Vertical"
                        LayoutMinHeight: =96
                        LayoutMinWidth: =320
                        OnChange: =
                        RadioSize: =16
                        Width: =Parent.Width
                        X: =0
                        Y: =
                        ZIndex: =2

                        Option1_12 As PowerApps_CoreControls_RadioGroupCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="Option"
                            FieldName: ="Option"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =5

                TextCanvas1_27 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Security groups"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_12.Selected.Value=1
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =4

                TextCanvas1_28 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Users"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_12.Selected.Value=2
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =5

                Container12_16 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingRight: =10
                    Visible: =RadioGroupCanvas1_12.Selected.Value<>3
                    ZIndex: =6

                    ComboboxCanvas1_13 As Combobox.pcfdataset:
                        AccessibleLabel: ="Existing security groups"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select security groups"
                        Items: |-
                            =Sort(
                                Filter(
                                    Office365Groups.ListGroups().value,
                                    securityEnabled = true
                                ),
                                displayName
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_12.Selected.Value=1
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =1

                        displayName1_5 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="displayName"
                            FieldName: ="displayName"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =20

                    ComboboxCanvas1_14 As Combobox.pcfdataset:
                        AccessibleLabel: ="Select users"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select users"
                        Items: |-
                            =Sort(
                                Filter(
                                    Users,
                                    'Users (Views)'.'Enabled Users'
                                ),
                                'Full Name'
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_12.Selected.Value=2
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =2

                        "'Full Name1_5' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Full Name"
                            FieldName: ="fullname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =21

                        "'User Name1_5' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="User Name"
                            FieldName: ="domainname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            ZIndex: =22

                    Container5_12 As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =35
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =10
                        LayoutMinHeight: =0
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =5
                        PaddingLeft: =2
                        PaddingRight: =5
                        PaddingTop: =5
                        Width: =400
                        ZIndex: =3

                        ButtonCanvas2_8 As Button:
                            AccessibleLabel: ="Share goods receipts app"
                            Align: =""
                            BasePaletteColor: =
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: |-
                                =If(
                                    Or(
                                        And(
                                            IsBlank(ComboboxCanvas1_13.Selected),
                                            RadioGroupCanvas1_12.Selected.Value = 1
                                        ),
                                        And(
                                            IsBlank(ComboboxCanvas1_14.Selected),
                                            RadioGroupCanvas1_12.Selected.Value = 2
                                        ),
                                        varDisableControls
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Font: =""
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            Icon: =""
                            IconRotation: =0
                            IconStyle: ="Outline"
                            Layout: ="Icon before"
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            OnSelect: |
                                =Set(
                                    varDisableControls,
                                    true
                                );
                                Notify(
                                    "Sharing the goods receipts app and updating its menu item which can take several minutes. Please do not navigate away from this screen.",
                                    NotificationType.Information,
                                    0
                                );
                                UpdateContext(
                                    {
                                        _shareAppsResonse: InstallTemplateShareApps.Run(
                                            SAPGoodsReceiptApp.name,
                                            BAPAPIVersion,
                                            JSON(
                                                SAPUserSecurityRoles,
                                                JSONFormat.IndentFour
                                            ),
                                            If(
                                                RadioGroupCanvas1_12.Selected.Value = 1,
                                                JSON(
                                                    AddColumns(
                                                        ComboboxCanvas1_13.SelectedItems,
                                                        Id,
                                                        id,
                                                        Type,
                                                        "Team",
                                                        DisplayName,
                                                        displayName,
                                                        Role,
                                                        "CanView"
                                                    ),
                                                    JSONFormat.IndentFour
                                                ),
                                                JSON(
                                                    ShowColumns(
                                                        AddColumns(
                                                            ComboboxCanvas1_14.SelectedItems,
                                                            Id,
                                                            'Azure AD Object ID',
                                                            Type,
                                                            "User",
                                                            DisplayName,
                                                            'Full Name',
                                                            Role,
                                                            "CanView"
                                                        ),
                                                        Id,
                                                        Type,
                                                        DisplayName,
                                                        Role
                                                    ),
                                                    JSONFormat.IndentFour
                                                )
                                            ),
                                            "[]"
                                        )
                                    }
                                );
                                If(
                                    _shareAppsResonse.status = "Success",
                                    Set(
                                        varMenuIconControl,
                                        JSON(
                                            Image7_3.Image,
                                            JSONFormat.IncludeBinaryData
                                        )
                                    );
                                    Set(
                                        varIconBinaryOnly,
                                        Mid(
                                            varMenuIconControl,
                                            Find(
                                                ",",
                                                varMenuIconControl
                                            ) + 1,
                                            Len(varMenuIconControl) - Find(
                                                ",",
                                                varMenuIconControl
                                            ) - 1
                                        )
                                    );
                                    UpdateContext(
                                        {
                                            _menuItemResponse: InstallTemplateSAPMenuItem.Run(
                                                "Goods Receipts",
                                                If(
                                                    RadioGroupCanvas1_12.Selected.Value = 1,
                                                    JSON(
                                                        AddColumns(
                                                            ComboboxCanvas1_13.SelectedItems,
                                                            Id,
                                                            id,
                                                            Type,
                                                            "Team"
                                                        ),
                                                        JSONFormat.IndentFour
                                                    ),
                                                    JSON(
                                                        ShowColumns(
                                                            AddColumns(
                                                                ComboboxCanvas1_14.SelectedItems,
                                                                Id,
                                                                'Azure AD Object ID',
                                                                Type,
                                                                "User"
                                                            ),
                                                            Id,
                                                            Type
                                                        ),
                                                        JSONFormat.IndentFour
                                                    )
                                                ),
                                                varIconBinaryOnly,
                                                SAPGoodsReceiptApp.properties.appOpenUri
                                            )
                                        }
                                    );
                                    If(
                                        _menuItemResponse.status = "Success",
                                        Notify(
                                            "The goods receipts app was successfully shared along with its menu item.",
                                            NotificationType.Success,
                                            5000
                                        );
                                        With(
                                            {_controlName: "CheckboxCanvas5_19"},
                                            Patch(
                                                'Activity Step Values',
                                                Coalesce(
                                                    LookUp(
                                                        'Activity Step Values',
                                                        'Control Name' = _controlName
                                                    ),
                                                    Defaults('Activity Step Values')
                                                ),
                                                {
                                                    'Control Name': _controlName,
                                                    'Data Type': 'Data Type (Activity Step Values)'.Boolean,
                                                    'Activity Step': CurrentActivityStep,
                                                    Value: "true"
                                                }
                                            )
                                        );
                                        Reset(CheckboxCanvas5_19);
                                        Reset(ComboboxCanvas1_13);
                                        Reset(ComboboxCanvas1_14),
                                        Notify(
                                            _menuItemResponse.message,
                                            NotificationType.Error,
                                            0
                                        )
                                    ),
                                    Notify(
                                        _shareAppsResonse.statusmessage,
                                        NotificationType.Error,
                                        0
                                    )
                                );
                                Set(
                                    varDisableControls,
                                    false
                                );
                            Text: ="Share goods receipts app"
                            VerticalAlign: =""
                            Visible: =RadioGroupCanvas1_12.Selected.Value<>3
                            Width: =250
                            X: =0
                            Y: =0
                            ZIndex: =1

                        Spinner2_11 As Spinner:
                            AccessibleLabel: ="Processing"
                            BasePaletteColor: =
                            DisplayMode: =DisplayMode.Edit
                            FontColor: =
                            Height: =Container5_12.Height-5
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            SpinnerColor: =
                            SpinnerSize: ='Spinner.SpinnerSize'.ExtraSmall
                            TrackColor: =
                            Visible: =And(varDisableControls,ButtonCanvas2_8.Visible)
                            Width: =Self.Height
                            X: =0
                            Y: =0
                            ZIndex: =2

                CheckboxCanvas5_19 As Checkbox:
                    AccessibleLabel: ="Goods receipts app has been successfully shared"
                    BasePaletteColor: =
                    CheckboxSize: =16
                    Checked: |-
                        =With(
                            {
                                _stepValue: LookUp(
                                    'Activity Step Values',
                                    'Control Name' = "CheckboxCanvas5_19"
                                ).Value
                            },
                            If(_stepValue = "true",true,false)
                        )
                    DisplayMode: |-
                        =If(
                            varDisableControls,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    FontWeight: =""
                    Height: =40
                    Label: ="Goods receipts app has been successfully shared"
                    LayoutMinHeight: =32
                    LayoutMinWidth: =160
                    OnCheck: =false
                    OnUncheck: =false
                    Visible: =RadioGroupCanvas1_12.Selected.Value <> 3
                    Width: =160
                    X: =40
                    Y: =40
                    ZIndex: =7

            Container1_82 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =20
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =2
                PaddingRight: =2
                Visible: =CurrentActivityStep.'Step Name' = "Share Vendor Invoices"
                ZIndex: =8

                Container21_4 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =175
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    Container20_4 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =50
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =0
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =5
                        ZIndex: =1

                        HtmlText2_68 As htmlViewer:
                            AutoHeight: =true
                            DisabledBorderColor: =RGBA(56, 56, 56, 1)
                            FillPortions: =1
                            Font: =Font.'Segoe UI'
                            HtmlText: =CurrentActivityStep.Summary
                            ZIndex: =1

                        Image7_4 As image:
                            AccessibleLabel: ="Vendor invoices icon"
                            BorderThickness: =
                            Height: =40
                            Image: ='Vendor Invoices Icon'
                            Width: =40
                            ZIndex: =2

                    RadioGroupCanvas1_13 As Radio.pcfdataset:
                        AccessibleLabel: ="Choose to share with security group or users"
                        BasePaletteColor: =
                        DefaultSelectedItems: |-
                            =With(
                                {
                                    _activityStep: LookUp (
                                        'Activity Step Values',
                                        'Control Name' = "RadioGroupCanvas1_13"
                                    )
                                },
                                First(
                                    Filter(
                                        Table(
                                            {
                                                Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                                Value: 1
                                            },
                                            {
                                                Option: "Users - Share the app with specific users that you select",
                                                Value: 2
                                            },
                                            {
                                                Option: "Not planning to deploy this app",
                                                Value: 3
                                            }
                                        ),
                                        If(
                                            IsBlank(_activityStep),
                                            Value = 1,
                                            Value = Value(_activityStep.Value)
                                        )
                                    ).Option
                                )
                            )
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontSize: =0
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =120
                        Items: |-
                            =Table(
                                {
                                    Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                    Value: 1
                                },
                                {
                                    Option: "Users - Share the app with specific users that you select",
                                    Value: 2
                                },
                                {
                                    Option: "Not planning to deploy this app",
                                    Value: 3
                                }
                            )
                        Layout: ="Vertical"
                        LayoutMinHeight: =96
                        LayoutMinWidth: =320
                        OnChange: =
                        RadioSize: =16
                        Width: =Parent.Width
                        X: =0
                        Y: =
                        ZIndex: =2

                        Option1_13 As PowerApps_CoreControls_RadioGroupCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="Option"
                            FieldName: ="Option"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =5

                TextCanvas1_29 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Security groups"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_13.Selected.Value=1
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =4

                TextCanvas1_30 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Users"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_13.Selected.Value=2
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =5

                Container12_17 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingRight: =10
                    Visible: =RadioGroupCanvas1_13.Selected.Value<>3
                    ZIndex: =6

                    ComboboxCanvas1_15 As Combobox.pcfdataset:
                        AccessibleLabel: ="Existing security groups"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select security groups"
                        Items: |-
                            =Sort(
                                Filter(
                                    Office365Groups.ListGroups().value,
                                    securityEnabled = true
                                ),
                                displayName
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_13.Selected.Value=1
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =1

                        displayName1_6 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="displayName"
                            FieldName: ="displayName"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =20

                    ComboboxCanvas1_16 As Combobox.pcfdataset:
                        AccessibleLabel: ="Select users"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select users"
                        Items: |-
                            =Sort(
                                Filter(
                                    Users,
                                    'Users (Views)'.'Enabled Users'
                                ),
                                'Full Name'
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_13.Selected.Value=2
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =2

                        "'Full Name1_6' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Full Name"
                            FieldName: ="fullname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =21

                        "'User Name1_6' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="User Name"
                            FieldName: ="domainname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            ZIndex: =22

                    Container5_13 As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =35
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =10
                        LayoutMinHeight: =0
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =5
                        PaddingLeft: =2
                        PaddingRight: =5
                        PaddingTop: =5
                        Width: =400
                        ZIndex: =3

                        ButtonCanvas2_9 As Button:
                            AccessibleLabel: ="Share vendor invoices app"
                            Align: =""
                            BasePaletteColor: =
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: |-
                                =If(
                                    Or(
                                        And(
                                            IsBlank(ComboboxCanvas1_15.Selected),
                                            RadioGroupCanvas1_13.Selected.Value = 1
                                        ),
                                        And(
                                            IsBlank(ComboboxCanvas1_16.Selected),
                                            RadioGroupCanvas1_13.Selected.Value = 2
                                        ),
                                        varDisableControls
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Font: =""
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            Icon: =""
                            IconRotation: =0
                            IconStyle: ="Outline"
                            Layout: ="Icon before"
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            OnSelect: |
                                =Set(
                                    varDisableControls,
                                    true
                                );
                                Notify(
                                    "Sharing the vendor invoices app and updating its menu item which can take several minutes. Please do not navigate away from this screen.",
                                    NotificationType.Information,
                                    0
                                );
                                UpdateContext(
                                    {
                                        _shareAppsResonse: InstallTemplateShareApps.Run(
                                            SAPVendorInvoicesApp.name,
                                            BAPAPIVersion,
                                            JSON(
                                                SAPUserSecurityRoles,
                                                JSONFormat.IndentFour
                                            ),
                                            If(
                                                RadioGroupCanvas1_13.Selected.Value = 1,
                                                JSON(
                                                    AddColumns(
                                                        ComboboxCanvas1_15.SelectedItems,
                                                        Id,
                                                        id,
                                                        Type,
                                                        "Team",
                                                        DisplayName,
                                                        displayName,
                                                        Role,
                                                        "CanView"
                                                    ),
                                                    JSONFormat.IndentFour
                                                ),
                                                JSON(
                                                    ShowColumns(
                                                        AddColumns(
                                                            ComboboxCanvas1_16.SelectedItems,
                                                            Id,
                                                            'Azure AD Object ID',
                                                            Type,
                                                            "User",
                                                            DisplayName,
                                                            'Full Name',
                                                            Role,
                                                            "CanView"
                                                        ),
                                                        Id,
                                                        Type,
                                                        DisplayName,
                                                        Role
                                                    ),
                                                    JSONFormat.IndentFour
                                                )
                                            ),
                                            "[]"
                                        )
                                    }
                                );
                                If(
                                    _shareAppsResonse.status = "Success",
                                    Set(
                                        varMenuIconControl,
                                        JSON(
                                            Image7_4.Image,
                                            JSONFormat.IncludeBinaryData
                                        )
                                    );
                                    Set(
                                        varIconBinaryOnly,
                                        Mid(
                                            varMenuIconControl,
                                            Find(
                                                ",",
                                                varMenuIconControl
                                            ) + 1,
                                            Len(varMenuIconControl) - Find(
                                                ",",
                                                varMenuIconControl
                                            ) - 1
                                        )
                                    );
                                    UpdateContext(
                                        {
                                            _menuItemResponse: InstallTemplateSAPMenuItem.Run(
                                                "Vendor Invoices",
                                                If(
                                                    RadioGroupCanvas1_13.Selected.Value = 1,
                                                    JSON(
                                                        AddColumns(
                                                            ComboboxCanvas1_15.SelectedItems,
                                                            Id,
                                                            id,
                                                            Type,
                                                            "Team"
                                                        ),
                                                        JSONFormat.IndentFour
                                                    ),
                                                    JSON(
                                                        ShowColumns(
                                                            AddColumns(
                                                                ComboboxCanvas1_16.SelectedItems,
                                                                Id,
                                                                'Azure AD Object ID',
                                                                Type,
                                                                "User"
                                                            ),
                                                            Id,
                                                            Type
                                                        ),
                                                        JSONFormat.IndentFour
                                                    )
                                                ),
                                                varIconBinaryOnly,
                                                SAPVendorInvoicesApp.properties.appOpenUri
                                            )
                                        }
                                    );
                                    If(
                                        _menuItemResponse.status = "Success",
                                        Notify(
                                            "The vendor invoices app was successfully shared along with its menu item.",
                                            NotificationType.Success,
                                            5000
                                        );
                                        With(
                                            {_controlName: "CheckboxCanvas5_20"},
                                            Patch(
                                                'Activity Step Values',
                                                Coalesce(
                                                    LookUp(
                                                        'Activity Step Values',
                                                        'Control Name' = _controlName
                                                    ),
                                                    Defaults('Activity Step Values')
                                                ),
                                                {
                                                    'Control Name': _controlName,
                                                    'Data Type': 'Data Type (Activity Step Values)'.Boolean,
                                                    'Activity Step': CurrentActivityStep,
                                                    Value: "true"
                                                }
                                            )
                                        );
                                        Reset(CheckboxCanvas5_20);
                                        Reset(ComboboxCanvas1_15);
                                        Reset(ComboboxCanvas1_16),
                                        Notify(
                                            _menuItemResponse.message,
                                            NotificationType.Error,
                                            0
                                        )
                                    ),
                                    Notify(
                                        _shareAppsResonse.statusmessage,
                                        NotificationType.Error,
                                        0
                                    )
                                );
                                Set(
                                    varDisableControls,
                                    false
                                );
                            Text: ="Share vendor invoices app"
                            VerticalAlign: =""
                            Visible: =RadioGroupCanvas1_13.Selected.Value<>3
                            Width: =250
                            X: =0
                            Y: =0
                            ZIndex: =1

                        Spinner2_12 As Spinner:
                            AccessibleLabel: ="Processing"
                            BasePaletteColor: =
                            DisplayMode: =DisplayMode.Edit
                            FontColor: =
                            Height: =Container5_13.Height-5
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            SpinnerColor: =
                            SpinnerSize: ='Spinner.SpinnerSize'.ExtraSmall
                            TrackColor: =
                            Visible: =And(varDisableControls,ButtonCanvas2_9.Visible)
                            Width: =Self.Height
                            X: =0
                            Y: =0
                            ZIndex: =2

                CheckboxCanvas5_20 As Checkbox:
                    AccessibleLabel: ="Vendor invoices app has been successfully shared"
                    BasePaletteColor: =
                    CheckboxSize: =16
                    Checked: |-
                        =With(
                            {
                                _stepValue: LookUp(
                                    'Activity Step Values',
                                    'Control Name' = "CheckboxCanvas5_20"
                                ).Value
                            },
                            If(_stepValue = "true",true,false)
                        )
                    DisplayMode: |-
                        =If(
                            varDisableControls,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    FontWeight: =""
                    Height: =40
                    Label: ="Vendor invoices app has been successfully shared"
                    LayoutMinHeight: =32
                    LayoutMinWidth: =160
                    OnCheck: =false
                    OnUncheck: =false
                    Visible: =RadioGroupCanvas1_13.Selected.Value <> 3
                    Width: =160
                    X: =40
                    Y: =40
                    ZIndex: =7

            Container1_83 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =20
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =2
                PaddingRight: =2
                Visible: =CurrentActivityStep.'Step Name' = "Share Vendor Payments"
                ZIndex: =9

                Container21_5 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =175
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    Container20_5 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =50
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =0
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =5
                        ZIndex: =1

                        HtmlText2_69 As htmlViewer:
                            AutoHeight: =true
                            DisabledBorderColor: =RGBA(56, 56, 56, 1)
                            FillPortions: =1
                            Font: =Font.'Segoe UI'
                            HtmlText: =CurrentActivityStep.Summary
                            ZIndex: =1

                        Image7_5 As image:
                            AccessibleLabel: ="Vendor payments icon"
                            BorderThickness: =
                            Height: =40
                            Image: ='Vendor Payments Icon-Dark'
                            Width: =40
                            ZIndex: =2

                    RadioGroupCanvas1_14 As Radio.pcfdataset:
                        AccessibleLabel: ="Choose to share with security group or users"
                        BasePaletteColor: =
                        DefaultSelectedItems: |-
                            =With(
                                {
                                    _activityStep: LookUp (
                                        'Activity Step Values',
                                        'Control Name' = "RadioGroupCanvas1_14"
                                    )
                                },
                                First(
                                    Filter(
                                        Table(
                                            {
                                                Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                                Value: 1
                                            },
                                            {
                                                Option: "Users - Share the app with specific users that you select",
                                                Value: 2
                                            },
                                            {
                                                Option: "Not planning to deploy this app",
                                                Value: 3
                                            }
                                        ),
                                        If(
                                            IsBlank(_activityStep),
                                            Value = 1,
                                            Value = Value(_activityStep.Value)
                                        )
                                    ).Option
                                )
                            )
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontSize: =0
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =120
                        Items: |-
                            =Table(
                                {
                                    Option: "Security Group (Recommended) - Share the app with a Microsoft Entra ID (formerly Azure Active Directory) security group",
                                    Value: 1
                                },
                                {
                                    Option: "Users - Share the app with specific users that you select",
                                    Value: 2
                                },
                                {
                                    Option: "Not planning to deploy this app",
                                    Value: 3
                                }
                            )
                        Layout: ="Vertical"
                        LayoutMinHeight: =96
                        LayoutMinWidth: =320
                        OnChange: =
                        RadioSize: =16
                        Width: =Parent.Width
                        X: =0
                        Y: =
                        ZIndex: =2

                        Option1_14 As PowerApps_CoreControls_RadioGroupCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="Option"
                            FieldName: ="Option"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =5

                TextCanvas1_31 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Security groups"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_14.Selected.Value=1
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =4

                TextCanvas1_32 As Text:
                    AutoHeight: =true
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Text: ="  Users"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Top
                    Visible: =RadioGroupCanvas1_14.Selected.Value=2
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =5

                Container12_18 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingRight: =10
                    Visible: =RadioGroupCanvas1_14.Selected.Value<>3
                    ZIndex: =6

                    ComboboxCanvas1_17 As Combobox.pcfdataset:
                        AccessibleLabel: ="Existing security groups"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select security groups"
                        Items: |-
                            =Sort(
                                Filter(
                                    Office365Groups.ListGroups().value,
                                    securityEnabled = true
                                ),
                                displayName
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_14.Selected.Value=1
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =1

                        displayName1_7 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                            FieldDisplayName: ="displayName"
                            FieldName: ="displayName"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =20

                    ComboboxCanvas1_18 As Combobox.pcfdataset:
                        AccessibleLabel: ="Select users"
                        Appearance: ="FilledDarker"
                        BorderStyle: =""
                        DefaultSelectedItems: =
                        DisplayMode: |-
                            =If(
                                varDisableControls,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Font: =""
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        FontWeight: =""
                        Height: =32
                        InputTextPlaceholder: ="Select users"
                        Items: |-
                            =Sort(
                                Filter(
                                    Users,
                                    'Users (Views)'.'Enabled Users'
                                ),
                                'Full Name'
                            )
                        LayoutMinHeight: =32
                        LayoutMinWidth: =200
                        MultiValueDelimiter: ="; "
                        SelectMultiple: =true
                        Visible: =RadioGroupCanvas1_14.Selected.Value=2
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =2

                        "'Full Name1_7' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Full Name"
                            FieldName: ="fullname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            ZIndex: =21

                        "'User Name1_7' As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn":
                            FieldDisplayName: ="User Name"
                            FieldName: ="domainname"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            ZIndex: =22

                    Container5_14 As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =35
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =10
                        LayoutMinHeight: =0
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =5
                        PaddingLeft: =2
                        PaddingRight: =5
                        PaddingTop: =5
                        Width: =400
                        ZIndex: =3

                        ButtonCanvas2_10 As Button:
                            AccessibleLabel: ="Share vendor payments app"
                            Align: =""
                            BasePaletteColor: =
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: |-
                                =If(
                                    Or(
                                        And(
                                            IsBlank(ComboboxCanvas1_17.Selected),
                                            RadioGroupCanvas1_14.Selected.Value = 1
                                        ),
                                        And(
                                            IsBlank(ComboboxCanvas1_18.Selected),
                                            RadioGroupCanvas1_14.Selected.Value = 2
                                        ),
                                        varDisableControls
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Font: =""
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            Icon: =""
                            IconRotation: =0
                            IconStyle: ="Outline"
                            Layout: ="Icon before"
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            OnSelect: |
                                =Set(
                                    varDisableControls,
                                    true
                                );
                                Notify(
                                    "Sharing the vendor payments app and updating its menu item which can take several minutes. Please do not navigate away from this screen.",
                                    NotificationType.Information,
                                    0
                                );
                                UpdateContext(
                                    {
                                        _shareAppsResonse: InstallTemplateShareApps.Run(
                                            SAPVendorPaymentsApp.name,
                                            BAPAPIVersion,
                                            JSON(
                                                SAPUserSecurityRoles,
                                                JSONFormat.IndentFour
                                            ),
                                            If(
                                                RadioGroupCanvas1_14.Selected.Value = 1,
                                                JSON(
                                                    AddColumns(
                                                        ComboboxCanvas1_17.SelectedItems,
                                                        Id,
                                                        id,
                                                        Type,
                                                        "Team",
                                                        DisplayName,
                                                        displayName,
                                                        Role,
                                                        "CanView"
                                                    ),
                                                    JSONFormat.IndentFour
                                                ),
                                                JSON(
                                                    ShowColumns(
                                                        AddColumns(
                                                            ComboboxCanvas1_18.SelectedItems,
                                                            Id,
                                                            'Azure AD Object ID',
                                                            Type,
                                                            "User",
                                                            DisplayName,
                                                            'Full Name',
                                                            Role,
                                                            "CanView"
                                                        ),
                                                        Id,
                                                        Type,
                                                        DisplayName,
                                                        Role
                                                    ),
                                                    JSONFormat.IndentFour
                                                )
                                            ),
                                            "[]"
                                        )
                                    }
                                );
                                If(
                                    _shareAppsResonse.status = "Success",
                                    Set(
                                        varMenuIconControl,
                                        JSON(
                                            Image7_5.Image,
                                            JSONFormat.IncludeBinaryData
                                        )
                                    );
                                    Set(
                                        varIconBinaryOnly,
                                        Mid(
                                            varMenuIconControl,
                                            Find(
                                                ",",
                                                varMenuIconControl
                                            ) + 1,
                                            Len(varMenuIconControl) - Find(
                                                ",",
                                                varMenuIconControl
                                            ) - 1
                                        )
                                    );
                                    UpdateContext(
                                        {
                                            _menuItemResponse: InstallTemplateSAPMenuItem.Run(
                                                "Vendor Payments",
                                                If(
                                                    RadioGroupCanvas1_14.Selected.Value = 1,
                                                    JSON(
                                                        AddColumns(
                                                            ComboboxCanvas1_17.SelectedItems,
                                                            Id,
                                                            id,
                                                            Type,
                                                            "Team"
                                                        ),
                                                        JSONFormat.IndentFour
                                                    ),
                                                    JSON(
                                                        ShowColumns(
                                                            AddColumns(
                                                                ComboboxCanvas1_18.SelectedItems,
                                                                Id,
                                                                'Azure AD Object ID',
                                                                Type,
                                                                "User"
                                                            ),
                                                            Id,
                                                            Type
                                                        ),
                                                        JSONFormat.IndentFour
                                                    )
                                                ),
                                                varIconBinaryOnly,
                                                SAPVendorPaymentsApp.properties.appOpenUri
                                            )
                                        }
                                    );
                                    If(
                                        _menuItemResponse.status = "Success",
                                        Notify(
                                            "The vendor payments app was successfully shared along with its menu item.",
                                            NotificationType.Success,
                                            5000
                                        );
                                        With(
                                            {_controlName: "CheckboxCanvas5_21"},
                                            Patch(
                                                'Activity Step Values',
                                                Coalesce(
                                                    LookUp(
                                                        'Activity Step Values',
                                                        'Control Name' = _controlName
                                                    ),
                                                    Defaults('Activity Step Values')
                                                ),
                                                {
                                                    'Control Name': _controlName,
                                                    'Data Type': 'Data Type (Activity Step Values)'.Boolean,
                                                    'Activity Step': CurrentActivityStep,
                                                    Value: "true"
                                                }
                                            )
                                        );
                                        Reset(CheckboxCanvas5_21);
                                        Reset(ComboboxCanvas1_17);
                                        Reset(ComboboxCanvas1_18),
                                        Notify(
                                            _menuItemResponse.message,
                                            NotificationType.Error,
                                            0
                                        )
                                    ),
                                    Notify(
                                        _shareAppsResonse.statusmessage,
                                        NotificationType.Error,
                                        0
                                    )
                                );
                                Set(
                                    varDisableControls,
                                    false
                                );
                            Text: ="Share vendor payments app"
                            VerticalAlign: =""
                            Visible: =RadioGroupCanvas1_14.Selected.Value<>3
                            Width: =250
                            X: =0
                            Y: =0
                            ZIndex: =1

                        Spinner2_13 As Spinner:
                            AccessibleLabel: ="Processing"
                            BasePaletteColor: =
                            DisplayMode: =DisplayMode.Edit
                            FontColor: =
                            Height: =Container5_14.Height-5
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            SpinnerColor: =
                            SpinnerSize: ='Spinner.SpinnerSize'.ExtraSmall
                            TrackColor: =
                            Visible: =And(varDisableControls,ButtonCanvas2_10.Visible)
                            Width: =Self.Height
                            X: =0
                            Y: =0
                            ZIndex: =2

                CheckboxCanvas5_21 As Checkbox:
                    AccessibleLabel: ="Vendor payments app has been successfully shared"
                    BasePaletteColor: =
                    CheckboxSize: =16
                    Checked: |-
                        =With(
                            {
                                _stepValue: LookUp(
                                    'Activity Step Values',
                                    'Control Name' = "CheckboxCanvas5_21"
                                ).Value
                            },
                            If(_stepValue = "true",true,false)
                        )
                    DisplayMode: |-
                        =If(
                            varDisableControls,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    FontWeight: =""
                    Height: =40
                    Label: ="Vendor payments app has been successfully shared"
                    LayoutMinHeight: =32
                    LayoutMinWidth: =160
                    OnCheck: =false
                    OnUncheck: =false
                    Visible: =RadioGroupCanvas1_14.Selected.Value <> 3
                    Width: =160
                    X: =40
                    Y: =40
                    ZIndex: =7

            Container1_35 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =10
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =2
                PaddingRight: =2
                Visible: =CurrentActivityStep.'Step Name' = "Share SAP Template Administrator App"
                ZIndex: =10

                HtmlText2_20 As htmlViewer:
                    AutoHeight: =true
                    DisabledBorderColor: =RGBA(56, 56, 56, 1)
                    Font: =Font.'Segoe UI'
                    HtmlText: =CurrentActivityStep.Summary
                    ZIndex: =1

                ButtonCanvas2_6 As Button:
                    AccessibleLabel: ="Open Power Apps maker portal"
                    Align: =""
                    AlignInContainer: =AlignInContainer.Start
                    BasePaletteColor: =
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    FontWeight: =""
                    Height: =32
                    Icon: =""
                    IconRotation: =0
                    IconStyle: ="Outline"
                    Layout: ="Icon before"
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    OnSelect: |-
                        =Launch(Concatenate("https://make.powerapps.com/environments/",varCurrentEnvironment.name,"/apps"))
                    Text: ="Open Power Apps maker portal"
                    VerticalAlign: =""
                    Visible: =true
                    Width: =250
                    X: =0
                    Y: =0
                    ZIndex: =2

                CheckboxCanvas5_2 As Checkbox:
                    AccessibleLabel: ="SAP Template Administrator app has been shared with administrators"
                    BasePaletteColor: =
                    CheckboxSize: =16
                    Checked: |-
                        =With(
                            {
                                _stepValue: LookUp(
                                    'Activity Step Values',
                                    'Control Name' = "CheckboxCanvas5_2"
                                ).Value
                            },
                            If(_stepValue = "true",true,false)
                        )
                    DisplayMode: |-
                        =If(
                            varDisableControls,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Font: =""
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    FontWeight: =""
                    Height: =32
                    Label: ="SAP Template Administrator app has been shared with administrators"
                    LayoutMinHeight: =32
                    LayoutMinWidth: =160
                    OnCheck: =false
                    OnUncheck: =false
                    Width: =160
                    X: =40
                    Y: =40
                    ZIndex: =3

            Container1_36 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =10
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Visible: =CurrentActivityStep.'Step Name' = "Review"
                ZIndex: =11

                ReviewCompletionSteps_7 As ReviewCompletionSteps:
                    FillPortions: =1
                    Height: =Parent.Height
                    LayoutMinHeight: =100
                    LayoutMinWidth: =100
                    Width: =Parent.Width
                    ZIndex: =3

            NavigationButtons_5 As NavigationButtons:
                LayoutMinHeight: =640
                LayoutMinWidth: =0
                StepStatus: |-
                    =If(
                        varSkip,
                        'Step Status (Activity Steps)'.Skipped,
                        Switch(
                            true,
                            Container1_29.Visible,
                            'Step Status (Activity Steps)'.Completed,
                            Container1_31.Visible,
                            If(
                                Or(
                                    CheckboxCanvas5_1.Checked = true,
                                    RadioGroupCanvas1_7.Selected.Value = 3
                                ),
                                'Step Status (Activity Steps)'.Completed,
                                'Step Status (Activity Steps)'.Incomplete
                            ),
                            Container1_74.Visible,
                            If(
                                Or(
                                    CheckboxCanvas5_13.Checked = true,
                                    RadioGroupCanvas1_10.Selected.Value = 3
                                ),
                                'Step Status (Activity Steps)'.Completed,
                                'Step Status (Activity Steps)'.Incomplete
                            ),
                            Container1_76.Visible,
                            If(
                                Or(
                                    CheckboxCanvas5_15.Checked = true,
                                    RadioGroupCanvas1_11.Selected.Value = 3
                                ),
                                'Step Status (Activity Steps)'.Completed,
                                'Step Status (Activity Steps)'.Incomplete
                            ),
                            Container1_77.Visible,
                            If(
                                Or(
                                    CheckboxCanvas5_19.Checked = true,
                                    RadioGroupCanvas1_12.Selected.Value = 3
                                ),
                                'Step Status (Activity Steps)'.Completed,
                                'Step Status (Activity Steps)'.Incomplete
                            ),
                            Container1_82.Visible,
                            If(
                                Or(
                                    CheckboxCanvas5_20.Checked = true,
                                    RadioGroupCanvas1_13.Selected.Value = 3
                                ),
                                'Step Status (Activity Steps)'.Completed,
                                'Step Status (Activity Steps)'.Incomplete
                            ),
                            Container1_83.Visible,
                            If(
                                Or(
                                    CheckboxCanvas5_21.Checked = true,
                                    RadioGroupCanvas1_14.Selected.Value = 3
                                ),
                                'Step Status (Activity Steps)'.Completed,
                                'Step Status (Activity Steps)'.Incomplete
                            ),
                            Container1_35.Visible,
                            If(
                                CheckboxCanvas5_2.Checked = true,
                                'Step Status (Activity Steps)'.Completed,
                                'Step Status (Activity Steps)'.Incomplete
                            )
                        )
                    )
                StepValues: |-
                    =Switch(
                        true,
                        Container1_31.Visible,
                        Table(
                            {
                                Control: "CheckboxCanvas5_1",
                                Value: Text(CheckboxCanvas5_1.Checked),
                                Type: 'Data Type (Activity Step Values)'.Boolean
                            },
                            {
                                Control: "RadioGroupCanvas1_7",
                                Value: Text(RadioGroupCanvas1_7.Selected.Value),
                                Type: 'Data Type (Activity Step Values)'.Number
                            }
                        ),
                        Container1_35.Visible,
                        Table(
                            {
                                Control: "CheckboxCanvas5_2",
                                Value: Text(CheckboxCanvas5_2.Checked),
                                Type: 'Data Type (Activity Step Values)'.Boolean
                            }
                        ),
                        Container1_74.Visible,
                        Table(
                            {
                                Control: "CheckboxCanvas5_13",
                                Value: Text(CheckboxCanvas5_13.Checked),
                                Type: 'Data Type (Activity Step Values)'.Boolean
                            },
                            {
                                Control: "RadioGroupCanvas1_10",
                                Value: Text(RadioGroupCanvas1_10.Selected.Value),
                                Type: 'Data Type (Activity Step Values)'.Number
                            }
                        ),
                        Container1_76.Visible,
                        Table(
                            {
                                Control: "CheckboxCanvas5_15",
                                Value: Text(CheckboxCanvas5_15.Checked),
                                Type: 'Data Type (Activity Step Values)'.Boolean
                            },
                            {
                                Control: "RadioGroupCanvas1_11",
                                Value: Text(RadioGroupCanvas1_11.Selected.Value),
                                Type: 'Data Type (Activity Step Values)'.Number
                            }
                        ),
                        Container1_77.Visible,
                        Table(
                            {
                                Control: "CheckboxCanvas5_19",
                                Value: Text(CheckboxCanvas5_19.Checked),
                                Type: 'Data Type (Activity Step Values)'.Boolean
                            },
                            {
                                Control: "RadioGroupCanvas1_12",
                                Value: Text(RadioGroupCanvas1_12.Selected.Value),
                                Type: 'Data Type (Activity Step Values)'.Number
                            }
                        ),
                        Container1_82.Visible,
                        Table(
                            {
                                Control: "CheckboxCanvas5_20",
                                Value: Text(CheckboxCanvas5_20.Checked),
                                Type: 'Data Type (Activity Step Values)'.Boolean
                            },
                            {
                                Control: "RadioGroupCanvas1_13",
                                Value: Text(RadioGroupCanvas1_13.Selected.Value),
                                Type: 'Data Type (Activity Step Values)'.Number
                            }
                        ),
                        Container1_83.Visible,
                        Table(
                            {
                                Control: "CheckboxCanvas5_21",
                                Value: Text(CheckboxCanvas5_21.Checked),
                                Type: 'Data Type (Activity Step Values)'.Boolean
                            },
                            {
                                Control: "RadioGroupCanvas1_14",
                                Value: Text(RadioGroupCanvas1_14.Selected.Value),
                                Type: 'Data Type (Activity Step Values)'.Number
                            }
                        )
                    )
                ZIndex: =12

        "icoConMainScreenExpand_6 As icon.'3DPrinting'":
            AccessibleLabel: ="Expand step detail"
            AlignInContainer: =AlignInContainer.Start
            BorderColor: =RGBA(0,0,0,0)
            Color: =Color.Black
            DisabledBorderColor: |-
                =ColorValue("#A19F9D")
            DisabledColor: |-
                =ColorValue("#F3F2F1")
            DisabledFill: =RGBA(0,0,0,0)
            DisplayMode: |-
                =If(
                    varDisableControls,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =RGBA(0,0,0,0)
            FocusedBorderColor: |-
                =ColorValue("#605E5C")
            Height: =48
            HoverBorderColor: =
            HoverColor: |-
                =ColorValue("#8A8886")
            HoverFill: =RGBA(0,0,0,0)
            Icon: =Icon.ListScrollEmpty
            OnSelect: |-
                =Set(
                    varExpandHelp,
                    false
                );
                Set(
                    varExpandMenu,
                    false
                )
            PaddingBottom: =10
            PaddingLeft: =12
            PaddingRight: =12
            PaddingTop: =10
            PressedBorderColor: =
            PressedColor: |-
                =ColorValue("#8A8886")
            PressedFill: =RGBA(0,0,0,0)
            TabIndex: =0
            Tooltip: ="Expand step detail"
            Visible: |-
                =And(
                    App.ActiveScreen.Size = ScreenSize.Small,
                    Or(
                        varExpandHelp,
                        varExpandMenu
                    )
                )
            Width: =48
            X: =Self.FocusedBorderThickness
            ZIndex: =3

        cmpHelpAssistant_10 As HelpResources:
            Height: =Parent.Height
            LayoutMinWidth: =640
            SetExpandHelp: =App.ActiveScreen.Size <= ScreenSize.Medium
            Width: =cmpHelpAssistant_10.HelpResourcesWidth
            X: =Parent.Width-Self.Width
            ZIndex: =4

