"'Sub Goals Screen' As screen":
    Fill: =Color.White
    LoadingSpinnerColor: =App.Theme.Colors.Primary
    OnVisible: |-
        =//Repeatable values for UI
        UpdateContext(
            {
                var_LayoutProperties: {
                    marginLarge: 32,
                    marginMedium: 16,
                    marginSmall: 8,
                    gapSmall: 8,
                    gapMedium: 16,
                    templateHeight: 130,
                    progressBar: {
                        height: 20,
                        width: 250
                    }
                }
            }
        )

    conSubgoalScreen_Background As groupContainer.verticalAutoLayoutContainer:
        Fill: =ColorValue(varTheme.neutralBackground2)
        Height: =Parent.Height - Self.Y
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =16
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        PaddingBottom: =Self.PaddingTop
        PaddingLeft: =Self.PaddingTop
        PaddingRight: =Self.PaddingTop
        PaddingTop: =var_LayoutProperties.marginLarge
        Width: =Parent.Width
        Y: =cmpSubgoalScreen_Header.Height + cmpSubgoalScreen_Header.Y
        ZIndex: =1

        conBodyHeading As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =txtGoal.Height + conBodyHeaderTitle.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =1

            txtGoal As Text:
                AutoHeight: =true
                BorderStyle: =""
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontColor: =
                FontItalic: =varThemeFont.H3.italic
                Height: =Self.Size * 1.8
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =14
                Text: =var_GoalRecord.Name
                VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                Weight: ='TextCanvas.Weight'.Regular
                Width: =Parent.Width
                Wrap: =true
                X: =0
                Y: =0
                ZIndex: =1

            conBodyHeaderTitle As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: |+
                    =If(
                        App.ActiveScreen.Size = ScreenSize.Small,
                        txtSubGoalTitleLarge.Height + btnCreateSubgoal.Height ,
                        txtSubGoalTitleLarge.Height 
                    )
                    
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutDirection: |-
                    =If(
                        App.ActiveScreen.Size = ScreenSize.Small,
                        LayoutDirection.Vertical,
                        LayoutDirection.Horizontal
                    )
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                ZIndex: =3

                txtSubGoalTitleLarge As Text:
                    AutoHeight: =false
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    FillPortions: |-
                        =If(
                            App.ActiveScreen.Size = ScreenSize.Small,
                            0,
                            1
                        )
                    Font: =""
                    FontColor: =
                    FontItalic: =varThemeFont.H3.italic
                    Height: =Self.Size * 1.5
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Size: =varThemeFont.H1.size
                    Text: ="Sub-goals"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                    Weight: =varThemeFont.H3.weightBold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =1

                btnCreateSubgoal As Button:
                    AccessibleLabel: ="Create a sub-goal"
                    Align: =""
                    AlignInContainer: |-
                        =
                        
                        If(
                            App.ActiveScreen.Size = ScreenSize.Small,
                            AlignInContainer.Start,
                            AlignInContainer.Center
                        )
                    BasePaletteColor: =
                    BorderStyle: =""
                    DisplayMode: =If(User().Email in Filter(Users, 'Users (Views)'.'Goal Tracking - Admin').'Primary Email', DisplayMode.Edit, DisplayMode.Disabled)
                    Font: =""
                    FontColor: =
                    FontItalic: =
                    FontSize: =0
                    FontWeight: =""
                    Height: =32
                    Icon: =""
                    IconRotation: =0
                    IconStyle: ="Outline"
                    Layout: ="Icon before"
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    OnSelect: |-
                        =Navigate('Subgoal Details Screen', Transition.None, {var_AssociatedGoal : var_GoalRecord,  var_SubgoalItem : Blank()})
                    Text: ="Create a sub-goal"
                    VerticalAlign: =""
                    Visible: =If(User().Email in Filter(Users, 'Users (Views)'.'Goal Tracking - Admin').'Primary Email', true, false)
                    Width: |-
                        =If(
                            App.ActiveScreen.Size = ScreenSize.Small,
                            Parent.Width,
                            150
                        )
                    X: =0
                    Y: =0
                    ZIndex: =2

        conSubgoalFilters As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.Semilight
            Fill: =ColorValue(varTheme.neutralBackground1)
            FillPortions: =0
            Height: |-
                =If(
                    App.ActiveScreen.Size = ScreenSize.Small,
                    cmbDepartments_SubgoalScreen.Height + cmbSponsors_SubgoalScreen.Height + Self.LayoutGap + Self.PaddingBottom + Self.PaddingTop,
                    48
                )
            LayoutDirection: =If(App.ActiveScreen.Size = ScreenSize.Small, LayoutDirection.Vertical, LayoutDirection.Horizontal)
            LayoutGap: =var_LayoutProperties.gapSmall
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =Self.PaddingTop
            PaddingLeft: =Self.PaddingTop
            PaddingRight: =Self.PaddingTop
            PaddingTop: =var_LayoutProperties.marginSmall
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =2

            cmbDepartments_SubgoalScreen As Combobox.pcfdataset:
                AccessibleLabel: ="Departments filter"
                Appearance: ="FilledDarker"
                BorderStyle: =""
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontItalic: =
                FontSize: =0
                FontWeight: =""
                Height: =32
                InputTextPlaceholder: ="All departments"
                Items: =Sort(Departments, Name, SortOrder.Ascending)
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                SelectMultiple: =true
                Width: |-
                    =If(
                        App.ActiveScreen.Size = ScreenSize.Small,
                        Parent.Width - Parent.PaddingTop - Parent.PaddingBottom,
                        App.ActiveScreen.Size = ScreenSize.Medium,
                        Parent.Width / 2 - Parent.LayoutGap,
                        320
                    )
                X: =0
                Y: =0
                ZIndex: =1

                lblDepartmentName As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                    FieldDisplayName: ="Name"
                    FieldName: ="mpa_name"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    ZIndex: =16

                lblDepartmentID As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                    FieldDisplayName: ="Department"
                    FieldName: ="mpa_itpm_departmentid"
                    FieldType: ="g"
                    FieldVariantName: ="textualColumn"
                    Order: =2
                    ZIndex: =17

            cmbSponsors_SubgoalScreen As Combobox.pcfdataset:
                AccessibleLabel: ="Sponsors filter"
                Appearance: ="FilledDarker"
                BorderStyle: =""
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontItalic: =
                FontSize: =0
                FontWeight: =""
                Height: =32
                InputTextPlaceholder: ="All sponsors"
                Items: |-
                    =Filter(Sort(Users, 'Full Name', SortOrder.Ascending), !StartsWith('Full Name', "#"))
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                SelectMultiple: =true
                Width: |-
                    =If(
                        App.ActiveScreen.Size = ScreenSize.Small,
                        Parent.Width - Parent.PaddingTop - Parent.PaddingBottom,
                        App.ActiveScreen.Size = ScreenSize.Medium,
                        Parent.Width / 2 - Parent.LayoutGap,
                        320
                    )
                X: =0
                Y: =0
                ZIndex: =2

                lblFullName As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                    FieldDisplayName: ="Full Name"
                    FieldName: ="fullname"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =3
                    ZIndex: =20

                lblUserID As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                    FieldDisplayName: ="User"
                    FieldName: ="systemuserid"
                    FieldType: ="g"
                    FieldVariantName: ="textualColumn"
                    Order: =6
                    ZIndex: =23

                lblPrimaryEmail As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                    FieldDisplayName: ="Primary Email"
                    FieldName: ="internalemailaddress"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =3
                    ZIndex: =24

        conSubgoalList As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.Semilight
            Fill: =ColorValue(varTheme.neutralBackground1)
            FillPortions: =0
            Height: =galSubgoalList.Height + conSubgoalListFooter.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =3

            galSubgoalList As gallery.variableTemplateHeightGallery:
                AccessibleLabel: ="Subgoals"
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =App.Theme.Colors.Darker40
                DelayItemLoading: =true
                DisplayMode: =If(Self.Visible, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: =ColorValue(varTheme.neutralBackground1)
                FillPortions: =0
                Height: =App.ActiveScreen.Height - cmpSubgoalScreen_Header.Height - (txtGoal.Height + conBodyHeaderTitle.Height) - If(App.ActiveScreen.Size = ScreenSize.Small, 0 , Parent.Y)
                Items: |-
                    =//Filter the Subgoals by Goal, Department and Owner
                    Sort(
                        Filter(
                            Subgoals,
                            Goal.'Goal Id' = var_GoalRecord.'Goal Id',
                            Department.Department in cmbDepartments_SubgoalScreen.SelectedItems.Department || IsEmpty(cmbDepartments_SubgoalScreen.SelectedItems.Department),
                            AsType(
                                Owner,
                                Users
                            ).User in cmbSponsors_SubgoalScreen.SelectedItems.User || IsEmpty(cmbSponsors_SubgoalScreen.SelectedItems.User)
                        ),
                        Name
                    )
                Layout: =Layout.Vertical
                LayoutMinHeight: =287
                LayoutMinWidth: =320
                LoadingSpinner: =LoadingSpinner.Data
                TabIndex: =If(Self.DisplayMode = DisplayMode.Edit, -1,0)
                TemplatePadding: =0
                TemplateSize: =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge, 130, txtSubgoalName.Height + txtCompany.Height + txtTask.Height + txtSponsor.Height + prgSubgoal.Height)
                Visible: =If(Self.AllItemsCount > 0, true, false)
                Width: =Parent.Width
                ZIndex: =1

                shpSubgoalGallerySeparator As rectangle:
                    BorderColor: =App.Theme.Colors.Darker40
                    Fill: =ColorValue(varTheme.neutralStroke2)
                    Height: =1
                    Width: =Parent.TemplateWidth
                    Y: =btnView.Height + btnView.Y + var_LayoutProperties.gapSmall
                    ZIndex: =1

                btnUpdate As Button:
                    AccessibleLabel: =$"Update {ThisItem.Name} sub goal"
                    Align: =""
                    Appearance: ='ButtonCanvas.Appearance'.Secondary
                    BasePaletteColor: =
                    BorderStyle: =""
                    DisplayMode: =If(User().Email in Filter(Users, 'Users (Views)'.'Goal Tracking - Admin').'Primary Email', DisplayMode.Edit, DisplayMode.Disabled)
                    Font: =""
                    FontColor: =
                    FontItalic: =
                    FontSize: =0
                    FontWeight: =""
                    Height: =32
                    Icon: =""
                    IconRotation: =0
                    IconStyle: ="Outline"
                    Layout: ="Icon before"
                    OnSelect: |-
                        =Navigate('Subgoal Details Screen', Transition.None, {var_ScreenMode: "Update", var_SubgoalItem : ThisItem})
                    Text: ="Update"
                    VerticalAlign: =""
                    Visible: =If(User().Email in Filter(Users, 'Users (Views)'.'Goal Tracking - Admin').'Primary Email', true, false)
                    Width: =If(App.ActiveScreen.Size = ScreenSize.Small, Parent.Width / 2 - var_LayoutProperties.gapMedium, 71)
                    X: =btnView.X + btnView.Width + 16
                    Y: |
                        =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge, txtTask.Height + txtTask.Y + 16, 
                            App.ActiveScreen.Size = ScreenSize.Large, txtCompany.Height + txtCompany.Y + 16,
                            txtPercentage.Height + txtPercentage.Y + 16)
                    ZIndex: =2

                btnView As Button:
                    AccessibleLabel: =$"View {ThisItem.Name} sub goal"
                    Align: =""
                    Appearance: ='ButtonCanvas.Appearance'.Secondary
                    BasePaletteColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Font: =""
                    FontColor: =
                    FontItalic: =
                    FontSize: =0
                    FontWeight: =""
                    Height: =32
                    Icon: =""
                    IconRotation: =0
                    IconStyle: ="Outline"
                    Layout: ="Icon before"
                    OnSelect: |
                        =Set(varSelectedSubgoal,ThisItem);
                        Set(varIsAllTasks, false);
                        Navigate('Tasks Screen');
                    Text: ="View"
                    VerticalAlign: =""
                    Width: =If(App.ActiveScreen.Size = ScreenSize.Small, Parent.Width / 2 - var_LayoutProperties.gapMedium - Self.X, 55)
                    X: =var_LayoutProperties.marginMedium
                    Y: |-
                        =Switch(
                            App.ActiveScreen.Size,
                            ScreenSize.ExtraLarge,
                            txtTask.Height + txtTask.Y + var_LayoutProperties.marginMedium,
                            ScreenSize.Large,
                            txtCompany.Height + txtCompany.Y + var_LayoutProperties.marginMedium,
                            txtPercentage.Height + txtPercentage.Y + var_LayoutProperties.marginMedium
                        )
                    ZIndex: =3

                txtPercentage As Text:
                    AutoHeight: =true
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Font: =""
                    FontColor: =
                    FontItalic: =varThemeFont.H3.italic
                    Height: =Self.Size * 1.8
                    Size: =
                    Text: =$"{Text(RoundUp(prgSubgoal.Value, 2))} %"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                    Weight: ='TextCanvas.Weight'.Regular
                    Width: =prgSubgoal.Width
                    Wrap: =false
                    X: |-
                        =If(
                            App.ActiveScreen.Size = ScreenSize.ExtraLarge || App.ActiveScreen.Size = ScreenSize.Large,
                            txtCompany.Width + txtCompany.X,
                            var_LayoutProperties.marginMedium
                        )
                    Y: =prgSubgoal.Height + prgSubgoal.Y + var_LayoutProperties.marginSmall
                    ZIndex: =4

                txtCompany As Text:
                    AutoHeight: =true
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Font: =""
                    FontColor: =
                    FontItalic: =varThemeFont.H3.italic
                    Height: =0
                    Size: =
                    Text: =ThisItem.Department.Name
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                    Weight: ='TextCanvas.Weight'.Regular
                    Width: |-
                        =
                        
                        If(App.ActiveScreen.Size = ScreenSize.ExtraLarge ||App.ActiveScreen.Size = ScreenSize.Large, Parent.Width - Self.X - txtPercentage.Width - 16, Parent.Width - Self.X - 32)
                    X: |-
                        =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge, 
                        txtSponsor.X + txtSponsor.Width, 16)
                    Y: |-
                        =If(
                            App.ActiveScreen.Size = ScreenSize.ExtraLarge,
                            txtSubgoalName.Height + txtSubgoalName.Y + var_LayoutProperties.gapSmall,
                            Or(
                                App.ActiveScreen.Size = ScreenSize.Medium,
                                App.ActiveScreen.Size = ScreenSize.Large
                            ),
                            txtTask.Height + txtTask.Y + var_LayoutProperties.gapSmall,
                            txtSponsor.Height + txtSponsor.Y + var_LayoutProperties.gapSmall
                        )
                    ZIndex: =5

                txtSponsor As Text:
                    AutoHeight: =true
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Font: =""
                    FontColor: =
                    FontItalic: =varThemeFont.H3.italic
                    Height: =Len(Self.Text) * Self.Size * Self.Width
                    Size: =14
                    Text: =ThisItem.'Owning User'.'Full Name'
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                    Weight: ='TextCanvas.Weight'.Regular
                    Width: |-
                        =If(
                            App.ActiveScreen.Size = ScreenSize.ExtraLarge || App.ActiveScreen.Size = ScreenSize.Large,
                            Self.X,
                            Parent.Width - Self.X - 32
                        )
                    Wrap: =true
                    X: |-
                        =
                        
                        If(Or(App.ActiveScreen.Size = ScreenSize.ExtraLarge, App.ActiveScreen.Size = ScreenSize.Large, App.ActiveScreen.Size = ScreenSize.Medium), 
                        txtTask.X + txtTask.Width, 16)
                    Y: |-
                        =If(
                            Or(
                                App.ActiveScreen.Size = ScreenSize.ExtraLarge,
                                App.ActiveScreen.Size = ScreenSize.Large,
                                App.ActiveScreen.Size = ScreenSize.Medium
                            ),
                            txtSubgoalName.Height + txtSubgoalName.Y + var_LayoutProperties.marginSmall,
                            txtTask.Height + txtTask.Y + var_LayoutProperties.marginSmall
                        )
                    ZIndex: =6

                txtTask As Text:
                    AutoHeight: =false
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Font: =""
                    FontColor: =
                    FontItalic: =varThemeFont.H3.italic
                    Height: =txtSponsor.Height
                    Size: =14
                    Text: |-
                        =$"{CountRows(
                            Filter(
                                Tasks,
                                AsType(
                                    Regarding,
                                    Subgoals
                                ).'Subgoal Id' = ThisItem.'Subgoal Id'
                            )
                        )} Tasks"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                    Weight: ='TextCanvas.Weight'.Regular
                    Width: =var_LayoutProperties.progressBar.width - 100
                    X: =var_LayoutProperties.marginMedium
                    Y: =txtSubgoalName.Height + txtSubgoalName.Y + var_LayoutProperties.marginSmall
                    ZIndex: =7

                "prgSubgoal As 'Progress Bar'":
                    AccessibleLabel: =$"Subgoal {ThisItem.Name} progress at {Text(RoundUp(Self.Value, 2))} %"
                    BasePaletteColor: =
                    DisplayMode: =DisplayMode.Edit
                    Height: =var_LayoutProperties.progressBar.height
                    Indeterminate: =false
                    ProgressColor: |-
                        =If(ThisItem.Progress < Self.Max,
                        'Progress.ProgressColor'.Brand,
                        'Progress.ProgressColor'.Success)
                    Thickness: ='Progress.Thickness'.Large
                    Value: |-
                        =//Coalesce(Average(Filter(Tasks, Subgoal.'Subgoal Id' = ThisItem.'Subgoal Id'), Progress), 0)
                        Coalesce(ThisItem.Progress, 0)
                    Width: =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge || App.ActiveScreen.Size = ScreenSize.Large, var_LayoutProperties.progressBar.width, Parent.Width - var_LayoutProperties.marginLarge)
                    X: =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge ||App.ActiveScreen.Size = ScreenSize.Large, Parent.Width - Self.Width - 16, 16)
                    Y: =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge || App.ActiveScreen.Size = ScreenSize.Large, 16, txtCompany.Height + txtCompany.Y + 8)
                    ZIndex: =8

                txtSubgoalName As Text:
                    AutoHeight: =true
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Font: =""
                    FontColor: =
                    FontItalic: =varThemeFont.H3.italic
                    Height: =Len(Self.Text) * Self.Size * Self.Width
                    Size: =14
                    Text: =ThisItem.Name
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                    Weight: ='TextCanvas.Weight'.Semibold
                    Width: |-
                        =If(
                            App.ActiveScreen.Size = ScreenSize.ExtraLarge ||  App.ActiveScreen.Size = ScreenSize.Large,
                            Parent.Width - Self.X - var_LayoutProperties.marginMedium- prgSubgoal.Width,
                            Parent.Width - Self.X - var_LayoutProperties.marginLarge
                        )
                    X: =var_LayoutProperties.marginMedium
                    Y: =var_LayoutProperties.marginMedium
                    ZIndex: =9

            conSubgoalListNoData As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =ColorValue(varTheme.neutralBackground1)
                FillPortions: =0
                Height: =If(Self.Visible, Parent.Height - conSubgoalListFooter.Height  , 0)
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =9
                RadiusBottomRight: =9
                RadiusTopLeft: =9
                RadiusTopRight: =9
                Visible: =If(galSubgoalList.AllItemsCount > 0, false, true)
                Width: =Parent.Width
                ZIndex: =2

                txtSubgoalNodata As Text:
                    Align: ='TextCanvas.Align'.Center
                    AutoHeight: =false
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Font: =""
                    FontColor: =
                    FontItalic: =varThemeFont.H3.italic
                    Height: =50
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Size: =
                    Text: ="There are no sub-goals yet."
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                    Visible: =Parent.Visible
                    Weight: ='TextCanvas.Weight'.Regular
                    Width: =Parent.Width
                    Wrap: =false
                    X: =0
                    Y: =0
                    ZIndex: =1

            shpListFooterSeparator As rectangle:
                BorderColor: =App.Theme.Colors.Darker40
                DisplayMode: =DisplayMode.View
                Fill: =ColorValue(varTheme.neutralStroke2)
                Height: =1
                Width: =Parent.Width
                Y: =btnView.Height + btnView.Y
                ZIndex: =3

            conSubgoalListFooter As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =ColorValue(varTheme.neutralBackground1)
                FillPortions: =0
                Height: =40
                LayoutAlignItems: =LayoutAlignItems.End
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =20
                PaddingRight: =20
                PaddingTop: =10
                ZIndex: =4

                txtFooterRowCount As Text:
                    AutoHeight: =true
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Font: =""
                    FontColor: =
                    FontItalic: =varThemeFont.H3.italic
                    Height: =Self.Size * 1.8
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Size: =14
                    Text: |-
                        =$"Rows: {galSubgoalList.AllItemsCount}"
                    VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                    Weight: ='TextCanvas.Weight'.Regular
                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                    X: =0
                    Y: =0
                    ZIndex: =1

            conSubgoalList_1 As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.Semilight
                Fill: =ColorValue(varTheme.neutralBackground1)
                FillPortions: =0
                Height: =galSubgoalList_1.Height + conSubgoalListFooter_1.Height
                LayoutDirection: =LayoutDirection.Vertical
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMinHeight: =
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                ZIndex: =5

                galSubgoalList_1 As gallery.variableTemplateHeightGallery:
                    AccessibleLabel: ="Subgoals"
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =App.Theme.Colors.Darker40
                    DelayItemLoading: =true
                    DisplayMode: =If(Self.Visible, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: =ColorValue(varTheme.neutralBackground1)
                    FillPortions: =0
                    Height: =App.ActiveScreen.Height - cmpSubgoalScreen_Header.Height - (txtGoal.Height + conBodyHeaderTitle.Height) - If(App.ActiveScreen.Size = ScreenSize.Small, 0 , Parent.Y)
                    Items: |-
                        =//Filter the Subgoals by Goal, Department and Owner
                        Sort(
                            Filter(
                                Subgoals,
                                Goal.'Goal Id' = var_GoalRecord.'Goal Id',
                                Department.Department in cmbDepartments_SubgoalScreen.SelectedItems.Department || IsEmpty(cmbDepartments_SubgoalScreen.SelectedItems.Department),
                                AsType(
                                    Owner,
                                    Users
                                ).User in cmbSponsors_SubgoalScreen.SelectedItems.User || IsEmpty(cmbSponsors_SubgoalScreen.SelectedItems.User)
                            ),
                            Name
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =287
                    LayoutMinWidth: =320
                    LoadingSpinner: =LoadingSpinner.Data
                    TabIndex: =If(Self.DisplayMode = DisplayMode.Edit, -1,0)
                    TemplatePadding: =0
                    TemplateSize: =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge, 130, txtSubgoalName_1.Height + txtCompany_1.Height + txtTask_1.Height + txtSponsor_1.Height + prgSubgoal_1.Height)
                    Visible: =If(Self.AllItemsCount > 0, true, false)
                    Width: =Parent.Width
                    ZIndex: =1

                    shpSubgoalGallerySeparator_1 As rectangle:
                        BorderColor: =App.Theme.Colors.Darker40
                        Fill: =ColorValue(varTheme.neutralStroke2)
                        Height: =1
                        Width: =Parent.TemplateWidth
                        Y: =129
                        ZIndex: =1

                    btnUpdate_1 As Button:
                        AccessibleLabel: =$"Update {ThisItem.Name} sub goal"
                        Align: =""
                        Appearance: ='ButtonCanvas.Appearance'.Secondary
                        BasePaletteColor: =
                        BorderStyle: =""
                        DisplayMode: =If(User().Email in Filter(Users, 'Users (Views)'.'Goal Tracking - Admin').'Primary Email', DisplayMode.Edit, DisplayMode.Disabled)
                        Font: =""
                        FontColor: =
                        FontItalic: =
                        FontSize: =0
                        FontWeight: =""
                        Height: =32
                        Icon: =""
                        IconRotation: =0
                        IconStyle: ="Outline"
                        Layout: ="Icon before"
                        OnSelect: |-
                            =Navigate('Subgoal Details Screen', Transition.None, {var_ScreenMode: "Update", var_SubgoalItem : ThisItem})
                        Text: ="Update"
                        VerticalAlign: =""
                        Visible: =If(User().Email in Filter(Users, 'Users (Views)'.'Goal Tracking - Admin').'Primary Email', true, false)
                        Width: =If(App.ActiveScreen.Size = ScreenSize.Small, Parent.Width / 2 - var_LayoutProperties.gapMedium, 71)
                        X: =btnView_1.X + btnView_1.Width + 16
                        Y: =98
                        ZIndex: =2

                    btnView_1 As Button:
                        AccessibleLabel: =$"View {ThisItem.Name} sub goal"
                        Align: =""
                        Appearance: ='ButtonCanvas.Appearance'.Secondary
                        BasePaletteColor: =
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Font: =""
                        FontColor: =
                        FontItalic: =
                        FontSize: =0
                        FontWeight: =""
                        Height: =32
                        Icon: =""
                        IconRotation: =0
                        IconStyle: ="Outline"
                        Layout: ="Icon before"
                        OnSelect: |
                            =Set(varSelectedSubgoal,ThisItem);
                            Set(varIsAllTasks, false);
                            Navigate('Tasks Screen');
                        Text: ="View"
                        VerticalAlign: =""
                        Width: =If(App.ActiveScreen.Size = ScreenSize.Small, Parent.Width / 2 - var_LayoutProperties.gapMedium - Self.X, 55)
                        X: =var_LayoutProperties.marginMedium
                        Y: =98
                        ZIndex: =3

                    txtPercentage_1 As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Font: =""
                        FontColor: =
                        FontItalic: =varThemeFont.H3.italic
                        Height: =Self.Size * 1.8
                        Size: =
                        Text: =$"{Text(RoundUp(prgSubgoal_1.Value, 2))} %"
                        VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                        Weight: ='TextCanvas.Weight'.Regular
                        Width: =prgSubgoal_1.Width
                        Wrap: =false
                        X: |-
                            =If(
                                App.ActiveScreen.Size = ScreenSize.ExtraLarge || App.ActiveScreen.Size = ScreenSize.Large,
                                txtCompany_1.Width + txtCompany_1.X,
                                var_LayoutProperties.marginMedium
                            )
                        Y: =prgSubgoal_1.Height + prgSubgoal_1.Y + var_LayoutProperties.marginSmall
                        ZIndex: =4

                    txtCompany_1 As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Font: =""
                        FontColor: =
                        FontItalic: =varThemeFont.H3.italic
                        Height: =0
                        Size: =
                        Text: =ThisItem.Department.Name
                        VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                        Weight: ='TextCanvas.Weight'.Regular
                        Width: |-
                            =
                            
                            If(App.ActiveScreen.Size = ScreenSize.ExtraLarge ||App.ActiveScreen.Size = ScreenSize.Large, Parent.Width - Self.X - txtPercentage_1.Width - 16, Parent.Width - Self.X - 32)
                        X: |-
                            =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge, 
                            txtSponsor_1.X + txtSponsor_1.Width, 16)
                        Y: =130
                        ZIndex: =5

                    txtSponsor_1 As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Font: =""
                        FontColor: =
                        FontItalic: =varThemeFont.H3.italic
                        Height: =Len(Self.Text) * Self.Size * Self.Width
                        Size: =14
                        Text: =ThisItem.'Owning User'.'Full Name'
                        VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                        Weight: ='TextCanvas.Weight'.Regular
                        Width: |-
                            =If(
                                App.ActiveScreen.Size = ScreenSize.ExtraLarge || App.ActiveScreen.Size = ScreenSize.Large,
                                Self.X,
                                Parent.Width - Self.X - 32
                            )
                        Wrap: =true
                        X: |-
                            =
                            
                            If(Or(App.ActiveScreen.Size = ScreenSize.ExtraLarge, App.ActiveScreen.Size = ScreenSize.Large, App.ActiveScreen.Size = ScreenSize.Medium), 
                            txtTask_1.X + txtTask_1.Width, 16)
                        Y: =0
                        ZIndex: =6

                    txtTask_1 As Text:
                        AutoHeight: =false
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Font: =""
                        FontColor: =
                        FontItalic: =varThemeFont.H3.italic
                        Height: =txtSponsor_1.Height
                        Size: =14
                        Text: |-
                            =$"{CountRows(
                                Filter(
                                    Tasks,
                                    AsType(
                                        Regarding,
                                        Subgoals
                                    ).'Subgoal Id' = ThisItem.'Subgoal Id'
                                )
                            )} Tasks"
                        VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                        Weight: ='TextCanvas.Weight'.Regular
                        Width: =var_LayoutProperties.progressBar.width - 100
                        X: =var_LayoutProperties.marginMedium
                        Y: =0
                        ZIndex: =7

                    "prgSubgoal_1 As 'Progress Bar'":
                        AccessibleLabel: =$"Subgoal {ThisItem.Name} progress at {Text(RoundUp(Self.Value, 2))} %"
                        BasePaletteColor: =
                        DisplayMode: =DisplayMode.Edit
                        Height: =var_LayoutProperties.progressBar.height
                        Indeterminate: =false
                        ProgressColor: |-
                            =If(ThisItem.Progress < Self.Max,
                            'Progress.ProgressColor'.Brand,
                            'Progress.ProgressColor'.Success)
                        Thickness: ='Progress.Thickness'.Large
                        Value: |-
                            =//Coalesce(Average(Filter(Tasks, Subgoal.'Subgoal Id' = ThisItem.'Subgoal Id'), Progress), 0)
                            Coalesce(ThisItem.Progress, 0)
                        Width: =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge || App.ActiveScreen.Size = ScreenSize.Large, var_LayoutProperties.progressBar.width, Parent.Width - var_LayoutProperties.marginLarge)
                        X: =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge ||App.ActiveScreen.Size = ScreenSize.Large, Parent.Width - Self.Width - 16, 16)
                        Y: =If(App.ActiveScreen.Size = ScreenSize.ExtraLarge || App.ActiveScreen.Size = ScreenSize.Large, 16, txtCompany_1.Height + txtCompany_1.Y + 8)
                        ZIndex: =8

                    txtSubgoalName_1 As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Font: =""
                        FontColor: =
                        FontItalic: =varThemeFont.H3.italic
                        Height: =Len(Self.Text) * Self.Size * Self.Width
                        Size: =14
                        Text: =ThisItem.Name
                        VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: |-
                            =If(
                                App.ActiveScreen.Size = ScreenSize.ExtraLarge ||  App.ActiveScreen.Size = ScreenSize.Large,
                                Parent.Width - Self.X - var_LayoutProperties.marginMedium- prgSubgoal_1.Width,
                                Parent.Width - Self.X - var_LayoutProperties.marginLarge
                            )
                        X: =var_LayoutProperties.marginMedium
                        Y: =0
                        ZIndex: =9

                conSubgoalListNoData_1 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =ColorValue(varTheme.neutralBackground1)
                    FillPortions: =0
                    Height: =If(Self.Visible, Parent.Height - conSubgoalListFooter_1.Height  , 0)
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    RadiusBottomLeft: =9
                    RadiusBottomRight: =9
                    RadiusTopLeft: =9
                    RadiusTopRight: =9
                    Visible: =If(galSubgoalList_1.AllItemsCount > 0, false, true)
                    Width: =Parent.Width
                    ZIndex: =2

                    txtSubgoalNodata_1 As Text:
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =false
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Font: =""
                        FontColor: =
                        FontItalic: =varThemeFont.H3.italic
                        Height: =50
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Size: =
                        Text: ="There are no sub-goals yet."
                        VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                        Visible: =Parent.Visible
                        Weight: ='TextCanvas.Weight'.Regular
                        Width: =Parent.Width
                        Wrap: =false
                        X: =0
                        Y: =0
                        ZIndex: =1

                shpListFooterSeparator_1 As rectangle:
                    BorderColor: =App.Theme.Colors.Darker40
                    DisplayMode: =DisplayMode.View
                    Fill: =ColorValue(varTheme.neutralStroke2)
                    Height: =1
                    Width: =Parent.Width
                    Y: =btnView_1.Height + btnView_1.Y
                    ZIndex: =3

                conSubgoalListFooter_1 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =ColorValue(varTheme.neutralBackground1)
                    FillPortions: =0
                    Height: =40
                    LayoutAlignItems: =LayoutAlignItems.End
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    PaddingLeft: =20
                    PaddingRight: =20
                    PaddingTop: =10
                    ZIndex: =4

                    txtFooterRowCount_1 As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Font: =""
                        FontColor: =
                        FontItalic: =varThemeFont.H3.italic
                        Height: =Self.Size * 1.8
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Size: =14
                        Text: |-
                            =$"Rows: {galSubgoalList_1.AllItemsCount}"
                        VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                        Weight: ='TextCanvas.Weight'.Regular
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        X: =0
                        Y: =0
                        ZIndex: =1

        conSubgoalPaddingBottom As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =If(App.ActiveScreen.Size = ScreenSize.Small, 16, 0)
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            ZIndex: =4

    cmpSubgoalScreen_Header As compHeaderCompound:
        HeaderWidth: =Parent.Width
        NavigateMenu: ='Goals Screen'
        Width: =cmpSubgoalScreen_Header.HeaderWidth
        ZIndex: =2

