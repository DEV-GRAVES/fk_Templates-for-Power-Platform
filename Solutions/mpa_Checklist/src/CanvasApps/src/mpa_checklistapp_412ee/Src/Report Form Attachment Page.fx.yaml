"'Report Form Attachment Page' As screen":
    OnVisible: |-
        =//Reset Data
        Reset(btnUploadFile_ReportFormAttachment);
        Reset(txtComments_ReportFormAttachment);
        Reset(cmbStepStatus_ReportFormAttachment);
        Reset(drpSubStep_ReportFormAttachment);
        Set(varDisabled , false);
        
        UpdateContext(
            {
                _LayoutProperties:
                {
                    outerPadding: {top: 40, right: 40, bottom: 40, left: 40},
                    innerPadding: {top: 20, right: 20, bottom: 20, left: 20},
                    labelPadding: {top: 5, right: 5, bottom: 5, left: 5}
                }
            }
        );

    conMain_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =ColorValue(varThemeColors.background)
        Height: =Parent.Height - compHeader_ReportFormAttachment.Height 
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        PaddingBottom: =Self.PaddingTop
        PaddingLeft: |-
            =If(
                App.ActiveScreen.Size < 4,
                _LayoutProperties.outerPadding.top / 5,
                _LayoutProperties.outerPadding.top
            )
        PaddingRight: =Self.PaddingLeft
        PaddingTop: |-
            =If(
                App.ActiveScreen.Size < 4,
                _LayoutProperties.outerPadding.top / 5,
                _LayoutProperties.outerPadding.top / 2
            )
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =Parent.Width
        Y: =compHeader_ReportFormAttachment.Y + compHeader_ReportFormAttachment.Height
        ZIndex: =1

        conBody_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: =Parent.Height - Parent.PaddingTop - Parent.PaddingBottom
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width - Parent.PaddingLeft -Parent.PaddingRight
            ZIndex: =2

            conUpper_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =conRightUpper_ReportFormAttachment.Height  + conLeftUpper_ReportFormAttachment.Height
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =150
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutWrap: =true
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =Parent.Width
                ZIndex: =1

                conLeftUpper_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =lblTemplateName_ReportFormAttachment.Height + lblTemplateDesc_ReportFormAttachment.Height + (Self.LayoutGap *2)
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =5
                    LayoutMinHeight: =150
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =2
                    PaddingRight: =If(App.ActiveScreen.Size < ScreenSize.ExtraLarge, 20, 0)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =Parent.Width
                    ZIndex: =1

                    lblTemplateName_ReportFormAttachment As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =ColorValue(varThemeColors.text)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                        FocusedBorderThickness: =4
                        Font: =varThemeFont.H1.face
                        FontWeight: =varThemeFont.H1.weightBold
                        Height: =
                        Italic: =varThemeFont.H1.italic
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading1
                        Size: |
                            =varThemeFont.H1.size
                        Text: =varSelectedReport.Name
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        ZIndex: =1

                    lblTemplateDesc_ReportFormAttachment As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =ColorValue(varThemeColors.text)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                        FocusedBorderThickness: =4
                        Font: =varThemeFont.B1.face
                        FontWeight: =varThemeFont.B1.weight
                        Height: =
                        Italic: =varThemeFont.B1.italic
                        PaddingBottom: =10
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =varThemeFont.B1.size
                        Text: =varTemplate.Description
                        VerticalAlign: =VerticalAlign.Top
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        Y: =
                        ZIndex: =2

                conRightUpper_ReportFormAttachment As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: |-
                        =If(App.ActiveScreen.Size < ScreenSize.Large, conDateModel_ReportFormAttachment.Height + conNumberTech_ReportFormAttachment.Height + conViewManual_ReportFormAttachment.Height,
                        conDateCreated_ReportFormAttachment.Height)
                    LayoutDirection: =If(App.ActiveScreen.Size < ScreenSize.Large, LayoutDirection.Vertical, LayoutDirection.Horizontal)
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: |-
                        =Switch(App.ActiveScreen.Size,
                        ScreenSize.Large, Parent.Width *.9,
                        ScreenSize.Medium, Parent.Width,
                        ScreenSize.Small, Parent.Width,
                        Parent.Width * .8)
                    ZIndex: =2

                    conDateModel_ReportFormAttachment As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =If(App.ActiveScreen.Size < ScreenSize.Medium, conDateCreated_ReportFormAttachment.Height * 2, conDateCreated_ReportFormAttachment.Height)
                        LayoutDirection: =If(App.ActiveScreen.Size < ScreenSize.Medium, LayoutDirection.Vertical, LayoutDirection.Horizontal)
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =If(App.ActiveScreen.Size <3, Parent.Width, Parent.Width *.4)
                        ZIndex: =1

                        conDateCreated_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =lblDateCreatedTitle_ReportFormAttachment.Height + lblDateCreatedValue_ReportFormAttachment.Height
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =50
                            LayoutMode: =LayoutMode.Auto
                            PaddingTop: =
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =If(App.ActiveScreen.Size = 1, Parent.Width, Parent.Width *.5)
                            ZIndex: =1

                            lblDateCreatedTitle_ReportFormAttachment As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =4
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weightBold
                                Height: =
                                Italic: =varThemeFont.B2.italic
                                PaddingBottom: =10
                                PaddingLeft: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: ="Date created"
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Y: =
                                ZIndex: =1

                            lblDateCreatedValue_ReportFormAttachment As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =4
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weight
                                Height: =
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =10
                                PaddingLeft: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: |
                                    =Text(varSelectedReport.'Created On', "mm/dd/yyyy")
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Wrap: =false
                                Y: =
                                ZIndex: =2

                        conTransimissionModel_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =conDateCreated_ReportFormAttachment.Height
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =50
                            LayoutMode: =LayoutMode.Auto
                            PaddingTop: =
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =conDateCreated_ReportFormAttachment.Width
                            ZIndex: =2

                            lblChecklistItemTitle_ReportFormAttachment As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =4
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weightBold
                                Height: =lblDateCreatedTitle_ReportFormAttachment.Height
                                Italic: =varThemeFont.B2.italic
                                PaddingBottom: =10
                                PaddingLeft: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: ="Checklist item"
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Y: =
                                ZIndex: =1

                            lblChecklistItemValue_ReportFormAttachment As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =4
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weight
                                Height: =lblDateCreatedValue_ReportFormAttachment.Height
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =10
                                PaddingLeft: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: |
                                    =varSelectedReport.'Checklist Item'.Name
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Wrap: =false
                                Y: =
                                ZIndex: =2

                    conNumberTech_ReportFormAttachment As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =conDateModel_ReportFormAttachment.Height
                        LayoutDirection: =If(App.ActiveScreen.Size < ScreenSize.Medium, LayoutDirection.Vertical, LayoutDirection.Horizontal)
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =conDateModel_ReportFormAttachment.Width
                        ZIndex: =2

                        conReportNumber_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =conDateCreated_ReportFormAttachment.Height
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =50
                            LayoutMode: =LayoutMode.Auto
                            PaddingTop: =
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =conDateCreated_ReportFormAttachment.Width
                            ZIndex: =1

                            lblReportNumber_ReportFormAttachment As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =4
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weightBold
                                Height: =lblDateCreatedTitle_ReportFormAttachment.Height
                                Italic: =varThemeFont.B2.italic
                                PaddingBottom: =10
                                PaddingLeft: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: ="Report number"
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Y: =
                                ZIndex: =1

                            lblReportNumberValue_ReportFormAttachment As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =4
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weight
                                Height: =lblDateCreatedValue_ReportFormAttachment.Height
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =10
                                PaddingLeft: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: =varSelectedReport.'Report Number'
                                Tooltip: =//varReportItem.'Report Number'
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Wrap: =false
                                Y: =
                                ZIndex: =2

                        conTestLabTechnician_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =conDateCreated_ReportFormAttachment.Height
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =50
                            LayoutMode: =LayoutMode.Auto
                            PaddingTop: =
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =conDateCreated_ReportFormAttachment.Width
                            ZIndex: =2

                            lblSubmitterTitle_ReportFormAttachment As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =4
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weightBold
                                Height: =lblDateCreatedTitle_ReportFormAttachment.Height
                                Italic: =varThemeFont.B2.italic
                                PaddingBottom: =10
                                PaddingLeft: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: ="Submitter"
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Y: =
                                ZIndex: =1

                            lblSubmitterValue_ReportFormAttachment As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =4
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weight
                                Height: =lblDateCreatedValue_ReportFormAttachment.Height
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =10
                                PaddingLeft: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: =varSelectedReport.'Created By'.'Full Name'
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Wrap: =false
                                Y: =
                                ZIndex: =2

                    conViewManual_ReportFormAttachment As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =If(App.ActiveScreen.Size < ScreenSize.Large, conDateCreated_ReportFormAttachment.Height *.6, conDateModel_ReportFormAttachment.Height)
                        LayoutAlignItems: =LayoutAlignItems.End
                        LayoutMinHeight: =20
                        LayoutMinWidth: =50
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =If(App.ActiveScreen.Size < ScreenSize.Large, 0, 30)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =conDateCreated_ReportFormAttachment.Width
                        ZIndex: =3

                        btnNewReportEditStep_ViewManual_ReportFormAttachment As button:
                            Align: =Align.Left
                            BorderThickness: =0
                            Color: =ColorValue(varThemeColors.text)
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =varThemeColors.focusBorderThickness
                            Font: =varThemeFont.CTA.face
                            FontWeight: =varThemeFont.CTA.weight
                            Height: =32
                            HoverBorderColor: =Self.Fill
                            HoverColor: =ColorValue(varThemeColors.text)
                            HoverFill: =Self.Fill
                            Italic: =varThemeFont.CTA.italic
                            OnSelect: =Launch(varSelectedReport.'Checklist Item'.Link)
                            PaddingBottom: =10
                            PaddingLeft: =0
                            PaddingTop: =0
                            PressedColor: =ColorValue(varThemeColors.altText)
                            PressedFill: =Self.Fill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =varThemeFont.CTA.size
                            Text: ="View manual"
                            Tooltip: =Self.Text
                            Underline: =true
                            Visible: =false
                            Width: =110
                            ZIndex: =1

            conMid_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =ColorValue(varThemeColors.backgroundFill)
                FillPortions: =0
                Height: =Max(conMidRight_ReportFormAttachment.Height , conMidLeft_ReportFormAttachment.Height)
                LayoutMinHeight: =conInnerBottom_ReportFormAttachment.Height + conInnerMidRight_ReportFormAttachment.Height + conInnerMidRightLower_ReportFormAttachment.Height +80
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =Parent.Width - Parent.PaddingLeft -Parent.PaddingRight
                ZIndex: =2

                conMidLeft_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =Max(conMidRight_ReportFormAttachment.Height , CountRows(colSteps) * 60)
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =56
                    LayoutMode: =LayoutMode.Auto
                    LayoutOverflowY: =LayoutOverflow.Scroll
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: |-
                        =Switch(App.ActiveScreen.Size,
                        ScreenSize.Large, 320,
                        ScreenSize.Medium, 60,
                        ScreenSize.Small, 60,
                        360)
                    ZIndex: =3

                    compStepper_ReportFormAttachment As compStepper:
                        ActualValue: =
                        AppHeight: =Parent.Height
                        AppWidth: =Parent.Width
                        Attachment: |-
                            =If(IsBlank(btnUploadFile_ReportFormAttachment.FileName) , LookUp(
                                    'Report Sub Steps',
                                    And(
                                        'Report Step'.'Report Step' = varCurrentReportStep.'Report Step',
                                        'Template Sub Step'.'Template Sub Step' = varCurrentSubStep.mpa_checklist_templatesubstepid,
                                        'Report Step'.Report.Report = varSelectedReport.Report
                                    ) ,Attachment.Value
                                ) , btnUploadFile_ReportFormAttachment.Media
                            )
                        Comment: =txtComments_ReportFormAttachment.Text
                        FileName: =
                        Height: =compStepper_ReportFormAttachment.AppHeight
                        LayoutMinHeight: =640
                        LayoutMinWidth: =640
                        Name: =drpSubStep_ReportFormAttachment.Selected.Name
                        ScreenSize: =App.ActiveScreen.Size
                        StepStatus: =cmbStepStatus_ReportFormAttachment.Selected
                        Substep: =drpSubStep_ReportFormAttachment.Selected
                        Width: =compStepper_ReportFormAttachment.AppWidth

                conMidRight_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Height: =conInnerMidRight_ReportFormAttachment.Height + conInnerMidRightLower_ReportFormAttachment.Height + conInnerBottom_ReportFormAttachment.Height  + (Self.LayoutGap *3)
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =20
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =20
                    PaddingRight: =20 + If(App.ActiveScreen.Size < ScreenSize.Medium, 10, 0)
                    PaddingTop: =20
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =Parent.Width - conMidLeft_ReportFormAttachment.Width
                    ZIndex: =4

                    conInnerMidRight_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =lblStepName_ReportFormAttachment.Height + lblStepStatus_ReportFormAttachment.Height + cmbStepStatus_ReportFormAttachment.Height + lblComments_ReportFormAttachment.Height + txtComments_ReportFormAttachment.Height + lblDesc_ReportFormAttachment.Height + 10
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =5
                        PaddingRight: =5
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        ZIndex: =1

                        lblStepName_ReportFormAttachment As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =ColorValue(varThemeColors.text)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =4
                            Font: =varThemeFont.H2.face
                            FontWeight: =varThemeFont.H2.weight
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.H2.italic
                            PaddingBottom: =10
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =varThemeFont.H2.size
                            Text: |-
                                ="Step" & " " & varCurrentStep.mpa_stepnumber & ": " & varCurrentStep.mpa_name
                            VerticalAlign: =VerticalAlign.Top
                            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            Wrap: =false
                            X: =
                            Y: =2
                            ZIndex: =1

                        lblDesc_ReportFormAttachment As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =ColorValue(varThemeColors.text)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =4
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weight
                            Height: =
                            Italic: =varThemeFont.B2.italic
                            PaddingBottom: =10
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =varThemeFont.B2.size
                            Text: =varCurrentStep.Description
                            VerticalAlign: =VerticalAlign.Top
                            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            X: =
                            Y: =2
                            ZIndex: =2

                        lblStepStatus_ReportFormAttachment As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =ColorValue(varThemeColors.text)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =4
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weightBold
                            Height: =(Self.Size * 2.5) +20
                            Italic: =varThemeFont.B2.italic
                            PaddingBottom: =10
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =varThemeFont.B2.size
                            Text: ="Step status *"
                            VerticalAlign: =VerticalAlign.Bottom
                            Width: |-
                                =Switch(
                                    App.ActiveScreen.Size,
                                    ScreenSize.Small,
                                    Parent.Width - Parent.PaddingLeft - Parent.PaddingRight,
                                    ScreenSize.Medium,
                                    (Parent.Width *.95) - Parent.PaddingLeft - Parent.PaddingRight,
                                    ScreenSize.Large,
                                    (Parent.Width *.85) - Parent.PaddingLeft - Parent.PaddingRight,
                                    (Parent.Width *.7) - Parent.PaddingLeft - Parent.PaddingRight
                                )
                            X: =lblStepName_ReportFormAttachment.X
                            Y: =txtComments_ReportFormAttachment.Y + txtComments_ReportFormAttachment.Height + 15
                            ZIndex: =3

                        cmbStepStatus_ReportFormAttachment As combobox:
                            AccessibleLabel: ="Step Status"
                            BorderColor: =ColorValue(varThemeColors.primaryGray)
                            BorderThickness: =1
                            ChevronBackground: =ColorValue(varThemeColors.backgroundFill)
                            ChevronDisabledBackground: =ColorValue(varThemeColors.backgroundFillDisabled)
                            ChevronDisabledFill: |
                                =ColorValue(varThemeColors.text)
                            ChevronFill: =ColorValue(varThemeColors.text)
                            ChevronHoverBackground: =ColorValue(varThemeColors.secondaryGray)
                            ChevronHoverFill: |
                                =ColorValue(varThemeColors.text)
                            Color: =ColorValue(varThemeColors.text)
                            DefaultSelectedItems: =[varCurrentStep.reportStatus]
                            DisabledBorderColor: =ColorValue(varThemeColors.primaryGray)
                            DisabledColor: =ColorValue(varThemeColors.disabledText)
                            DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                            DisplayFields: =["Value"]
                            DisplayMode: =If(varSelectedReport.'Status Reason' = 'Status Reason (Reports)'.'Ready for Review' || compStepper_ReportFormAttachment.Disabled , DisplayMode.Disabled , DisplayMode.Edit)
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =varThemeColors.focusBorderThickness
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =30
                            HoverBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                            HoverColor: =ColorValue(varThemeColors.text)
                            HoverFill: =ColorValue(varThemeColors.secondaryGray)
                            InputTextPlaceholder: ="Step status *"
                            IsSearchable: =false
                            Italic: =varThemeFont.B1.italic
                            Items: =Filter(Choices('Status Reason (Report Steps)'),Value <> 'Status Reason (Report Steps)'.Inactive)
                            NoSelectionText: ="Select here"
                            OnChange: |-
                                =If(Self.Selected.Value <> varStatusReason.Value ,
                                Set(varStatusReason , Self.Selected););
                            OnSelect: =
                            PaddingLeft: =12
                            PaddingRight: =10
                            PressedBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                            PressedColor: =ColorValue(varThemeColors.altText)
                            PressedFill: =ColorValue(varThemeColors.backgroundFill)
                            SearchFields: =["Value"]
                            SearchItems: =[]
                            SelectionColor: =ColorValue(varThemeColors.text)
                            SelectionFill: =ColorValue(varThemeColors.secondaryGray)
                            SelectionTagColor: =ColorValue(varThemeColors.text)
                            SelectionTagFill: =RGBA(0,0,0,0)
                            SelectMultiple: =false
                            Size: =varThemeFont.B1.size
                            Width: =lblStepStatus_ReportFormAttachment.Width
                            X: =1
                            Y: =
                            ZIndex: =4

                        lblComments_ReportFormAttachment As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =ColorValue(varThemeColors.text)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =4
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weightBold
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.B2.italic
                            LineHeight: =3
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =10
                            Size: =varThemeFont.B2.size
                            Text: ="Comment"
                            VerticalAlign: =VerticalAlign.Top
                            Width: =lblStepStatus_ReportFormAttachment.Width
                            X: =lblStepName_ReportFormAttachment.X
                            Y: =
                            ZIndex: =5

                        txtComments_ReportFormAttachment As text:
                            AccessibleLabel: ="Comment"
                            BorderColor: =ColorValue(varThemeColors.primaryGray)
                            BorderThickness: =1
                            Color: =ColorValue(varThemeColors.text)
                            Default: =compStepper_ReportFormAttachment.OutputComment
                            DisabledBorderColor: =ColorValue(varThemeColors.primaryGray)
                            DisabledColor: =ColorValue(varThemeColors.disabledText)
                            DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                            DisplayMode: =If(varSelectedReport.'Status Reason' = 'Status Reason (Reports)'.'Ready for Review' || compStepper_ReportFormAttachment.Disabled , DisplayMode.Disabled , DisplayMode.Edit)
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =varThemeColors.focusBorderThickness
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =100
                            HintText: ="Enter text"
                            HoverBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                            HoverColor: =ColorValue(varThemeColors.text)
                            HoverFill: =ColorValue(varThemeColors.backgroundFill)
                            Italic: =varThemeFont.B1.italic
                            Mode: =TextMode.MultiLine
                            OnChange: =
                            PressedBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                            PressedColor: =ColorValue(varThemeColors.text)
                            PressedFill: =ColorValue(varThemeColors.backgroundFill)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =varThemeFont.B1.size
                            Width: =lblStepStatus_ReportFormAttachment.Width
                            X: =lblStepName_ReportFormAttachment.X
                            Y: =lblComments_ReportFormAttachment.Y + lblComments_ReportFormAttachment.Height
                            ZIndex: =6

                    conInnerMidRightLower_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =lblSubstep_ReportFormAttachment.Height + lblSubstepTitle_ReportFormAttachment.Height + drpSubStep_ReportFormAttachment.Height + conInnerSubstep_ReportFormAttachment.Height + (Self.LayoutGap * 5)
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =5
                        PaddingRight: =5
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - Parent.PaddingLeft * 2
                        ZIndex: =7

                        lblSubstep_ReportFormAttachment As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =ColorValue(varThemeColors.text)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =4
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weightBold
                            Height: =
                            Italic: =varThemeFont.B2.italic
                            PaddingBottom: =10
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =varThemeFont.H3.size
                            Text: |-
                                ="Sub step" & " " & varCurrentSubStep.mpa_substeporder & ": " & varCurrentSubStep.mpa_name
                            VerticalAlign: =VerticalAlign.Top
                            Width: =lblStepStatus_ReportFormAttachment.Width
                            X: =
                            Y: =2
                            ZIndex: =1

                        lblSubstepTitle_ReportFormAttachment As label:
                            AutoHeight: =true
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =ColorValue(varThemeColors.text)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =4
                            Font: =varThemeFont.B2.face
                            FontWeight: =varThemeFont.B2.weightBold
                            Height: =Self.Size * 2.5
                            Italic: =varThemeFont.B2.italic
                            PaddingBottom: =10
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =varThemeFont.B2.size
                            Text: ="Sub step"
                            VerticalAlign: =VerticalAlign.Top
                            Width: =lblStepStatus_ReportFormAttachment.Width
                            X: =lblStepName_ReportFormAttachment.X
                            Y: =txtComments_ReportFormAttachment.Y + txtComments_ReportFormAttachment.Height + 15
                            ZIndex: =2

                        drpSubStep_ReportFormAttachment As dropdown:
                            AccessibleLabel: ="Substep"
                            BorderColor: =ColorValue(varThemeColors.primaryGray)
                            BorderThickness: =1
                            ChevronBackground: =ColorValue(varThemeColors.backgroundFill)
                            ChevronDisabledBackground: =ColorValue(varThemeColors.backgroundFillDisabled)
                            ChevronDisabledFill: =ColorValue(varThemeColors.text)
                            ChevronFill: =ColorValue(varThemeColors.text)
                            ChevronHoverBackground: =ColorValue(varThemeColors.secondaryGray)
                            ChevronHoverFill: =ColorValue(varThemeColors.text)
                            Color: =ColorValue(varThemeColors.text)
                            Default: =varCurrentSubStep.Name
                            DisabledBorderColor: =ColorValue(varThemeColors.primaryGray)
                            DisabledColor: =ColorValue(varThemeColors.disabledText)
                            DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                            DisplayMode: =If(varSelectedReport.'Status Reason' = 'Status Reason (Reports)'.'Ready for Review' || compStepper_ReportFormAttachment.Disabled , DisplayMode.Disabled , DisplayMode.Edit)
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FocusedBorderColor: =ColorValue(varThemeColors.info)
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weight
                            Height: =30
                            HoverBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                            HoverColor: =ColorValue(varThemeColors.text)
                            HoverFill: =ColorValue(varThemeColors.secondaryGray)
                            Italic: =varThemeFont.B1.italic
                            Items: |-
                                =Sort
                                (
                                Filter
                                (
                                'Template Sub Steps'
                                , 'Template Step'.'Template Step' =
                                varCurrentStep
                                .'Template Step') , 'Sub Step Order' ,
                                SortOrder
                                .Ascending)
                            OnChange: |-
                                =If(
                                    varCurrentSubStep.'Template Sub Step' <> Self.Selected.'Template Sub Step',
                                    Set(
                                        varDisabled,
                                        true
                                    );
                                    Set(//variable for checking if has value
                                        varHasReportSteps,
                                        LookUp(
                                            'Report Steps',
                                            And(
                                                Report.Report = varSelectedReport.Report,
                                                'Template Step'.'Template Step' = varCurrentStep.'Template Step'
                                            )
                                        )
                                    );
                                    Patch(//Update the Status  of Step
                                        colSteps,
                                        LookUp(
                                            colSteps,
                                            'Template Step' = varCurrentStep.'Template Step'
                                        ),
                                        {reportStatus: cmbStepStatus_ReportFormOpenText.Selected.Value}
                                    );
                                    
                                //Refresh the data of Step
                                Set(
                                        varCurrentStep,
                                        LookUp(
                                            colSteps,
                                            'Template Step' = varCurrentStep.'Template Step'
                                        )
                                    );
                                    
                                // Patch of Collection
                                IfError(
                                        Set(
                                            varCurrentReportStep,
                                            Patch(//Patching of Report steps
                                                'Report Steps',
                                                If(
                                                    IsBlank(varHasReportSteps),
                                                    Defaults('Report Steps'),//Create new record
                                                    LookUp(//patch existing record
                                                        'Report Steps',
                                                        'Report Step' = varHasReportSteps.'Report Step'
                                                    )
                                                ),
                                                {
                                                    Name: varCurrentStep.Name,
                                                    Report: varSelectedReport,
                                                    Comment: txtComments_ReportFormAttachment.Text,
                                                    'Template Step': LookUp(
                                                        'Template Steps',
                                                        'Template Step' = varCurrentStep.'Template Step'
                                                    ),
                                                    'Status Reason': cmbStepStatus_ReportFormAttachment.Selected.Value
                                                }
                                            )
                                        );
                                        ,
                                        Notify(//If error will notify
                                            "Error saving report",
                                            NotificationType.Error,
                                            2000
                                        );
                                        false,
                                //Checking of Variable if Substeps is visible
                                        Set(
                                            varHasReportSubSteps,
                                            LookUp(
                                                'Report Sub Steps',
                                                And(
                                                    'Report Step'.'Report Step' = varCurrentReportStep.'Report Step',
                                                    'Template Sub Step'.'Template Sub Step' = varCurrentSubStep.'Template Sub Step'
                                                )
                                            )
                                        );
                                        If(
                                            !IsBlank(Self.Selected),
                                            Patch(//Patching of Report Substeps
                                                'Report Sub Steps',
                                                If(
                                                    IsBlank(varHasReportSubSteps),
                                                    Defaults('Report Sub Steps'),//Create new if null
                                                    LookUp(//Patch existing record
                                                        'Report Sub Steps',
                                                        'Report Sub Step' = varHasReportSubSteps.'Report Sub Step'
                                                    )
                                                ),
                                                {
                                                    'Report Step': varCurrentReportStep,
                                                    Name: varCurrentSubStep.Name,
                                                    'Template Sub Step': varCurrentSubStep,
                                                    Attachment: {
                                                        FileName: If(
                                                            IsBlank(btnUploadFile_ReportFormAttachment.FileName),
                                                            LookUp(
                                                                'Report Sub Steps',
                                                                And(
                                                                    'Report Step'.'Report Step' = varCurrentReportStep.'Report Step',
                                                                    'Template Sub Step'.'Template Sub Step' = varCurrentSubStep.mpa_checklist_templatesubstepid,
                                                                    'Report Step'.Report.Report = varSelectedReport.Report
                                                                ),
                                                                Attachment.FileName
                                                            ),
                                                            btnUploadFile_ReportFormAttachment.FileName
                                                        ),
                                                        Value: If(
                                                            IsBlank(btnUploadFile_ReportFormAttachment.FileName),
                                                            LookUp(
                                                                'Report Sub Steps',
                                                                And(
                                                                    'Report Step'.'Report Step' = varCurrentReportStep.'Report Step',
                                                                    'Template Sub Step'.'Template Sub Step' = varCurrentSubStep.mpa_checklist_templatesubstepid,
                                                                    'Report Step'.Report.Report = varSelectedReport.Report
                                                                ),
                                                                Attachment.Value
                                                            ),
                                                            btnUploadFile_ReportFormAttachment.Media
                                                        )
                                                    }
                                                }
                                            );
                                        );
                                        ,
                                        Notify(
                                            "Error saving report" & " " & Concat(
                                                Errors('Report Sub Steps'),
                                                Column & ":" & Message
                                            ),
                                            NotificationType.Error,
                                            2000
                                        );
                                    //Notify Error
                                false,
                                        Set(
                                            varCurrentSubStep,
                                            Self.Selected
                                        );
                                        Switch(
                                            varCurrentSubStep.'Validation Type'.'Validation Type (mpa_validationtype)',
                                            'Validation Type Choices'.'Open Text',
                                            Navigate('Report Form Open Text Page')//Open Text Navigate 
                                ,
                                            'Validation Type Choices'.Attachment,
                                            Navigate('Report Form Attachment Page')//Attachment
                                ,
                                            'Validation Type Choices'.Unit,
                                            Navigate('Report Form Unit Page')//Unit
                                ,
                                            'Validation Type Choices'.List,
                                            Navigate('Report Form List Page'),
                                            Navigate('Report Form Attachment Page')//Attachment
                                        ),
                                        true
                                    );
                                    
                                //setting the value to blank
                                Set(
                                        varValueUnit,
                                        Blank()
                                    )
                                )
                            PaddingBottom: =5
                            PaddingLeft: =12
                            PaddingRight: =5
                            PaddingTop: =5
                            PressedBorderColor: =ColorValue(varThemeColors.tertiaryGray)
                            PressedColor: =ColorValue(varThemeColors.text)
                            PressedFill: =ColorValue(varThemeColors.backgroundFill)
                            SelectionColor: =ColorValue(varThemeColors.text)
                            SelectionFill: =ColorValue(varThemeColors.secondaryGray)
                            Size: =varThemeFont.B1.size
                            Tooltip: ="Please select an item"
                            Width: =lblStepStatus_ReportFormAttachment.Width
                            X: =1
                            Y: =
                            ZIndex: =3

                        conInnerSubstep_ReportFormAttachment As groupContainer.verticalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =conImage_ReportFormAttachment.Height + lblPhoto_ReportFormAttachment.Height + 10
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =1
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.Width
                            ZIndex: =4

                            lblPhoto_ReportFormAttachment As label:
                                AutoHeight: =true
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                FocusedBorderThickness: =4
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weightBold
                                Height: =Self.Size * 2.5
                                Italic: =varThemeFont.B2.italic
                                PaddingBottom: =10
                                PaddingLeft: =0
                                PaddingTop: =10
                                Size: =varThemeFont.B2.size
                                Text: ="Photo"
                                VerticalAlign: =VerticalAlign.Top
                                Width: |-
                                    =Switch(
                                        App.ActiveScreen.Size,
                                        ScreenSize.Small,
                                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight,
                                        ScreenSize.Medium,
                                        (Parent.Width *.8) - Parent.PaddingLeft - Parent.PaddingRight,
                                        ScreenSize.Large,
                                        (Parent.Width *.6) - Parent.PaddingLeft - Parent.PaddingRight,
                                        (Parent.Width *.6) - Parent.PaddingLeft - Parent.PaddingRight
                                    )
                                X: =lblStepName_ReportFormAttachment.X
                                Y: =txtComments_ReportFormAttachment.Y + txtComments_ReportFormAttachment.Height + 15
                                ZIndex: =1

                            conImage_ReportFormAttachment As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderThickness: =1
                                DropShadow: =DropShadow.None
                                FillPortions: =0
                                Height: =conImageUpload_ReportFormAttachment.Height + lblFileName_ReportFormAttachment.Height +50
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutGap: =10
                                LayoutMinHeight: =100
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =10
                                PaddingLeft: =20
                                PaddingTop: =10
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Width: =Switch(App.ActiveScreen.Size,ScreenSize.Small, drpSubStep_ReportFormAttachment.Width - 5, drpSubStep_ReportFormAttachment.Width)
                                ZIndex: =2

                                lblFileName_ReportFormAttachment As label:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =ColorValue(varThemeColors.text)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                    FocusedBorderThickness: =4
                                    Font: =varThemeFont.B1.face
                                    FontWeight: =varThemeFont.B1.weight
                                    Height: =Self.Size * .5
                                    Italic: =varThemeFont.B1.italic
                                    LineHeight: =1
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingTop: =0
                                    Size: =varThemeFont.B1.size
                                    Text: |-
                                        =If(IsBlank(btnUploadFile_ReportFormAttachment.FileName) , Substitute(LookUp(
                                                'Report Sub Steps',
                                                And(
                                                    'Report Step'.'Report Step' = varCurrentReportStep.'Report Step',
                                                    'Template Sub Step'.'Template Sub Step' = varCurrentSubStep.mpa_checklist_templatesubstepid
                                                ) ,Attachment.FileName
                                            ), "Untitled.txt" , "") , btnUploadFile_ReportFormAttachment.FileName
                                        )
                                    Underline: =true
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =Parent.Width / 2 - Self.X - 20 
                                    Wrap: =false
                                    X: =50
                                    Y: =42
                                    ZIndex: =1

                                conImageUpload_ReportFormAttachment As groupContainer.horizontalAutoLayoutContainer:
                                    AlignInContainer: =AlignInContainer.SetByContainer
                                    DropShadow: =DropShadow.None
                                    FillPortions: =0
                                    Height: =btnUploadFile_ReportFormAttachment.Y + btnUploadFile_ReportFormAttachment.Height
                                    LayoutAlignItems: =LayoutAlignItems.Center
                                    LayoutMinHeight: =100
                                    LayoutMinWidth: =250
                                    LayoutMode: =LayoutMode.Auto
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Width: =Parent.Width
                                    ZIndex: =2

                                    imgAttachment_ReportFormAttachment As image:
                                        AccessibleLabel: ="Attachment"
                                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                        Height: =0
                                        Image: =varCurrentSubStep.mpa_photoguidance.Value
                                        Width: =0
                                        X: =40
                                        Y: =40
                                        ZIndex: =1

                                    icoPaperClip_ReportFormAttachment As icon.Attachment:
                                        Color: =ColorValue(varThemeColors.primary)
                                        DisplayMode: =If(varSelectedReport.'Status Reason' = 'Status Reason (Reports)'.'Ready for Review' || compStepper_ReportFormAttachment.Disabled, DisplayMode.Disabled , DisplayMode.Edit)
                                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                        Height: =16
                                        Icon: =Icon.Camera
                                        Width: =16
                                        X: =13
                                        Y: =34
                                        ZIndex: =2

                                    btnUploadFile_ReportFormAttachment As addMedia:
                                        AccessibleLabel: ="Add photo"
                                        Align: =Align.Left
                                        ChangePictureText: ="Change picture"
                                        Color: =ColorValue(varThemeColors.primary)
                                        DisabledColor: =ColorValue(varThemeColors.disabledText)
                                        DisabledFill: =RGBA(245, 0, 0, 1)
                                        DisplayMode: =If(varSelectedReport.'Status Reason' = 'Status Reason (Reports)'.'Ready for Review' || compStepper_ReportFormAttachment.Disabled, DisplayMode.Disabled , DisplayMode.Edit)
                                        Fill: =ColorValue(varThemeColors.backgroundFill)
                                        FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                                        Font: =varThemeFont.B1.face
                                        FontWeight: =varThemeFont.B1.weight
                                        Height: =23
                                        HoverColor: =ColorValue(varThemeColors.text)
                                        Italic: =varThemeFont.B1.italic
                                        OnChange: =
                                        Padding: =10
                                        PressedColor: =ColorValue(varThemeColors.altText)
                                        Size: =varThemeFont.B1.size
                                        Text: =If(IsBlank(imgAttachment_ReportFormAttachment.Image), "Add photo", "Change picture")
                                        Underline: =true
                                        Width: =Len(Self.Text) * 20
                                        X: =35
                                        Y: =65
                                        ZIndex: =3

                    conInnerBottom_ReportFormAttachment As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        Height: =50
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        ZIndex: =8

                        compNextPrev_ReportFormAttachment As compNextPrev:
                            ActualValue: =
                            AppHeigth: =Parent.Height
                            AppWidth: =Parent.Width
                            Attachment: |-
                                =If(IsBlank(btnUploadFile_ReportFormAttachment.FileName) , LookUp(
                                        'Report Sub Steps',
                                        And(
                                            'Report Step'.'Report Step' = varCurrentReportStep.'Report Step',
                                            'Template Sub Step'.'Template Sub Step' = varCurrentSubStep.mpa_checklist_templatesubstepid,
                                            'Report Step'.Report.Report = varSelectedReport.Report
                                        ) ,Attachment.Value
                                    ) , btnUploadFile_ReportFormAttachment.Media
                                )
                            Comment: =txtComments_ReportFormAttachment.Text
                            FileName: =
                            Height: =compNextPrev_ReportFormAttachment.AppHeigth
                            LayoutMinHeight: =640
                            LayoutMinWidth: =640
                            Name: =drpSubStep_ReportFormAttachment.Selected.Name
                            ScreenSize: =App.ActiveScreen.Size
                            StepStatus: =cmbStepStatus_ReportFormAttachment.Selected
                            Substep: =drpSubStep_ReportFormAttachment.Selected
                            Width: =compNextPrev_ReportFormAttachment.AppWidth

            conBottom_ReportFormAttachment As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =ColorValue(varThemeColors.backgroundFill)
                FillPortions: =0
                Height: =If(App.ActiveScreen.Size <3  , 124 , 62)
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =20
                LayoutMinHeight: =If(App.ActiveScreen.Size = ScreenSize.Small  , 130 , 72)
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =Parent.Width - Parent.PaddingLeft -Parent.PaddingRight
                ZIndex: =3

                compButton_ReportFormAttachment As compButton:
                    ActualValue: =
                    AppHeight: =Parent.Height
                    AppWidth: =Parent.Width
                    Attachment: |-
                        =If(IsBlank(btnUploadFile_ReportFormAttachment.FileName) , LookUp(
                                'Report Sub Steps',
                                And(
                                    'Report Step'.'Report Step' = varCurrentReportStep.'Report Step',
                                    'Template Sub Step'.'Template Sub Step' = varCurrentSubStep.mpa_checklist_templatesubstepid,
                                    'Report Step'.Report.Report = varSelectedReport.Report
                                ) ,Attachment.Value
                            ) , btnUploadFile_ReportFormAttachment.Media
                        )
                    Comment: =txtComments_ReportFormAttachment.Text
                    FileName: =
                    Height: =compButton_ReportFormAttachment.AppHeight
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    Name: =drpSubStep_ReportFormAttachment.Selected.Name
                    ScreenSize: =App.ActiveScreen.Size
                    StepStatus: =cmbStepStatus_ReportFormAttachment.Selected
                    Substep: =drpSubStep_ReportFormAttachment.Selected
                    Width: =compButton_ReportFormAttachment.AppWidth

    compHeader_ReportFormAttachment As compHeader:
        HeaderWidth: =Parent.Width
        Height: =compHeader_ReportFormAttachment.HeaderHeight
        Width: =compHeader_ReportFormAttachment.HeaderWidth
        ZIndex: =2

